// // // // // // // // // // // // // // // // components/videogallerycomponents/VideoOptionsModal.jsx
// // // // // // // // // // // // // // // export default function VideoOptionsModal({
// // // // // // // // // // // // // // //     showVideoOptions,
// // // // // // // // // // // // // // //     onHide,
// // // // // // // // // // // // // // //     onCopyUrl,
// // // // // // // // // // // // // // //     onDownload,
// // // // // // // // // // // // // // //     onLoadProducts,
// // // // // // // // // // // // // // //     onDelete
// // // // // // // // // // // // // // //   }) {
// // // // // // // // // // // // // // //     if (!showVideoOptions.show) return null;
  
// // // // // // // // // // // // // // //     return (
// // // // // // // // // // // // // // //       <div 
// // // // // // // // // // // // // // //         className="video-options-menu"
// // // // // // // // // // // // // // //         style={{
// // // // // // // // // // // // // // //           left: showVideoOptions.position.x,
// // // // // // // // // // // // // // //           top: showVideoOptions.position.y
// // // // // // // // // // // // // // //         }}
// // // // // // // // // // // // // // //       >
// // // // // // // // // // // // // // //         <div className="video-option-item" onClick={() => onCopyUrl(showVideoOptions.video.shopify_file_url)}>
// // // // // // // // // // // // // // //           üìã Copy Video URL
// // // // // // // // // // // // // // //         </div>
// // // // // // // // // // // // // // //         <div className="video-option-item" onClick={() => onDownload(showVideoOptions.video)}>
// // // // // // // // // // // // // // //           ‚¨áÔ∏è Download Video
// // // // // // // // // // // // // // //         </div>
// // // // // // // // // // // // // // //         <div className="video-option-item" onClick={() => onLoadProducts(showVideoOptions.video)}>
// // // // // // // // // // // // // // //           üè™ Select Products
// // // // // // // // // // // // // // //         </div>
// // // // // // // // // // // // // // //         <div className="video-option-item" style={{ color: '#ef4444' }} onClick={() => onDelete(showVideoOptions.video.id, showVideoOptions.video.title)}>
// // // // // // // // // // // // // // //           üóëÔ∏è Delete Video
// // // // // // // // // // // // // // //         </div>
// // // // // // // // // // // // // // //       </div>
// // // // // // // // // // // // // // //     );
// // // // // // // // // // // // // // //   }





// // // // // // // // // // // // // // // // components/videogallerycomponents/VideoOptionsModal.jsx
// // // // // // // // // // // // // // // export default function VideoOptionsModal({
// // // // // // // // // // // // // // //   showVideoOptions,
// // // // // // // // // // // // // // //   onHide,
// // // // // // // // // // // // // // //   onCopyUrl,
// // // // // // // // // // // // // // //   onDownload,
// // // // // // // // // // // // // // //   onLoadProducts,
// // // // // // // // // // // // // // //   onDelete,
// // // // // // // // // // // // // // //   isDarkTheme
// // // // // // // // // // // // // // // }) {
// // // // // // // // // // // // // // //   if (!showVideoOptions.show) return null;

// // // // // // // // // // // // // // //   const themeStyles = {
// // // // // // // // // // // // // // //     light: {
// // // // // // // // // // // // // // //       background: '#ffffff',
// // // // // // // // // // // // // // //       text: '#1f2937',
// // // // // // // // // // // // // // //       border: '#e5e7eb',
// // // // // // // // // // // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.15)',
// // // // // // // // // // // // // // //       hoverBackground: '#f3f4f6'
// // // // // // // // // // // // // // //     },
// // // // // // // // // // // // // // //     dark: {
// // // // // // // // // // // // // // //       background: '#374151',
// // // // // // // // // // // // // // //       text: '#f9fafb',
// // // // // // // // // // // // // // //       border: '#4b5563',
// // // // // // // // // // // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.4)',
// // // // // // // // // // // // // // //       hoverBackground: '#4b5563'
// // // // // // // // // // // // // // //     }
// // // // // // // // // // // // // // //   };

// // // // // // // // // // // // // // //   const currentTheme = isDarkTheme ? themeStyles.dark : themeStyles.light;

// // // // // // // // // // // // // // //   const handleBackdropClick = (e) => {
// // // // // // // // // // // // // // //     if (e.target === e.currentTarget) {
// // // // // // // // // // // // // // //       onHide();
// // // // // // // // // // // // // // //     }
// // // // // // // // // // // // // // //   };

// // // // // // // // // // // // // // //   const handleOptionClick = (action) => {
// // // // // // // // // // // // // // //     action();
// // // // // // // // // // // // // // //     onHide();
// // // // // // // // // // // // // // //   };

// // // // // // // // // // // // // // //   return (
// // // // // // // // // // // // // // //     <div 
// // // // // // // // // // // // // // //       style={{
// // // // // // // // // // // // // // //         position: 'fixed',
        
// // // // // // // // // // // // // // //         top: 0,
// // // // // // // // // // // // // // //         left: 0,
// // // // // // // // // // // // // // //         right: 0,
// // // // // // // // // // // // // // //         bottom: 0,
// // // // // // // // // // // // // // //         zIndex: 10000,
// // // // // // // // // // // // // // //         background: 'transparent'
// // // // // // // // // // // // // // //       }}
// // // // // // // // // // // // // // //       onClick={handleBackdropClick}
// // // // // // // // // // // // // // //     >
// // // // // // // // // // // // // // //       <div 
// // // // // // // // // // // // // // //         style={{
// // // // // // // // // // // // // // //           // position: 'absolute',
// // // // // // // // // // // // // // //           left: `${showVideoOptions.position.x}px`,
// // // // // // // // // // // // // // //           top: `${showVideoOptions.position.y}px`,
// // // // // // // // // // // // // // //           background: currentTheme.background,
// // // // // // // // // // // // // // //           borderRadius: '12px',
// // // // // // // // // // // // // // //           border: `1px solid ${currentTheme.border}`,
// // // // // // // // // // // // // // //           boxShadow: currentTheme.shadow,
// // // // // // // // // // // // // // //           padding: '0.5rem',
// // // // // // // // // // // // // // //           minWidth: '200px',
// // // // // // // // // // // // // // //           zIndex: 10001,
// // // // // // // // // // // // // // //           animation: 'scaleIn 0.2s ease-out'
// // // // // // // // // // // // // // //         }}
// // // // // // // // // // // // // // //       >
// // // // // // // // // // // // // // //         {/* Custom Button Name & URL Section */}
// // // // // // // // // // // // // // //         <div style={{
// // // // // // // // // // // // // // //           padding: '0.75rem',
// // // // // // // // // // // // // // //           borderBottom: `1px solid ${currentTheme.border}`
// // // // // // // // // // // // // // //         }}>
// // // // // // // // // // // // // // //           <div style={{
// // // // // // // // // // // // // // //             fontSize: '0.875rem',
// // // // // // // // // // // // // // //             fontWeight: '600',
// // // // // // // // // // // // // // //             color: currentTheme.text,
// // // // // // // // // // // // // // //             marginBottom: '0.5rem'
// // // // // // // // // // // // // // //           }}>
// // // // // // // // // // // // // // //             Create Custom Button
// // // // // // // // // // // // // // //           </div>
          
// // // // // // // // // // // // // // //           <div style={{ marginBottom: '0.5rem' }}>
// // // // // // // // // // // // // // //             <div style={{
// // // // // // // // // // // // // // //               fontSize: '0.75rem',
// // // // // // // // // // // // // // //               color: currentTheme.text,
// // // // // // // // // // // // // // //               marginBottom: '0.25rem'
// // // // // // // // // // // // // // //             }}>
// // // // // // // // // // // // // // //               Custom Button Name
// // // // // // // // // // // // // // //             </div>
// // // // // // // // // // // // // // //             <input
// // // // // // // // // // // // // // //               type="text"
// // // // // // // // // // // // // // //               placeholder="Enter button name"
// // // // // // // // // // // // // // //               style={{
// // // // // // // // // // // // // // //                 width: '100%',
// // // // // // // // // // // // // // //                 padding: '0.5rem',
// // // // // // // // // // // // // // //                 border: `1px solid ${currentTheme.border}`,
// // // // // // // // // // // // // // //                 borderRadius: '6px',
// // // // // // // // // // // // // // //                 fontSize: '0.75rem',
// // // // // // // // // // // // // // //                 background: isDarkTheme ? '#4b5563' : 'white',
// // // // // // // // // // // // // // //                 color: currentTheme.text
// // // // // // // // // // // // // // //               }}
// // // // // // // // // // // // // // //             />
// // // // // // // // // // // // // // //           </div>
          
// // // // // // // // // // // // // // //           <div style={{ marginBottom: '0.75rem' }}>
// // // // // // // // // // // // // // //             <div style={{
// // // // // // // // // // // // // // //               fontSize: '0.75rem',
// // // // // // // // // // // // // // //               color: currentTheme.text,
// // // // // // // // // // // // // // //               marginBottom: '0.25rem'
// // // // // // // // // // // // // // //             }}>
// // // // // // // // // // // // // // //               Custom Url
// // // // // // // // // // // // // // //             </div>
// // // // // // // // // // // // // // //             <input
// // // // // // // // // // // // // // //               type="text"
// // // // // // // // // // // // // // //               placeholder="Enter URL"
// // // // // // // // // // // // // // //               style={{
// // // // // // // // // // // // // // //                 width: '100%',
// // // // // // // // // // // // // // //                 padding: '0.5rem',
// // // // // // // // // // // // // // //                 border: `1px solid ${currentTheme.border}`,
// // // // // // // // // // // // // // //                 borderRadius: '6px',
// // // // // // // // // // // // // // //                 fontSize: '0.75rem',
// // // // // // // // // // // // // // //                 background: isDarkTheme ? '#4b5563' : 'white',
// // // // // // // // // // // // // // //                 color: currentTheme.text
// // // // // // // // // // // // // // //               }}
// // // // // // // // // // // // // // //             />
// // // // // // // // // // // // // // //           </div>

// // // // // // // // // // // // // // //           <div style={{
// // // // // // // // // // // // // // //             fontSize: '0.7rem',
// // // // // // // // // // // // // // //             color: '#ef4444',
// // // // // // // // // // // // // // //             marginBottom: '0.75rem'
// // // // // // // // // // // // // // //           }}>
// // // // // // // // // // // // // // //             Add atleast one product.
// // // // // // // // // // // // // // //           </div>

// // // // // // // // // // // // // // //           <button
// // // // // // // // // // // // // // //             style={{
// // // // // // // // // // // // // // //               width: '100%',
// // // // // // // // // // // // // // //               background: '#3b82f6',
// // // // // // // // // // // // // // //               color: 'white',
// // // // // // // // // // // // // // //               border: 'none',
// // // // // // // // // // // // // // //               padding: '0.5rem',
// // // // // // // // // // // // // // //               borderRadius: '6px',
// // // // // // // // // // // // // // //               fontSize: '0.75rem',
// // // // // // // // // // // // // // //               fontWeight: '500',
// // // // // // // // // // // // // // //               cursor: 'pointer'
// // // // // // // // // // // // // // //             }}
// // // // // // // // // // // // // // //           >
// // // // // // // // // // // // // // //             Submit Link
// // // // // // // // // // // // // // //           </button>
// // // // // // // // // // // // // // //         </div>

// // // // // // // // // // // // // // //         {/* Homepage Section */}
// // // // // // // // // // // // // // //         <div style={{
// // // // // // // // // // // // // // //           padding: '0.75rem',
// // // // // // // // // // // // // // //           borderBottom: `1px solid ${currentTheme.border}`
// // // // // // // // // // // // // // //         }}>
// // // // // // // // // // // // // // //           <div style={{
// // // // // // // // // // // // // // //             fontSize: '0.875rem',
// // // // // // // // // // // // // // //             fontWeight: '600',
// // // // // // // // // // // // // // //             color: currentTheme.text,
// // // // // // // // // // // // // // //             marginBottom: '0.5rem'
// // // // // // // // // // // // // // //           }}>
// // // // // // // // // // // // // // //             Add in Homepage
// // // // // // // // // // // // // // //           </div>
// // // // // // // // // // // // // // //           <div style={{
// // // // // // // // // // // // // // //             fontSize: '0.7rem',
// // // // // // // // // // // // // // //             color: '#10b981',
// // // // // // // // // // // // // // //             marginBottom: '0.75rem'
// // // // // // // // // // // // // // //           }}>
// // // // // // // // // // // // // // //             Added on: 2025-09-22
// // // // // // // // // // // // // // //           </div>
// // // // // // // // // // // // // // //         </div>

// // // // // // // // // // // // // // //         {/* Products Section */}
// // // // // // // // // // // // // // //         <div style={{
// // // // // // // // // // // // // // //           padding: '0.75rem'
// // // // // // // // // // // // // // //         }}>
// // // // // // // // // // // // // // //           <div style={{
// // // // // // // // // // // // // // //             fontSize: '0.875rem',
// // // // // // // // // // // // // // //             fontWeight: '600',
// // // // // // // // // // // // // // //             color: currentTheme.text,
// // // // // // // // // // // // // // //             marginBottom: '0.5rem'
// // // // // // // // // // // // // // //           }}>
// // // // // // // // // // // // // // //             Add atleast one product.
// // // // // // // // // // // // // // //           </div>
          
// // // // // // // // // // // // // // //           <button
// // // // // // // // // // // // // // //             style={{
// // // // // // // // // // // // // // //               width: '100%',
// // // // // // // // // // // // // // //               background: '#10b981',
// // // // // // // // // // // // // // //               color: 'white',
// // // // // // // // // // // // // // //               border: 'none',
// // // // // // // // // // // // // // //               padding: '0.5rem',
// // // // // // // // // // // // // // //               borderRadius: '6px',
// // // // // // // // // // // // // // //               fontSize: '0.75rem',
// // // // // // // // // // // // // // //               fontWeight: '500',
// // // // // // // // // // // // // // //               cursor: 'pointer',
// // // // // // // // // // // // // // //               marginBottom: '0.75rem'
// // // // // // // // // // // // // // //             }}
// // // // // // // // // // // // // // //           >
// // // // // // // // // // // // // // //             Submit Products
// // // // // // // // // // // // // // //           </button>

// // // // // // // // // // // // // // //           <div style={{
// // // // // // // // // // // // // // //             fontSize: '0.75rem',
// // // // // // // // // // // // // // //             color: currentTheme.text,
// // // // // // // // // // // // // // //             marginBottom: '0.5rem'
// // // // // // // // // // // // // // //           }}>
// // // // // // // // // // // // // // //             Tagged Products
// // // // // // // // // // // // // // //           </div>

// // // // // // // // // // // // // // //           <div style={{
// // // // // // // // // // // // // // //             display: 'flex',
// // // // // // // // // // // // // // //             alignItems: 'center',
// // // // // // // // // // // // // // //             gap: '0.5rem',
// // // // // // // // // // // // // // //             marginBottom: '0.75rem'
// // // // // // // // // // // // // // //           }}>
// // // // // // // // // // // // // // //             <div style={{
// // // // // // // // // // // // // // //               width: '20px',
// // // // // // // // // // // // // // //               height: '20px',
// // // // // // // // // // // // // // //               background: '#f59e0b',
// // // // // // // // // // // // // // //               borderRadius: '4px',
// // // // // // // // // // // // // // //               display: 'flex',
// // // // // // // // // // // // // // //               alignItems: 'center',
// // // // // // // // // // // // // // //               justifyContent: 'center',
// // // // // // // // // // // // // // //               fontSize: '0.6rem',
// // // // // // // // // // // // // // //               color: 'white'
// // // // // // // // // // // // // // //             }}>
// // // // // // // // // // // // // // //               B
// // // // // // // // // // // // // // //             </div>
// // // // // // // // // // // // // // //             <div>
// // // // // // // // // // // // // // //               <div style={{
// // // // // // // // // // // // // // //                 fontSize: '0.75rem',
// // // // // // // // // // // // // // //                 color: currentTheme.text,
// // // // // // // // // // // // // // //                 fontWeight: '500'
// // // // // // // // // // // // // // //               }}>
// // // // // // // // // // // // // // //                 Bitcoin
// // // // // // // // // // // // // // //               </div>
// // // // // // // // // // // // // // //               <div style={{
// // // // // // // // // // // // // // //                 fontSize: '0.7rem',
// // // // // // // // // // // // // // //                 color: '#10b981'
// // // // // // // // // // // // // // //               }}>
// // // // // // // // // // // // // // //                 PKR 1,007,788.37
// // // // // // // // // // // // // // //               </div>
// // // // // // // // // // // // // // //             </div>
// // // // // // // // // // // // // // //           </div>

// // // // // // // // // // // // // // //           <label style={{
// // // // // // // // // // // // // // //             display: 'flex',
// // // // // // // // // // // // // // //             alignItems: 'center',
// // // // // // // // // // // // // // //             gap: '0.5rem',
// // // // // // // // // // // // // // //             cursor: 'pointer',
// // // // // // // // // // // // // // //             fontSize: '0.75rem',
// // // // // // // // // // // // // // //             color: currentTheme.text
// // // // // // // // // // // // // // //           }}>
// // // // // // // // // // // // // // //             <input type="checkbox" />
// // // // // // // // // // // // // // //             Enable video on product page
// // // // // // // // // // // // // // //           </label>
// // // // // // // // // // // // // // //         </div>

// // // // // // // // // // // // // // //         {/* Original Video Options */}
// // // // // // // // // // // // // // //         <div style={{
// // // // // // // // // // // // // // //           borderTop: `1px solid ${currentTheme.border}`,
// // // // // // // // // // // // // // //           paddingTop: '0.5rem'
// // // // // // // // // // // // // // //         }}>
// // // // // // // // // // // // // // //           <div 
// // // // // // // // // // // // // // //             style={{
// // // // // // // // // // // // // // //               padding: '0.5rem 0.75rem',
// // // // // // // // // // // // // // //               fontSize: '0.8rem',
// // // // // // // // // // // // // // //               color: currentTheme.text,
// // // // // // // // // // // // // // //               cursor: 'pointer',
// // // // // // // // // // // // // // //               borderRadius: '6px',
// // // // // // // // // // // // // // //               transition: 'background-color 0.2s',
// // // // // // // // // // // // // // //               display: 'flex',
// // // // // // // // // // // // // // //               alignItems: 'center',
// // // // // // // // // // // // // // //               gap: '0.5rem'
// // // // // // // // // // // // // // //             }}
// // // // // // // // // // // // // // //             onMouseEnter={(e) => {
// // // // // // // // // // // // // // //               e.target.style.background = currentTheme.hoverBackground;
// // // // // // // // // // // // // // //             }}
// // // // // // // // // // // // // // //             onMouseLeave={(e) => {
// // // // // // // // // // // // // // //               e.target.style.background = 'transparent';
// // // // // // // // // // // // // // //             }}
// // // // // // // // // // // // // // //             onClick={() => handleOptionClick(() => onCopyUrl(showVideoOptions.video.shopify_file_url))}
// // // // // // // // // // // // // // //           >
// // // // // // // // // // // // // // //             üìã Copy Video URL
// // // // // // // // // // // // // // //           </div>
          
// // // // // // // // // // // // // // //           <div 
// // // // // // // // // // // // // // //             style={{
// // // // // // // // // // // // // // //               padding: '0.5rem 0.75rem',
// // // // // // // // // // // // // // //               fontSize: '0.8rem',
// // // // // // // // // // // // // // //               color: currentTheme.text,
// // // // // // // // // // // // // // //               cursor: 'pointer',
// // // // // // // // // // // // // // //               borderRadius: '6px',
// // // // // // // // // // // // // // //               transition: 'background-color 0.2s',
// // // // // // // // // // // // // // //               display: 'flex',
// // // // // // // // // // // // // // //               alignItems: 'center',
// // // // // // // // // // // // // // //               gap: '0.5rem'
// // // // // // // // // // // // // // //             }}
// // // // // // // // // // // // // // //             onMouseEnter={(e) => {
// // // // // // // // // // // // // // //               e.target.style.background = currentTheme.hoverBackground;
// // // // // // // // // // // // // // //             }}
// // // // // // // // // // // // // // //             onMouseLeave={(e) => {
// // // // // // // // // // // // // // //               e.target.style.background = 'transparent';
// // // // // // // // // // // // // // //             }}
// // // // // // // // // // // // // // //             onClick={() => handleOptionClick(() => onDownload(showVideoOptions.video))}
// // // // // // // // // // // // // // //           >
// // // // // // // // // // // // // // //             ‚¨áÔ∏è Download Video
// // // // // // // // // // // // // // //           </div>
          
// // // // // // // // // // // // // // //           <div 
// // // // // // // // // // // // // // //             style={{
// // // // // // // // // // // // // // //               padding: '0.5rem 0.75rem',
// // // // // // // // // // // // // // //               fontSize: '0.8rem',
// // // // // // // // // // // // // // //               color: currentTheme.text,
// // // // // // // // // // // // // // //               cursor: 'pointer',
// // // // // // // // // // // // // // //               borderRadius: '6px',
// // // // // // // // // // // // // // //               transition: 'background-color 0.2s',
// // // // // // // // // // // // // // //               display: 'flex',
// // // // // // // // // // // // // // //               alignItems: 'center',
// // // // // // // // // // // // // // //               gap: '0.5rem'
// // // // // // // // // // // // // // //             }}
// // // // // // // // // // // // // // //             onMouseEnter={(e) => {
// // // // // // // // // // // // // // //               e.target.style.background = currentTheme.hoverBackground;
// // // // // // // // // // // // // // //             }}
// // // // // // // // // // // // // // //             onMouseLeave={(e) => {
// // // // // // // // // // // // // // //               e.target.style.background = 'transparent';
// // // // // // // // // // // // // // //             }}
// // // // // // // // // // // // // // //             onClick={() => handleOptionClick(() => onLoadProducts(showVideoOptions.video))}
// // // // // // // // // // // // // // //           >
// // // // // // // // // // // // // // //             üè™ Select Products
// // // // // // // // // // // // // // //           </div>
          
// // // // // // // // // // // // // // //           <div 
// // // // // // // // // // // // // // //             style={{
// // // // // // // // // // // // // // //               padding: '0.5rem 0.75rem',
// // // // // // // // // // // // // // //               fontSize: '0.8rem',
// // // // // // // // // // // // // // //               color: '#ef4444',
// // // // // // // // // // // // // // //               cursor: 'pointer',
// // // // // // // // // // // // // // //               borderRadius: '6px',
// // // // // // // // // // // // // // //               transition: 'background-color 0.2s',
// // // // // // // // // // // // // // //               display: 'flex',
// // // // // // // // // // // // // // //               alignItems: 'center',
// // // // // // // // // // // // // // //               gap: '0.5rem'
// // // // // // // // // // // // // // //             }}
// // // // // // // // // // // // // // //             onMouseEnter={(e) => {
// // // // // // // // // // // // // // //               e.target.style.background = currentTheme.hoverBackground;
// // // // // // // // // // // // // // //             }}
// // // // // // // // // // // // // // //             onMouseLeave={(e) => {
// // // // // // // // // // // // // // //               e.target.style.background = 'transparent';
// // // // // // // // // // // // // // //             }}
// // // // // // // // // // // // // // //             onClick={() => handleOptionClick(() => onDelete(showVideoOptions.video.id, showVideoOptions.video.title))}
// // // // // // // // // // // // // // //           >
// // // // // // // // // // // // // // //             üóëÔ∏è Delete Video
// // // // // // // // // // // // // // //           </div>
// // // // // // // // // // // // // // //         </div>

// // // // // // // // // // // // // // //         <style jsx>{`
// // // // // // // // // // // // // // //           @keyframes scaleIn {
// // // // // // // // // // // // // // //             from {
// // // // // // // // // // // // // // //               opacity: 0;
// // // // // // // // // // // // // // //               transform: scale(0.95) translateY(-10px);
// // // // // // // // // // // // // // //             }
// // // // // // // // // // // // // // //             to {
// // // // // // // // // // // // // // //               opacity: 1;
// // // // // // // // // // // // // // //               transform: scale(1) translateY(0);
// // // // // // // // // // // // // // //             }
// // // // // // // // // // // // // // //           }
// // // // // // // // // // // // // // //         `}</style>
// // // // // // // // // // // // // // //       </div>
// // // // // // // // // // // // // // //     </div>
// // // // // // // // // // // // // // //   );
// // // // // // // // // // // // // // // }




// // // // // // // // // // // // // //   // components/videogallerycomponents/VideoOptionsModal.jsx
// // // // // // // // // // // // // // export default function VideoOptionsModal({
// // // // // // // // // // // // // //   showVideoOptions,
// // // // // // // // // // // // // //   onHide,
// // // // // // // // // // // // // //   onCopyUrl,
// // // // // // // // // // // // // //   onDownload,
// // // // // // // // // // // // // //   onLoadProducts,
// // // // // // // // // // // // // //   onDelete,
// // // // // // // // // // // // // //   isDarkTheme
// // // // // // // // // // // // // // }) {
// // // // // // // // // // // // // //   if (!showVideoOptions.show) return null;

// // // // // // // // // // // // // //   const themeStyles = {
// // // // // // // // // // // // // //     light: {
// // // // // // // // // // // // // //       background: '#ffffff',
// // // // // // // // // // // // // //       text: '#1f2937',
// // // // // // // // // // // // // //       border: '#e5e7eb',
// // // // // // // // // // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.15)',
// // // // // // // // // // // // // //       hoverBackground: '#f3f4f6',
// // // // // // // // // // // // // //       sectionBackground: '#f8fafc'
// // // // // // // // // // // // // //     },
// // // // // // // // // // // // // //     dark: {
// // // // // // // // // // // // // //       background: '#374151',
// // // // // // // // // // // // // //       text: '#f9fafb',
// // // // // // // // // // // // // //       border: '#4b5563',
// // // // // // // // // // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.4)',
// // // // // // // // // // // // // //       hoverBackground: '#4b5563',
// // // // // // // // // // // // // //       sectionBackground: '#4b5563'
// // // // // // // // // // // // // //     }
// // // // // // // // // // // // // //   };

// // // // // // // // // // // // // //   const currentTheme = isDarkTheme ? themeStyles.dark : themeStyles.light;

// // // // // // // // // // // // // //   const handleBackdropClick = (e) => {
// // // // // // // // // // // // // //     if (e.target === e.currentTarget) {
// // // // // // // // // // // // // //       onHide();
// // // // // // // // // // // // // //     }
// // // // // // // // // // // // // //   };

// // // // // // // // // // // // // //   const handleOptionClick = (action) => {
// // // // // // // // // // // // // //     action();
// // // // // // // // // // // // // //     onHide();
// // // // // // // // // // // // // //   };

// // // // // // // // // // // // // //   return (
// // // // // // // // // // // // // //     <div 
// // // // // // // // // // // // // //       style={{
// // // // // // // // // // // // // //         position: 'fixed',
// // // // // // // // // // // // // //         top: 0,
// // // // // // // // // // // // // //         left: 0,
// // // // // // // // // // // // // //         right: 0,
// // // // // // // // // // // // // //         bottom: 0,
// // // // // // // // // // // // // //         zIndex: 10000,
// // // // // // // // // // // // // //         background: 'rgba(0, 0, 0, 0.5)',
// // // // // // // // // // // // // //         display: 'flex',
// // // // // // // // // // // // // //         justifyContent: 'center',
// // // // // // // // // // // // // //         alignItems: 'center'
// // // // // // // // // // // // // //       }}
// // // // // // // // // // // // // //       onClick={handleBackdropClick}
// // // // // // // // // // // // // //     >
// // // // // // // // // // // // // //       <div 
// // // // // // // // // // // // // //         style={{
// // // // // // // // // // // // // //           background: currentTheme.background,
// // // // // // // // // // // // // //           borderRadius: '12px',
// // // // // // // // // // // // // //           border: `1px solid ${currentTheme.border}`,
// // // // // // // // // // // // // //           boxShadow: currentTheme.shadow,
// // // // // // // // // // // // // //           padding: '1.5rem',
// // // // // // // // // // // // // //           maxWidth: '900px',
// // // // // // // // // // // // // //           minWidth: '380px',
// // // // // // // // // // // // // //           zIndex: 10001,
// // // // // // // // // // // // // //           animation: 'scaleIn 0.2s ease-out',
// // // // // // // // // // // // // //           display: 'flex',
// // // // // // // // // // // // // //           flexDirection: 'row',
// // // // // // // // // // // // // //           justifyContent: 'space-between',
// // // // // // // // // // // // // //           alignItems: 'flex-start',
// // // // // // // // // // // // // //           gap: '2rem'
// // // // // // // // // // // // // //         }}
// // // // // // // // // // // // // //       >
// // // // // // // // // // // // // //         {/* Left Column - Video Player & Custom Button */}
// // // // // // // // // // // // // //         <div style={{
// // // // // // // // // // // // // //           flex: 1,
// // // // // // // // // // // // // //           minWidth: '300px',
// // // // // // // // // // // // // //           display: 'flex',
// // // // // // // // // // // // // //           flexDirection: 'column',
// // // // // // // // // // // // // //           gap: '1.5rem'
// // // // // // // // // // // // // //         }}>
// // // // // // // // // // // // // //           {/* Video Player Section - NEW ADDITION */}
// // // // // // // // // // // // // //           <div>
// // // // // // // // // // // // // //             <h3 style={{
// // // // // // // // // // // // // //               fontSize: '0.875rem',
// // // // // // // // // // // // // //               fontWeight: '600',
// // // // // // // // // // // // // //               color: currentTheme.text,
// // // // // // // // // // // // // //               margin: '0 0 1rem 0'
// // // // // // // // // // // // // //             }}>
// // // // // // // // // // // // // //               Selected Video
// // // // // // // // // // // // // //             </h3>
            
// // // // // // // // // // // // // //             {/* Simple Video Player */}
// // // // // // // // // // // // // //             <div style={{
// // // // // // // // // // // // // //               width: '100%',
// // // // // // // // // // // // // //               borderRadius: '8px',
// // // // // // // // // // // // // //               overflow: 'hidden',
// // // // // // // // // // // // // //               background: isDarkTheme ? '#1f2937' : '#f3f4f6',
// // // // // // // // // // // // // //               border: `1px solid ${currentTheme.border}`
// // // // // // // // // // // // // //             }}>
// // // // // // // // // // // // // //               <video
// // // // // // // // // // // // // //                 controls
// // // // // // // // // // // // // //                 style={{
// // // // // // // // // // // // // //                   width: '100%',
// // // // // // // // // // // // // //                   height: 'auto',
// // // // // // // // // // // // // //                   maxHeight: '200px',
// // // // // // // // // // // // // //                   objectFit: 'cover',
// // // // // // // // // // // // // //                   display: 'block'
// // // // // // // // // // // // // //                 }}
// // // // // // // // // // // // // //                 src={showVideoOptions.video?.shopify_file_url}
// // // // // // // // // // // // // //                 poster={showVideoOptions.video?.thumbnail_url}
// // // // // // // // // // // // // //               />
// // // // // // // // // // // // // //               <div style={{
// // // // // // // // // // // // // //                 padding: '0.75rem',
// // // // // // // // // // // // // //                 borderTop: `1px solid ${currentTheme.border}`
// // // // // // // // // // // // // //               }}>
// // // // // // // // // // // // // //                 <div style={{
// // // // // // // // // // // // // //                   fontSize: '0.8rem',
// // // // // // // // // // // // // //                   color: currentTheme.text,
// // // // // // // // // // // // // //                   fontWeight: '600',
// // // // // // // // // // // // // //                   marginBottom: '0.25rem'
// // // // // // // // // // // // // //                 }}>
// // // // // // // // // // // // // //                   {showVideoOptions.video?.title || 'Untitled Video'}
// // // // // // // // // // // // // //                 </div>
// // // // // // // // // // // // // //                 <div style={{
// // // // // // // // // // // // // //                   fontSize: '0.7rem',
// // // // // // // // // // // // // //                   color: isDarkTheme ? '#d1d5db' : '#6b7280'
// // // // // // // // // // // // // //                 }}>
// // // // // // // // // // // // // //                   {showVideoOptions.video?.duration ? `Duration: ${showVideoOptions.video.duration}` : 'Video'}
// // // // // // // // // // // // // //                 </div>
// // // // // // // // // // // // // //               </div>
// // // // // // // // // // // // // //             </div>
// // // // // // // // // // // // // //           </div>

// // // // // // // // // // // // // //           {/* Create Custom Button Section - EXISTING CODE */}
// // // // // // // // // // // // // //           <div style={{
// // // // // // // // // // // // // //             flex: 1,
// // // // // // // // // // // // // //             minWidth: '250px'
// // // // // // // // // // // // // //           }}>
// // // // // // // // // // // // // //             <h3 style={{
// // // // // // // // // // // // // //               fontSize: '0.875rem',
// // // // // // // // // // // // // //               fontWeight: '600',
// // // // // // // // // // // // // //               color: currentTheme.text,
// // // // // // // // // // // // // //               margin: '0 0 1rem 0'
// // // // // // // // // // // // // //             }}>
// // // // // // // // // // // // // //               Create Custom Button
// // // // // // // // // // // // // //             </h3>
            
// // // // // // // // // // // // // //             <div style={{ marginBottom: '0.75rem' }}>
// // // // // // // // // // // // // //               <label style={{
// // // // // // // // // // // // // //                 display: 'block',
// // // // // // // // // // // // // //                 fontSize: '0.75rem',
// // // // // // // // // // // // // //                 fontWeight: '500',
// // // // // // // // // // // // // //                 color: currentTheme.text,
// // // // // // // // // // // // // //                 marginBottom: '0.25rem'
// // // // // // // // // // // // // //               }}>
// // // // // // // // // // // // // //                 Custom Button Name
// // // // // // // // // // // // // //               </label>
// // // // // // // // // // // // // //               <input
// // // // // // // // // // // // // //                 type="text"
// // // // // // // // // // // // // //                 placeholder="Enter button name"
// // // // // // // // // // // // // //                 style={{
// // // // // // // // // // // // // //                   width: '100%',
// // // // // // // // // // // // // //                   padding: '0.5rem',
// // // // // // // // // // // // // //                   border: `1px solid ${currentTheme.border}`,
// // // // // // // // // // // // // //                   borderRadius: '6px',
// // // // // // // // // // // // // //                   fontSize: '0.75rem',
// // // // // // // // // // // // // //                   background: isDarkTheme ? '#4b5563' : 'white',
// // // // // // // // // // // // // //                   color: currentTheme.text
// // // // // // // // // // // // // //                 }}
// // // // // // // // // // // // // //               />
// // // // // // // // // // // // // //             </div>
            
// // // // // // // // // // // // // //             <div style={{ marginBottom: '1rem' }}>
// // // // // // // // // // // // // //               <label style={{
// // // // // // // // // // // // // //                 display: 'block',
// // // // // // // // // // // // // //                 fontSize: '0.75rem',
// // // // // // // // // // // // // //                 fontWeight: '500',
// // // // // // // // // // // // // //                 color: currentTheme.text,
// // // // // // // // // // // // // //                 marginBottom: '0.25rem'
// // // // // // // // // // // // // //               }}>
// // // // // // // // // // // // // //                 Custom Url
// // // // // // // // // // // // // //               </label>
// // // // // // // // // // // // // //               <input
// // // // // // // // // // // // // //                 type="text"
// // // // // // // // // // // // // //                 placeholder="Enter URL"
// // // // // // // // // // // // // //                 style={{
// // // // // // // // // // // // // //                   width: '100%',
// // // // // // // // // // // // // //                   padding: '0.5rem',
// // // // // // // // // // // // // //                   border: `1px solid ${currentTheme.border}`,
// // // // // // // // // // // // // //                   borderRadius: '6px',
// // // // // // // // // // // // // //                   fontSize: '0.75rem',
// // // // // // // // // // // // // //                   background: isDarkTheme ? '#4b5563' : 'white',
// // // // // // // // // // // // // //                   color: currentTheme.text
// // // // // // // // // // // // // //                 }}
// // // // // // // // // // // // // //               />
// // // // // // // // // // // // // //             </div>

// // // // // // // // // // // // // //             <div style={{
// // // // // // // // // // // // // //               fontSize: '0.7rem',
// // // // // // // // // // // // // //               color: '#ef4444',
// // // // // // // // // // // // // //               marginBottom: '1rem',
// // // // // // // // // // // // // //               fontStyle: 'italic'
// // // // // // // // // // // // // //             }}>
// // // // // // // // // // // // // //               Add atleast one product.
// // // // // // // // // // // // // //             </div>

// // // // // // // // // // // // // //             <button
// // // // // // // // // // // // // //               style={{
// // // // // // // // // // // // // //                 width: '100%',
// // // // // // // // // // // // // //                 background: '#3b82f6',
// // // // // // // // // // // // // //                 color: 'white',
// // // // // // // // // // // // // //                 border: 'none',
// // // // // // // // // // // // // //                 padding: '0.5rem',
// // // // // // // // // // // // // //                 borderRadius: '6px',
// // // // // // // // // // // // // //                 fontSize: '0.75rem',
// // // // // // // // // // // // // //                 fontWeight: '500',
// // // // // // // // // // // // // //                 cursor: 'pointer',
// // // // // // // // // // // // // //                 transition: 'background-color 0.2s'
// // // // // // // // // // // // // //               }}
// // // // // // // // // // // // // //               onMouseEnter={(e) => {
// // // // // // // // // // // // // //                 e.target.style.background = '#2563eb';
// // // // // // // // // // // // // //               }}
// // // // // // // // // // // // // //               onMouseLeave={(e) => {
// // // // // // // // // // // // // //                 e.target.style.background = '#3b82f6';
// // // // // // // // // // // // // //               }}
// // // // // // // // // // // // // //             >
// // // // // // // // // // // // // //               Submit Link
// // // // // // // // // // // // // //             </button>
// // // // // // // // // // // // // //           </div>
// // // // // // // // // // // // // //         </div>

// // // // // // // // // // // // // //         {/* Right Column - Homepage & Products - EXISTING CODE */}
// // // // // // // // // // // // // //         <div style={{
// // // // // // // // // // // // // //           flex: 1,
// // // // // // // // // // // // // //           minWidth: '250px',
// // // // // // // // // // // // // //           display: 'flex',
// // // // // // // // // // // // // //           flexDirection: 'column',
// // // // // // // // // // // // // //           gap: '1.5rem'
// // // // // // // // // // // // // //         }}>
// // // // // // // // // // // // // //           {/* Homepage Section */}
// // // // // // // // // // // // // //           <div>
// // // // // // // // // // // // // //             <h3 style={{
// // // // // // // // // // // // // //               fontSize: '0.875rem',
// // // // // // // // // // // // // //               fontWeight: '600',
// // // // // // // // // // // // // //               color: currentTheme.text,
// // // // // // // // // // // // // //               margin: '0 0 0.75rem 0'
// // // // // // // // // // // // // //             }}>
// // // // // // // // // // // // // //               Add in Homepage
// // // // // // // // // // // // // //             </h3>
// // // // // // // // // // // // // //             <div style={{
// // // // // // // // // // // // // //               fontSize: '0.7rem',
// // // // // // // // // // // // // //               color: '#10b981',
// // // // // // // // // // // // // //               fontWeight: '500'
// // // // // // // // // // // // // //             }}>
// // // // // // // // // // // // // //               Added on: 2025-09-22
// // // // // // // // // // // // // //             </div>
// // // // // // // // // // // // // //           </div>

// // // // // // // // // // // // // //           {/* Products Section */}
// // // // // // // // // // // // // //           <div>
// // // // // // // // // // // // // //             <h3 style={{
// // // // // // // // // // // // // //               fontSize: '0.875rem',
// // // // // // // // // // // // // //               fontWeight: '600',
// // // // // // // // // // // // // //               color: currentTheme.text,
// // // // // // // // // // // // // //               margin: '0 0 1rem 0'
// // // // // // // // // // // // // //             }}>
// // // // // // // // // // // // // //               Add atleast one product.
// // // // // // // // // // // // // //             </h3>
            
// // // // // // // // // // // // // //             <button
// // // // // // // // // // // // // //               style={{
// // // // // // // // // // // // // //                 width: '100%',
// // // // // // // // // // // // // //                 background: '#10b981',
// // // // // // // // // // // // // //                 color: 'white',
// // // // // // // // // // // // // //                 border: 'none',
// // // // // // // // // // // // // //                 padding: '0.5rem',
// // // // // // // // // // // // // //                 borderRadius: '6px',
// // // // // // // // // // // // // //                 fontSize: '0.75rem',
// // // // // // // // // // // // // //                 fontWeight: '500',
// // // // // // // // // // // // // //                 cursor: 'pointer',
// // // // // // // // // // // // // //                 marginBottom: '1rem',
// // // // // // // // // // // // // //                 transition: 'background-color 0.2s'
// // // // // // // // // // // // // //               }}
// // // // // // // // // // // // // //               onMouseEnter={(e) => {
// // // // // // // // // // // // // //                 e.target.style.background = '#059669';
// // // // // // // // // // // // // //               }}
// // // // // // // // // // // // // //               onMouseLeave={(e) => {
// // // // // // // // // // // // // //                 e.target.style.background = '#10b981';
// // // // // // // // // // // // // //               }}
// // // // // // // // // // // // // //             >
// // // // // // // // // // // // // //               Submit Products
// // // // // // // // // // // // // //             </button>

// // // // // // // // // // // // // //             <div style={{
// // // // // // // // // // // // // //               fontSize: '0.75rem',
// // // // // // // // // // // // // //               fontWeight: '600',
// // // // // // // // // // // // // //               color: currentTheme.text,
// // // // // // // // // // // // // //               marginBottom: '0.75rem'
// // // // // // // // // // // // // //             }}>
// // // // // // // // // // // // // //               Tagged Products
// // // // // // // // // // // // // //             </div>

// // // // // // // // // // // // // //             <div style={{
// // // // // // // // // // // // // //               display: 'flex',
// // // // // // // // // // // // // //               alignItems: 'center',
// // // // // // // // // // // // // //               gap: '0.5rem',
// // // // // // // // // // // // // //               marginBottom: '1rem',
// // // // // // // // // // // // // //               padding: '0.75rem',
// // // // // // // // // // // // // //               background: isDarkTheme ? '#1f2937' : '#f3f4f6',
// // // // // // // // // // // // // //               borderRadius: '6px'
// // // // // // // // // // // // // //             }}>
// // // // // // // // // // // // // //               <div style={{
// // // // // // // // // // // // // //                 width: '24px',
// // // // // // // // // // // // // //                 height: '24px',
// // // // // // // // // // // // // //                 background: '#f59e0b',
// // // // // // // // // // // // // //                 borderRadius: '4px',
// // // // // // // // // // // // // //                 display: 'flex',
// // // // // // // // // // // // // //                 alignItems: 'center',
// // // // // // // // // // // // // //                 justifyContent: 'center',
// // // // // // // // // // // // // //                 fontSize: '0.7rem',
// // // // // // // // // // // // // //                 fontWeight: '600',
// // // // // // // // // // // // // //                 color: 'white'
// // // // // // // // // // // // // //               }}>
// // // // // // // // // // // // // //                 B
// // // // // // // // // // // // // //               </div>
// // // // // // // // // // // // // //               <div>
// // // // // // // // // // // // // //                 <div style={{
// // // // // // // // // // // // // //                   fontSize: '0.75rem',
// // // // // // // // // // // // // //                   color: currentTheme.text,
// // // // // // // // // // // // // //                   fontWeight: '500'
// // // // // // // // // // // // // //                 }}>
// // // // // // // // // // // // // //                   Bitcoin
// // // // // // // // // // // // // //                 </div>
// // // // // // // // // // // // // //                 <div style={{
// // // // // // // // // // // // // //                   fontSize: '0.7rem',
// // // // // // // // // // // // // //                   color: '#10b981',
// // // // // // // // // // // // // //                   fontWeight: '500'
// // // // // // // // // // // // // //                 }}>
// // // // // // // // // // // // // //                   PKR 1,007,788.37
// // // // // // // // // // // // // //                 </div>
// // // // // // // // // // // // // //               </div>
// // // // // // // // // // // // // //             </div>

// // // // // // // // // // // // // //             <label style={{
// // // // // // // // // // // // // //               display: 'flex',
// // // // // // // // // // // // // //               alignItems: 'center',
// // // // // // // // // // // // // //               gap: '0.5rem',
// // // // // // // // // // // // // //               cursor: 'pointer',
// // // // // // // // // // // // // //               fontSize: '0.75rem',
// // // // // // // // // // // // // //               color: currentTheme.text
// // // // // // // // // // // // // //             }}>
// // // // // // // // // // // // // //               <input 
// // // // // // // // // // // // // //                 type="checkbox" 
// // // // // // // // // // // // // //                 style={{
// // // // // // // // // // // // // //                   cursor: 'pointer'
// // // // // // // // // // // // // //                 }}
// // // // // // // // // // // // // //               />
// // // // // // // // // // // // // //               Enable video on product page
// // // // // // // // // // // // // //             </label>
// // // // // // // // // // // // // //           </div>
// // // // // // // // // // // // // //         </div>

// // // // // // // // // // // // // //         {/* Original Video Options - Hidden in this layout but keeping the functionality */}
// // // // // // // // // // // // // //         <div style={{ display: 'none' }}>
// // // // // // // // // // // // // //           <div onClick={() => handleOptionClick(() => onCopyUrl(showVideoOptions.video.shopify_file_url))} />
// // // // // // // // // // // // // //           <div onClick={() => handleOptionClick(() => onDownload(showVideoOptions.video))} />
// // // // // // // // // // // // // //           <div onClick={() => handleOptionClick(() => onLoadProducts(showVideoOptions.video))} />
// // // // // // // // // // // // // //           <div onClick={() => handleOptionClick(() => onDelete(showVideoOptions.video.id, showVideoOptions.video.title))} />
// // // // // // // // // // // // // //         </div>

// // // // // // // // // // // // // //         <style jsx>{`
// // // // // // // // // // // // // //           @keyframes scaleIn {
// // // // // // // // // // // // // //             from {
// // // // // // // // // // // // // //               opacity: 0;
// // // // // // // // // // // // // //               transform: scale(0.95) translateY(-10px);
// // // // // // // // // // // // // //             }
// // // // // // // // // // // // // //             to {
// // // // // // // // // // // // // //               opacity: 1;
// // // // // // // // // // // // // //               transform: scale(1) translateY(0);
// // // // // // // // // // // // // //             }
// // // // // // // // // // // // // //           }
// // // // // // // // // // // // // //         `}</style>
// // // // // // // // // // // // // //       </div>
// // // // // // // // // // // // // //     </div>
// // // // // // // // // // // // // //   );
// // // // // // // // // // // // // // }





// // // // // // // // // // // // // // components/videogallerycomponents/VideoOptionsModal.jsx
// // // // // // // // // // // // // import { useState } from "react";

// // // // // // // // // // // // // export default function VideoOptionsModal({
// // // // // // // // // // // // //   showVideoOptions,
// // // // // // // // // // // // //   onHide,
// // // // // // // // // // // // //   onCopyUrl,
// // // // // // // // // // // // //   onDownload,
// // // // // // // // // // // // //   onLoadProducts,
// // // // // // // // // // // // //   onDelete,
// // // // // // // // // // // // //   isDarkTheme,
// // // // // // // // // // // // //   selectedProducts
// // // // // // // // // // // // // }) {
// // // // // // // // // // // // //   const [isLoadingProducts, setIsLoadingProducts] = useState(false);
// // // // // // // // // // // // //   const [localProducts, setLocalProducts] = useState([]);
// // // // // // // // // // // // //   const [showProductsModal, setShowProductsModal] = useState(false);

// // // // // // // // // // // // //   if (!showVideoOptions.show) return null;

// // // // // // // // // // // // //   const themeStyles = {
// // // // // // // // // // // // //     light: {
// // // // // // // // // // // // //       background: '#ffffff',
// // // // // // // // // // // // //       text: '#1f2937',
// // // // // // // // // // // // //       border: '#e5e7eb',
// // // // // // // // // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.15)',
// // // // // // // // // // // // //       hoverBackground: '#f3f4f6',
// // // // // // // // // // // // //       sectionBackground: '#f8fafc'
// // // // // // // // // // // // //     },
// // // // // // // // // // // // //     dark: {
// // // // // // // // // // // // //       background: '#374151',
// // // // // // // // // // // // //       text: '#f9fafb',
// // // // // // // // // // // // //       border: '#4b5563',
// // // // // // // // // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.4)',
// // // // // // // // // // // // //       hoverBackground: '#4b5563',
// // // // // // // // // // // // //       sectionBackground: '#4b5563'
// // // // // // // // // // // // //     }
// // // // // // // // // // // // //   };

// // // // // // // // // // // // //   const currentTheme = isDarkTheme ? themeStyles.dark : themeStyles.light;

// // // // // // // // // // // // //   const handleBackdropClick = (e) => {
// // // // // // // // // // // // //     if (e.target === e.currentTarget) {
// // // // // // // // // // // // //       onHide();
// // // // // // // // // // // // //     }
// // // // // // // // // // // // //   };

// // // // // // // // // // // // //   const handleOptionClick = (action) => {
// // // // // // // // // // // // //     action();
// // // // // // // // // // // // //     onHide();
// // // // // // // // // // // // //   };

// // // // // // // // // // // // //   // Function to handle Submit Products button click
// // // // // // // // // // // // //   const handleSubmitProducts = async () => {
// // // // // // // // // // // // //     try {
// // // // // // // // // // // // //       setIsLoadingProducts(true);
      
// // // // // // // // // // // // //       // Call the products API
// // // // // // // // // // // // //       const response = await fetch('/api/products');
// // // // // // // // // // // // //       const result = await response.json();
      
// // // // // // // // // // // // //       if (result.success) {
// // // // // // // // // // // // //         setLocalProducts(result.products);
// // // // // // // // // // // // //         // Instead of opening ProductsModal here, call the existing onLoadProducts function
// // // // // // // // // // // // //         // which will trigger the ProductsModal from the parent component
// // // // // // // // // // // // //         onLoadProducts(showVideoOptions.video);
// // // // // // // // // // // // //       } else {
// // // // // // // // // // // // //         console.error('Failed to load products:', result.error);
// // // // // // // // // // // // //       }
// // // // // // // // // // // // //     } catch (error) {
// // // // // // // // // // // // //       console.error('Error loading products:', error);
// // // // // // // // // // // // //     } finally {
// // // // // // // // // // // // //       setIsLoadingProducts(false);
// // // // // // // // // // // // //     }
// // // // // // // // // // // // //   };

// // // // // // // // // // // // //   // Get the selected products (either from props or local state)
// // // // // // // // // // // // //   const displayProducts = selectedProducts || new Set();

// // // // // // // // // // // // //   return (
// // // // // // // // // // // // //     <div 
// // // // // // // // // // // // //       style={{
// // // // // // // // // // // // //         position: 'fixed',
// // // // // // // // // // // // //         top: 0,
// // // // // // // // // // // // //         left: 0,
// // // // // // // // // // // // //         right: 0,
// // // // // // // // // // // // //         bottom: 0,
// // // // // // // // // // // // //         zIndex: 10000,
// // // // // // // // // // // // //         background: 'rgba(0, 0, 0, 0.5)',
// // // // // // // // // // // // //         display: 'flex',
// // // // // // // // // // // // //         justifyContent: 'center',
// // // // // // // // // // // // //         alignItems: 'center'
// // // // // // // // // // // // //       }}
// // // // // // // // // // // // //       onClick={handleBackdropClick}
// // // // // // // // // // // // //     >
// // // // // // // // // // // // //       <div 
// // // // // // // // // // // // //         style={{
// // // // // // // // // // // // //           background: currentTheme.background,
// // // // // // // // // // // // //           borderRadius: '12px',
// // // // // // // // // // // // //           border: `1px solid ${currentTheme.border}`,
// // // // // // // // // // // // //           boxShadow: currentTheme.shadow,
// // // // // // // // // // // // //           padding: '1.5rem',
// // // // // // // // // // // // //           maxWidth: '700px',
// // // // // // // // // // // // //           minWidth: '600px',
// // // // // // // // // // // // //           zIndex: 10001,
// // // // // // // // // // // // //           animation: 'scaleIn 0.2s ease-out',
// // // // // // // // // // // // //           display: 'flex',
// // // // // // // // // // // // //           flexDirection: 'row',
// // // // // // // // // // // // //           justifyContent: 'space-between',
// // // // // // // // // // // // //           alignItems: 'flex-start',
// // // // // // // // // // // // //           gap: '2rem'
// // // // // // // // // // // // //         }}
// // // // // // // // // // // // //       >
// // // // // // // // // // // // //         {/* Left Column - Video Player */}
// // // // // // // // // // // // //         <div style={{
// // // // // // // // // // // // //           flex: 1,
// // // // // // // // // // // // //           minWidth: '300px',
// // // // // // // // // // // // //           display: 'flex',
// // // // // // // // // // // // //           flexDirection: 'column',
// // // // // // // // // // // // //           gap: '1.5rem'
// // // // // // // // // // // // //         }}>
// // // // // // // // // // // // //           {/* Video Player Section */}
// // // // // // // // // // // // //           <div>
// // // // // // // // // // // // //             <h3 style={{
// // // // // // // // // // // // //               fontSize: '0.875rem',
// // // // // // // // // // // // //               fontWeight: '600',
// // // // // // // // // // // // //               color: currentTheme.text,
// // // // // // // // // // // // //               margin: '0 0 1rem 0'
// // // // // // // // // // // // //             }}>
// // // // // // // // // // // // //               Selected Video
// // // // // // // // // // // // //             </h3>
            
// // // // // // // // // // // // //             {/* Video Player */}
// // // // // // // // // // // // //             <div style={{
// // // // // // // // // // // // //               width: '100%',
// // // // // // // // // // // // //               borderRadius: '8px',
// // // // // // // // // // // // //               overflow: 'hidden',
// // // // // // // // // // // // //               background: isDarkTheme ? '#1f2937' : '#f3f4f6',
// // // // // // // // // // // // //               border: `1px solid ${currentTheme.border}`
// // // // // // // // // // // // //             }}>
// // // // // // // // // // // // //               <video
// // // // // // // // // // // // //                 controls
// // // // // // // // // // // // //                 style={{
// // // // // // // // // // // // //                   width: '100%',
// // // // // // // // // // // // //                   height: 'auto',
// // // // // // // // // // // // //                   maxHeight: '200px',
// // // // // // // // // // // // //                   objectFit: 'cover',
// // // // // // // // // // // // //                   display: 'block'
// // // // // // // // // // // // //                 }}
// // // // // // // // // // // // //                 src={showVideoOptions.video?.shopify_file_url}
// // // // // // // // // // // // //                 poster={showVideoOptions.video?.thumbnail_url}
// // // // // // // // // // // // //               />
// // // // // // // // // // // // //               <div style={{
// // // // // // // // // // // // //                 padding: '0.75rem',
// // // // // // // // // // // // //                 borderTop: `1px solid ${currentTheme.border}`
// // // // // // // // // // // // //               }}>
// // // // // // // // // // // // //                 <div style={{
// // // // // // // // // // // // //                   fontSize: '0.8rem',
// // // // // // // // // // // // //                   color: currentTheme.text,
// // // // // // // // // // // // //                   fontWeight: '600',
// // // // // // // // // // // // //                   marginBottom: '0.25rem'
// // // // // // // // // // // // //                 }}>
// // // // // // // // // // // // //                   {showVideoOptions.video?.title || 'Untitled Video'}
// // // // // // // // // // // // //                 </div>
// // // // // // // // // // // // //                 <div style={{
// // // // // // // // // // // // //                   fontSize: '0.7rem',
// // // // // // // // // // // // //                   color: isDarkTheme ? '#d1d5db' : '#6b7280'
// // // // // // // // // // // // //                 }}>
// // // // // // // // // // // // //                   {showVideoOptions.video?.duration ? `Duration: ${showVideoOptions.video.duration}` : 'Video'}
// // // // // // // // // // // // //                 </div>
// // // // // // // // // // // // //               </div>
// // // // // // // // // // // // //             </div>
// // // // // // // // // // // // //           </div>

// // // // // // // // // // // // //           {/* Video Actions Section */}
// // // // // // // // // // // // //           <div style={{
// // // // // // // // // // // // //             display: 'flex',
// // // // // // // // // // // // //             flexDirection: 'column',
// // // // // // // // // // // // //             gap: '0.5rem'
// // // // // // // // // // // // //           }}>
// // // // // // // // // // // // //             <button
// // // // // // // // // // // // //               onClick={() => handleOptionClick(() => onCopyUrl(showVideoOptions.video.shopify_file_url))}
// // // // // // // // // // // // //               style={{
// // // // // // // // // // // // //                 width: '100%',
// // // // // // // // // // // // //                 background: 'transparent',
// // // // // // // // // // // // //                 border: `1px solid ${currentTheme.border}`,
// // // // // // // // // // // // //                 color: currentTheme.text,
// // // // // // // // // // // // //                 padding: '0.5rem',
// // // // // // // // // // // // //                 borderRadius: '6px',
// // // // // // // // // // // // //                 fontSize: '0.75rem',
// // // // // // // // // // // // //                 fontWeight: '500',
// // // // // // // // // // // // //                 cursor: 'pointer',
// // // // // // // // // // // // //                 transition: 'all 0.2s',
// // // // // // // // // // // // //                 display: 'flex',
// // // // // // // // // // // // //                 alignItems: 'center',
// // // // // // // // // // // // //                 gap: '0.5rem',
// // // // // // // // // // // // //                 justifyContent: 'center'
// // // // // // // // // // // // //               }}
// // // // // // // // // // // // //               onMouseEnter={(e) => {
// // // // // // // // // // // // //                 e.target.style.background = currentTheme.hoverBackground;
// // // // // // // // // // // // //               }}
// // // // // // // // // // // // //               onMouseLeave={(e) => {
// // // // // // // // // // // // //                 e.target.style.background = 'transparent';
// // // // // // // // // // // // //               }}
// // // // // // // // // // // // //             >
// // // // // // // // // // // // //               üìã Copy Video URL
// // // // // // // // // // // // //             </button>

// // // // // // // // // // // // //             <button
// // // // // // // // // // // // //               onClick={() => handleOptionClick(() => onDownload(showVideoOptions.video))}
// // // // // // // // // // // // //               style={{
// // // // // // // // // // // // //                 width: '100%',
// // // // // // // // // // // // //                 background: 'transparent',
// // // // // // // // // // // // //                 border: `1px solid ${currentTheme.border}`,
// // // // // // // // // // // // //                 color: currentTheme.text,
// // // // // // // // // // // // //                 padding: '0.5rem',
// // // // // // // // // // // // //                 borderRadius: '6px',
// // // // // // // // // // // // //                 fontSize: '0.75rem',
// // // // // // // // // // // // //                 fontWeight: '500',
// // // // // // // // // // // // //                 cursor: 'pointer',
// // // // // // // // // // // // //                 transition: 'all 0.2s',
// // // // // // // // // // // // //                 display: 'flex',
// // // // // // // // // // // // //                 alignItems: 'center',
// // // // // // // // // // // // //                 gap: '0.5rem',
// // // // // // // // // // // // //                 justifyContent: 'center'
// // // // // // // // // // // // //               }}
// // // // // // // // // // // // //               onMouseEnter={(e) => {
// // // // // // // // // // // // //                 e.target.style.background = currentTheme.hoverBackground;
// // // // // // // // // // // // //               }}
// // // // // // // // // // // // //               onMouseLeave={(e) => {
// // // // // // // // // // // // //                 e.target.style.background = 'transparent';
// // // // // // // // // // // // //               }}
// // // // // // // // // // // // //             >
// // // // // // // // // // // // //               ‚¨áÔ∏è Download Video
// // // // // // // // // // // // //             </button>

// // // // // // // // // // // // //             <button
// // // // // // // // // // // // //               onClick={() => handleOptionClick(() => onDelete(showVideoOptions.video.id, showVideoOptions.video.title))}
// // // // // // // // // // // // //               style={{
// // // // // // // // // // // // //                 width: '100%',
// // // // // // // // // // // // //                 background: 'transparent',
// // // // // // // // // // // // //                 border: `1px solid #ef4444`,
// // // // // // // // // // // // //                 color: '#ef4444',
// // // // // // // // // // // // //                 padding: '0.5rem',
// // // // // // // // // // // // //                 borderRadius: '6px',
// // // // // // // // // // // // //                 fontSize: '0.75rem',
// // // // // // // // // // // // //                 fontWeight: '500',
// // // // // // // // // // // // //                 cursor: 'pointer',
// // // // // // // // // // // // //                 transition: 'all 0.2s',
// // // // // // // // // // // // //                 display: 'flex',
// // // // // // // // // // // // //                 alignItems: 'center',
// // // // // // // // // // // // //                 gap: '0.5rem',
// // // // // // // // // // // // //                 justifyContent: 'center'
// // // // // // // // // // // // //               }}
// // // // // // // // // // // // //               onMouseEnter={(e) => {
// // // // // // // // // // // // //                 e.target.style.background = '#ef4444';
// // // // // // // // // // // // //                 e.target.style.color = 'white';
// // // // // // // // // // // // //               }}
// // // // // // // // // // // // //               onMouseLeave={(e) => {
// // // // // // // // // // // // //                 e.target.style.background = 'transparent';
// // // // // // // // // // // // //                 e.target.style.color = '#ef4444';
// // // // // // // // // // // // //               }}
// // // // // // // // // // // // //             >
// // // // // // // // // // // // //               üóëÔ∏è Delete Video
// // // // // // // // // // // // //             </button>
// // // // // // // // // // // // //           </div>
// // // // // // // // // // // // //         </div>

// // // // // // // // // // // // //         {/* Right Column - Products Section */}
// // // // // // // // // // // // //         <div style={{
// // // // // // // // // // // // //           flex: 1,
// // // // // // // // // // // // //           minWidth: '250px',
// // // // // // // // // // // // //           display: 'flex',
// // // // // // // // // // // // //           flexDirection: 'column',
// // // // // // // // // // // // //           gap: '1.5rem'
// // // // // // // // // // // // //         }}>
// // // // // // // // // // // // //           {/* Products Section */}
// // // // // // // // // // // // //           <div>
// // // // // // // // // // // // //             <h3 style={{
// // // // // // // // // // // // //               fontSize: '0.875rem',
// // // // // // // // // // // // //               fontWeight: '600',
// // // // // // // // // // // // //               color: currentTheme.text,
// // // // // // // // // // // // //               margin: '0 0 1rem 0'
// // // // // // // // // // // // //             }}>
// // // // // // // // // // // // //               Product Management
// // // // // // // // // // // // //             </h3>
            
// // // // // // // // // // // // //             <button
// // // // // // // // // // // // //               onClick={handleSubmitProducts}
// // // // // // // // // // // // //               disabled={isLoadingProducts}
// // // // // // // // // // // // //               style={{
// // // // // // // // // // // // //                 width: '100%',
// // // // // // // // // // // // //                 background: '#10b981',
// // // // // // // // // // // // //                 color: 'white',
// // // // // // // // // // // // //                 border: 'none',
// // // // // // // // // // // // //                 padding: '0.5rem',
// // // // // // // // // // // // //                 borderRadius: '6px',
// // // // // // // // // // // // //                 fontSize: '0.75rem',
// // // // // // // // // // // // //                 fontWeight: '500',
// // // // // // // // // // // // //                 cursor: isLoadingProducts ? 'not-allowed' : 'pointer',
// // // // // // // // // // // // //                 marginBottom: '1rem',
// // // // // // // // // // // // //                 transition: 'background-color 0.2s',
// // // // // // // // // // // // //                 opacity: isLoadingProducts ? 0.6 : 1
// // // // // // // // // // // // //               }}
// // // // // // // // // // // // //               onMouseEnter={(e) => {
// // // // // // // // // // // // //                 if (!isLoadingProducts) {
// // // // // // // // // // // // //                   e.target.style.background = '#059669';
// // // // // // // // // // // // //                 }
// // // // // // // // // // // // //               }}
// // // // // // // // // // // // //               onMouseLeave={(e) => {
// // // // // // // // // // // // //                 if (!isLoadingProducts) {
// // // // // // // // // // // // //                   e.target.style.background = '#10b981';
// // // // // // // // // // // // //                 }
// // // // // // // // // // // // //               }}
// // // // // // // // // // // // //             >
// // // // // // // // // // // // //               {isLoadingProducts ? 'Loading Products...' : 'Submit Products'}
// // // // // // // // // // // // //             </button>

// // // // // // // // // // // // //             {/* Selected Products List */}
// // // // // // // // // // // // //             {displayProducts.size > 0 && (
// // // // // // // // // // // // //               <div>
// // // // // // // // // // // // //                 <div style={{
// // // // // // // // // // // // //                   fontSize: '0.75rem',
// // // // // // // // // // // // //                   fontWeight: '600',
// // // // // // // // // // // // //                   color: currentTheme.text,
// // // // // // // // // // // // //                   marginBottom: '0.75rem'
// // // // // // // // // // // // //                 }}>
// // // // // // // // // // // // //                   Selected Products ({displayProducts.size})
// // // // // // // // // // // // //                 </div>
                
// // // // // // // // // // // // //                 <div style={{
// // // // // // // // // // // // //                   maxHeight: '150px',
// // // // // // // // // // // // //                   overflowY: 'auto',
// // // // // // // // // // // // //                   border: `1px solid ${currentTheme.border}`,
// // // // // // // // // // // // //                   borderRadius: '6px',
// // // // // // // // // // // // //                   padding: '0.5rem',
// // // // // // // // // // // // //                   background: isDarkTheme ? '#1f2937' : '#f8fafc'
// // // // // // // // // // // // //                 }}>
// // // // // // // // // // // // //                   {Array.from(displayProducts).map((productId) => {
// // // // // // // // // // // // //                     // Since we don't have the full product data here, just show the ID
// // // // // // // // // // // // //                     // In a real app, you would have the product data available
// // // // // // // // // // // // //                     return (
// // // // // // // // // // // // //                       <div
// // // // // // // // // // // // //                         key={productId}
// // // // // // // // // // // // //                         style={{
// // // // // // // // // // // // //                           display: 'flex',
// // // // // // // // // // // // //                           alignItems: 'center',
// // // // // // // // // // // // //                           gap: '0.5rem',
// // // // // // // // // // // // //                           padding: '0.5rem',
// // // // // // // // // // // // //                           marginBottom: '0.25rem',
// // // // // // // // // // // // //                           background: isDarkTheme ? '#374151' : '#ffffff',
// // // // // // // // // // // // //                           borderRadius: '4px',
// // // // // // // // // // // // //                           fontSize: '0.7rem'
// // // // // // // // // // // // //                         }}
// // // // // // // // // // // // //                       >
// // // // // // // // // // // // //                         <div style={{
// // // // // // // // // // // // //                           width: '20px',
// // // // // // // // // // // // //                           height: '20px',
// // // // // // // // // // // // //                           background: '#3b82f6',
// // // // // // // // // // // // //                           borderRadius: '3px',
// // // // // // // // // // // // //                           display: 'flex',
// // // // // // // // // // // // //                           alignItems: 'center',
// // // // // // // // // // // // //                           justifyContent: 'center',
// // // // // // // // // // // // //                           color: 'white',
// // // // // // // // // // // // //                           fontSize: '0.6rem',
// // // // // // // // // // // // //                           fontWeight: 'bold'
// // // // // // // // // // // // //                         }}>
// // // // // // // // // // // // //                           P
// // // // // // // // // // // // //                         </div>
// // // // // // // // // // // // //                         <div style={{ flex: 1 }}>
// // // // // // // // // // // // //                           <div style={{
// // // // // // // // // // // // //                             color: currentTheme.text,
// // // // // // // // // // // // //                             fontWeight: '500'
// // // // // // // // // // // // //                           }}>
// // // // // // // // // // // // //                             Product ID: {productId}
// // // // // // // // // // // // //                           </div>
// // // // // // // // // // // // //                           <div style={{
// // // // // // // // // // // // //                             color: '#10b981',
// // // // // // // // // // // // //                             fontSize: '0.65rem'
// // // // // // // // // // // // //                           }}>
// // // // // // // // // // // // //                             Click "Submit Products" to view details
// // // // // // // // // // // // //                           </div>
// // // // // // // // // // // // //                         </div>
// // // // // // // // // // // // //                       </div>
// // // // // // // // // // // // //                     );
// // // // // // // // // // // // //                   })}
// // // // // // // // // // // // //                 </div>
// // // // // // // // // // // // //               </div>
// // // // // // // // // // // // //             )}

// // // // // // // // // // // // //             <label style={{
// // // // // // // // // // // // //               display: 'flex',
// // // // // // // // // // // // //               alignItems: 'center',
// // // // // // // // // // // // //               gap: '0.5rem',
// // // // // // // // // // // // //               cursor: 'pointer',
// // // // // // // // // // // // //               fontSize: '0.75rem',
// // // // // // // // // // // // //               color: currentTheme.text,
// // // // // // // // // // // // //               marginTop: '1rem'
// // // // // // // // // // // // //             }}>
// // // // // // // // // // // // //               <input 
// // // // // // // // // // // // //                 type="checkbox" 
// // // // // // // // // // // // //                 style={{
// // // // // // // // // // // // //                   cursor: 'pointer'
// // // // // // // // // // // // //                 }}
// // // // // // // // // // // // //               />
// // // // // // // // // // // // //               Enable video on product page
// // // // // // // // // // // // //             </label>
// // // // // // // // // // // // //           </div>
// // // // // // // // // // // // //         </div>

// // // // // // // // // // // // //         <style jsx>{`
// // // // // // // // // // // // //           @keyframes scaleIn {
// // // // // // // // // // // // //             from {
// // // // // // // // // // // // //               opacity: 0;
// // // // // // // // // // // // //               transform: scale(0.95) translateY(-10px);
// // // // // // // // // // // // //             }
// // // // // // // // // // // // //             to {
// // // // // // // // // // // // //               opacity: 1;
// // // // // // // // // // // // //               transform: scale(1) translateY(0);
// // // // // // // // // // // // //             }
// // // // // // // // // // // // //           }
// // // // // // // // // // // // //         `}</style>
// // // // // // // // // // // // //       </div>
// // // // // // // // // // // // //     </div>
// // // // // // // // // // // // //   );
// // // // // // // // // // // // // }





// // // // // // // // // // // // // components/videogallerycomponents/VideoOptionsModal.jsx
// // // // // // // // // // // // import { useState, useEffect } from "react";
// // // // // // // // // // // // import ProductsModal from "./ProductsModal";

// // // // // // // // // // // // export default function VideoOptionsModal({
// // // // // // // // // // // //   showVideoOptions,
// // // // // // // // // // // //   onHide,
// // // // // // // // // // // //   onCopyUrl,
// // // // // // // // // // // //   onDownload,
// // // // // // // // // // // //   onLoadProducts,
// // // // // // // // // // // //   onDelete,
// // // // // // // // // // // //   isDarkTheme,
// // // // // // // // // // // //   selectedProducts,
// // // // // // // // // // // //   products,
// // // // // // // // // // // //   onToggleProduct,
// // // // // // // // // // // //   onSaveProducts
// // // // // // // // // // // // }) {
// // // // // // // // // // // //   const [isLoadingProducts, setIsLoadingProducts] = useState(false);
// // // // // // // // // // // //   const [showProductsModal, setShowProductsModal] = useState(false);
// // // // // // // // // // // //   const [savedProducts, setSavedProducts] = useState([]);
// // // // // // // // // // // //   const [isLoadingSavedProducts, setIsLoadingSavedProducts] = useState(false);

// // // // // // // // // // // //   // Fetch saved products when modal opens or video changes
// // // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // // //     if (showVideoOptions.show && showVideoOptions.video?.id) {
// // // // // // // // // // // //       fetchSavedProducts();
// // // // // // // // // // // //     }
// // // // // // // // // // // //   }, [showVideoOptions.show, showVideoOptions.video?.id]);

// // // // // // // // // // // //   const fetchSavedProducts = async () => {
// // // // // // // // // // // //     try {
// // // // // // // // // // // //       setIsLoadingSavedProducts(true);
// // // // // // // // // // // //       const response = await fetch(`/api/videoproducts?videoId=${showVideoOptions.video.id}`);
// // // // // // // // // // // //       const result = await response.json();
      
// // // // // // // // // // // //       if (result.success) {
// // // // // // // // // // // //         setSavedProducts(result.products);
// // // // // // // // // // // //       } else {
// // // // // // // // // // // //         console.error('Failed to fetch saved products:', result.error);
// // // // // // // // // // // //         setSavedProducts([]);
// // // // // // // // // // // //       }
// // // // // // // // // // // //     } catch (error) {
// // // // // // // // // // // //       console.error('Error fetching saved products:', error);
// // // // // // // // // // // //       setSavedProducts([]);
// // // // // // // // // // // //     } finally {
// // // // // // // // // // // //       setIsLoadingSavedProducts(false);
// // // // // // // // // // // //     }
// // // // // // // // // // // //   };

// // // // // // // // // // // //   const handleBackdropClick = (e) => {
// // // // // // // // // // // //     if (e.target === e.currentTarget) {
// // // // // // // // // // // //       onHide();
// // // // // // // // // // // //     }
// // // // // // // // // // // //   };

// // // // // // // // // // // //   const handleOptionClick = (action) => {
// // // // // // // // // // // //     action();
// // // // // // // // // // // //     onHide();
// // // // // // // // // // // //   };

// // // // // // // // // // // //   // Function to handle Submit Products button click
// // // // // // // // // // // //   const handleSubmitProducts = async () => {
// // // // // // // // // // // //     try {
// // // // // // // // // // // //       setIsLoadingProducts(true);
      
// // // // // // // // // // // //       // Call the products API
// // // // // // // // // // // //       const response = await fetch('/api/products');
// // // // // // // // // // // //       const result = await response.json();
      
// // // // // // // // // // // //       if (result.success) {
// // // // // // // // // // // //         setShowProductsModal(true);
// // // // // // // // // // // //       } else {
// // // // // // // // // // // //         console.error('Failed to load products:', result.error);
// // // // // // // // // // // //       }
// // // // // // // // // // // //     } catch (error) {
// // // // // // // // // // // //       console.error('Error loading products:', error);
// // // // // // // // // // // //     } finally {
// // // // // // // // // // // //       setIsLoadingProducts(false);
// // // // // // // // // // // //     }
// // // // // // // // // // // //   };

// // // // // // // // // // // //   const handleSaveProducts = async () => {
// // // // // // // // // // // //     if (onSaveProducts) {
// // // // // // // // // // // //       await onSaveProducts();
// // // // // // // // // // // //     }
// // // // // // // // // // // //     setShowProductsModal(false);
// // // // // // // // // // // //     // Refresh saved products after saving
// // // // // // // // // // // //     setTimeout(() => {
// // // // // // // // // // // //       fetchSavedProducts();
// // // // // // // // // // // //     }, 500); // Small delay to ensure database is updated
// // // // // // // // // // // //   };

// // // // // // // // // // // //   const handleHideProductsModal = () => {
// // // // // // // // // // // //     setShowProductsModal(false);
// // // // // // // // // // // //   };

// // // // // // // // // // // //   // Get the selected products
// // // // // // // // // // // //   const displayProducts = selectedProducts || new Set();

// // // // // // // // // // // //   // Early return should be AFTER all hooks
// // // // // // // // // // // //   if (!showVideoOptions.show) return null;

// // // // // // // // // // // //   const themeStyles = {
// // // // // // // // // // // //     light: {
// // // // // // // // // // // //       background: '#ffffff',
// // // // // // // // // // // //       text: '#1f2937',
// // // // // // // // // // // //       border: '#e5e7eb',
// // // // // // // // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.15)',
// // // // // // // // // // // //       hoverBackground: '#f3f4f6',
// // // // // // // // // // // //       sectionBackground: '#f8fafc'
// // // // // // // // // // // //     },
// // // // // // // // // // // //     dark: {
// // // // // // // // // // // //       background: '#374151',
// // // // // // // // // // // //       text: '#f9fafb',
// // // // // // // // // // // //       border: '#4b5563',
// // // // // // // // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.4)',
// // // // // // // // // // // //       hoverBackground: '#4b5563',
// // // // // // // // // // // //       sectionBackground: '#4b5563'
// // // // // // // // // // // //     }
// // // // // // // // // // // //   };

// // // // // // // // // // // //   const currentTheme = isDarkTheme ? themeStyles.dark : themeStyles.light;

// // // // // // // // // // // //   return (
// // // // // // // // // // // //     <>
// // // // // // // // // // // //       <div 
// // // // // // // // // // // //         style={{
// // // // // // // // // // // //           position: 'fixed',
// // // // // // // // // // // //           top: 0,
// // // // // // // // // // // //           left: 0,
// // // // // // // // // // // //           right: 0,
// // // // // // // // // // // //           bottom: 0,
// // // // // // // // // // // //           zIndex: 10000,
// // // // // // // // // // // //           background: 'rgba(0, 0, 0, 0.5)',
// // // // // // // // // // // //           display: 'flex',
// // // // // // // // // // // //           justifyContent: 'center',
// // // // // // // // // // // //           alignItems: 'center'
// // // // // // // // // // // //         }}
// // // // // // // // // // // //         onClick={handleBackdropClick}
// // // // // // // // // // // //       >
// // // // // // // // // // // //         <div 
// // // // // // // // // // // //           style={{
// // // // // // // // // // // //             background: currentTheme.background,
// // // // // // // // // // // //             borderRadius: '12px',
// // // // // // // // // // // //             border: `1px solid ${currentTheme.border}`,
// // // // // // // // // // // //             boxShadow: currentTheme.shadow,
// // // // // // // // // // // //             padding: '1.5rem',
// // // // // // // // // // // //             maxWidth: '700px',
// // // // // // // // // // // //             minWidth: '600px',
// // // // // // // // // // // //             maxHeight: '80vh',
// // // // // // // // // // // //             zIndex: 10001,
// // // // // // // // // // // //             animation: 'scaleIn 0.2s ease-out',
// // // // // // // // // // // //             display: 'flex',
// // // // // // // // // // // //             flexDirection: 'row',
// // // // // // // // // // // //             justifyContent: 'space-between',
// // // // // // // // // // // //             alignItems: 'flex-start',
// // // // // // // // // // // //             gap: '2rem',
// // // // // // // // // // // //             overflow: 'hidden'
// // // // // // // // // // // //           }}
// // // // // // // // // // // //         >
// // // // // // // // // // // //           {/* Left Column - Video Player */}
// // // // // // // // // // // //           <div style={{
// // // // // // // // // // // //             flex: 1,
// // // // // // // // // // // //             minWidth: '300px',
// // // // // // // // // // // //             display: 'flex',
// // // // // // // // // // // //             flexDirection: 'column',
// // // // // // // // // // // //             gap: '1.5rem'
// // // // // // // // // // // //           }}>
// // // // // // // // // // // //             {/* Video Player Section */}
// // // // // // // // // // // //             <div>
// // // // // // // // // // // //               <h3 style={{
// // // // // // // // // // // //                 fontSize: '0.875rem',
// // // // // // // // // // // //                 fontWeight: '600',
// // // // // // // // // // // //                 color: currentTheme.text,
// // // // // // // // // // // //                 margin: '0 0 1rem 0'
// // // // // // // // // // // //               }}>
// // // // // // // // // // // //                 Selected Video
// // // // // // // // // // // //               </h3>
              
// // // // // // // // // // // //               {/* Video Player */}
// // // // // // // // // // // //               <div style={{
// // // // // // // // // // // //                 width: '100%',
// // // // // // // // // // // //                 borderRadius: '8px',
// // // // // // // // // // // //                 overflow: 'hidden',
// // // // // // // // // // // //                 background: isDarkTheme ? '#1f2937' : '#f3f4f6',
// // // // // // // // // // // //                 border: `1px solid ${currentTheme.border}`
// // // // // // // // // // // //               }}>
// // // // // // // // // // // //                 <video
// // // // // // // // // // // //                   controls
// // // // // // // // // // // //                   style={{
// // // // // // // // // // // //                     width: '100%',
// // // // // // // // // // // //                     height: 'auto',
// // // // // // // // // // // //                     maxHeight: '200px',
// // // // // // // // // // // //                     objectFit: 'cover',
// // // // // // // // // // // //                     display: 'block'
// // // // // // // // // // // //                   }}
// // // // // // // // // // // //                   src={showVideoOptions.video?.shopify_file_url}
// // // // // // // // // // // //                   poster={showVideoOptions.video?.thumbnail_url}
// // // // // // // // // // // //                 />
// // // // // // // // // // // //                 <div style={{
// // // // // // // // // // // //                   padding: '0.75rem',
// // // // // // // // // // // //                   borderTop: `1px solid ${currentTheme.border}`
// // // // // // // // // // // //                 }}>
// // // // // // // // // // // //                   <div style={{
// // // // // // // // // // // //                     fontSize: '0.8rem',
// // // // // // // // // // // //                     color: currentTheme.text,
// // // // // // // // // // // //                     fontWeight: '600',
// // // // // // // // // // // //                     marginBottom: '0.25rem'
// // // // // // // // // // // //                   }}>
// // // // // // // // // // // //                     {showVideoOptions.video?.title || 'Untitled Video'}
// // // // // // // // // // // //                   </div>
// // // // // // // // // // // //                   <div style={{
// // // // // // // // // // // //                     fontSize: '0.7rem',
// // // // // // // // // // // //                     color: isDarkTheme ? '#d1d5db' : '#6b7280'
// // // // // // // // // // // //                   }}>
// // // // // // // // // // // //                     {showVideoOptions.video?.duration ? `Duration: ${showVideoOptions.video.duration}` : 'Video'}
// // // // // // // // // // // //                   </div>
// // // // // // // // // // // //                 </div>
// // // // // // // // // // // //               </div>
// // // // // // // // // // // //             </div>

// // // // // // // // // // // //             {/* Video Actions Section */}
// // // // // // // // // // // //             <div style={{
// // // // // // // // // // // //               display: 'flex',
// // // // // // // // // // // //               flexDirection: 'column',
// // // // // // // // // // // //               gap: '0.5rem'
// // // // // // // // // // // //             }}>
// // // // // // // // // // // //               <button
// // // // // // // // // // // //                 onClick={() => handleOptionClick(() => onCopyUrl(showVideoOptions.video.shopify_file_url))}
// // // // // // // // // // // //                 style={{
// // // // // // // // // // // //                   width: '100%',
// // // // // // // // // // // //                   background: 'transparent',
// // // // // // // // // // // //                   border: `1px solid ${currentTheme.border}`,
// // // // // // // // // // // //                   color: currentTheme.text,
// // // // // // // // // // // //                   padding: '0.5rem',
// // // // // // // // // // // //                   borderRadius: '6px',
// // // // // // // // // // // //                   fontSize: '0.75rem',
// // // // // // // // // // // //                   fontWeight: '500',
// // // // // // // // // // // //                   cursor: 'pointer',
// // // // // // // // // // // //                   transition: 'all 0.2s',
// // // // // // // // // // // //                   display: 'flex',
// // // // // // // // // // // //                   alignItems: 'center',
// // // // // // // // // // // //                   gap: '0.5rem',
// // // // // // // // // // // //                   justifyContent: 'center'
// // // // // // // // // // // //                 }}
// // // // // // // // // // // //                 onMouseEnter={(e) => {
// // // // // // // // // // // //                   e.target.style.background = currentTheme.hoverBackground;
// // // // // // // // // // // //                 }}
// // // // // // // // // // // //                 onMouseLeave={(e) => {
// // // // // // // // // // // //                   e.target.style.background = 'transparent';
// // // // // // // // // // // //                 }}
// // // // // // // // // // // //               >
// // // // // // // // // // // //                 üìã Copy Video URL
// // // // // // // // // // // //               </button>

// // // // // // // // // // // //               <button
// // // // // // // // // // // //                 onClick={() => handleOptionClick(() => onDownload(showVideoOptions.video))}
// // // // // // // // // // // //                 style={{
// // // // // // // // // // // //                   width: '100%',
// // // // // // // // // // // //                   background: 'transparent',
// // // // // // // // // // // //                   border: `1px solid ${currentTheme.border}`,
// // // // // // // // // // // //                   color: currentTheme.text,
// // // // // // // // // // // //                   padding: '0.5rem',
// // // // // // // // // // // //                   borderRadius: '6px',
// // // // // // // // // // // //                   fontSize: '0.75rem',
// // // // // // // // // // // //                   fontWeight: '500',
// // // // // // // // // // // //                   cursor: 'pointer',
// // // // // // // // // // // //                   transition: 'all 0.2s',
// // // // // // // // // // // //                   display: 'flex',
// // // // // // // // // // // //                   alignItems: 'center',
// // // // // // // // // // // //                   gap: '0.5rem',
// // // // // // // // // // // //                   justifyContent: 'center'
// // // // // // // // // // // //                 }}
// // // // // // // // // // // //                 onMouseEnter={(e) => {
// // // // // // // // // // // //                   e.target.style.background = currentTheme.hoverBackground;
// // // // // // // // // // // //                 }}
// // // // // // // // // // // //                 onMouseLeave={(e) => {
// // // // // // // // // // // //                   e.target.style.background = 'transparent';
// // // // // // // // // // // //                 }}
// // // // // // // // // // // //               >
// // // // // // // // // // // //                 ‚¨áÔ∏è Download Video
// // // // // // // // // // // //               </button>

// // // // // // // // // // // //               <button
// // // // // // // // // // // //                 onClick={() => handleOptionClick(() => onDelete(showVideoOptions.video.id, showVideoOptions.video.title))}
// // // // // // // // // // // //                 style={{
// // // // // // // // // // // //                   width: '100%',
// // // // // // // // // // // //                   background: 'transparent',
// // // // // // // // // // // //                   border: `1px solid #ef4444`,
// // // // // // // // // // // //                   color: '#ef4444',
// // // // // // // // // // // //                   padding: '0.5rem',
// // // // // // // // // // // //                   borderRadius: '6px',
// // // // // // // // // // // //                   fontSize: '0.75rem',
// // // // // // // // // // // //                   fontWeight: '500',
// // // // // // // // // // // //                   cursor: 'pointer',
// // // // // // // // // // // //                   transition: 'all 0.2s',
// // // // // // // // // // // //                   display: 'flex',
// // // // // // // // // // // //                   alignItems: 'center',
// // // // // // // // // // // //                   gap: '0.5rem',
// // // // // // // // // // // //                   justifyContent: 'center'
// // // // // // // // // // // //                 }}
// // // // // // // // // // // //                 onMouseEnter={(e) => {
// // // // // // // // // // // //                   e.target.style.background = '#ef4444';
// // // // // // // // // // // //                   e.target.style.color = 'white';
// // // // // // // // // // // //                 }}
// // // // // // // // // // // //                 onMouseLeave={(e) => {
// // // // // // // // // // // //                   e.target.style.background = 'transparent';
// // // // // // // // // // // //                   e.target.style.color = '#ef4444';
// // // // // // // // // // // //                 }}
// // // // // // // // // // // //               >
// // // // // // // // // // // //                 üóëÔ∏è Delete Video
// // // // // // // // // // // //               </button>
// // // // // // // // // // // //             </div>
// // // // // // // // // // // //           </div>

// // // // // // // // // // // //           {/* Right Column - Products Section */}
// // // // // // // // // // // //           <div style={{
// // // // // // // // // // // //             flex: 1,
// // // // // // // // // // // //             minWidth: '250px',
// // // // // // // // // // // //             display: 'flex',
// // // // // // // // // // // //             flexDirection: 'column',
// // // // // // // // // // // //             gap: '1.5rem',
// // // // // // // // // // // //             height: '100%',
// // // // // // // // // // // //             overflow: 'hidden'
// // // // // // // // // // // //           }}>
// // // // // // // // // // // //             {/* Products Section */}
// // // // // // // // // // // //             <div style={{
// // // // // // // // // // // //               display: 'flex',
// // // // // // // // // // // //               flexDirection: 'column',
// // // // // // // // // // // //               height: '100%',
// // // // // // // // // // // //               gap: '1rem'
// // // // // // // // // // // //             }}>
// // // // // // // // // // // //               <h3 style={{
// // // // // // // // // // // //                 fontSize: '0.875rem',
// // // // // // // // // // // //                 fontWeight: '600',
// // // // // // // // // // // //                 color: currentTheme.text,
// // // // // // // // // // // //                 margin: 0
// // // // // // // // // // // //               }}>
// // // // // // // // // // // //                 Product Management
// // // // // // // // // // // //               </h3>
              
// // // // // // // // // // // //               <button
// // // // // // // // // // // //                 onClick={handleSubmitProducts}
// // // // // // // // // // // //                 disabled={isLoadingProducts}
// // // // // // // // // // // //                 style={{
// // // // // // // // // // // //                   width: '100%',
// // // // // // // // // // // //                   background: '#10b981',
// // // // // // // // // // // //                   color: 'white',
// // // // // // // // // // // //                   border: 'none',
// // // // // // // // // // // //                   padding: '0.5rem',
// // // // // // // // // // // //                   borderRadius: '6px',
// // // // // // // // // // // //                   fontSize: '0.75rem',
// // // // // // // // // // // //                   fontWeight: '500',
// // // // // // // // // // // //                   cursor: isLoadingProducts ? 'not-allowed' : 'pointer',
// // // // // // // // // // // //                   transition: 'background-color 0.2s',
// // // // // // // // // // // //                   opacity: isLoadingProducts ? 0.6 : 1
// // // // // // // // // // // //                 }}
// // // // // // // // // // // //                 onMouseEnter={(e) => {
// // // // // // // // // // // //                   if (!isLoadingProducts) {
// // // // // // // // // // // //                     e.target.style.background = '#059669';
// // // // // // // // // // // //                   }
// // // // // // // // // // // //                 }}
// // // // // // // // // // // //                 onMouseLeave={(e) => {
// // // // // // // // // // // //                   if (!isLoadingProducts) {
// // // // // // // // // // // //                     e.target.style.background = '#10b981';
// // // // // // // // // // // //                   }
// // // // // // // // // // // //                 }}
// // // // // // // // // // // //               >
// // // // // // // // // // // //                 {isLoadingProducts ? 'Loading Products...' : 'Submit Products'}
// // // // // // // // // // // //               </button>

// // // // // // // // // // // //               {/* Saved Products Section */}
// // // // // // // // // // // //               <div style={{
// // // // // // // // // // // //                 flex: 1,
// // // // // // // // // // // //                 display: 'flex',
// // // // // // // // // // // //                 flexDirection: 'column',
// // // // // // // // // // // //                 overflow: 'hidden'
// // // // // // // // // // // //               }}>
// // // // // // // // // // // //                 <div style={{
// // // // // // // // // // // //                   fontSize: '0.75rem',
// // // // // // // // // // // //                   fontWeight: '600',
// // // // // // // // // // // //                   color: currentTheme.text,
// // // // // // // // // // // //                   marginBottom: '0.5rem'
// // // // // // // // // // // //                 }}>
// // // // // // // // // // // //                   Saved Products {savedProducts.length > 0 && `(${savedProducts.length})`}
// // // // // // // // // // // //                 </div>
                
// // // // // // // // // // // //                 {isLoadingSavedProducts ? (
// // // // // // // // // // // //                   <div style={{
// // // // // // // // // // // //                     textAlign: 'center',
// // // // // // // // // // // //                     padding: '1rem',
// // // // // // // // // // // //                     color: currentTheme.text,
// // // // // // // // // // // //                     fontSize: '0.7rem',
// // // // // // // // // // // //                     border: `1px solid ${currentTheme.border}`,
// // // // // // // // // // // //                     borderRadius: '6px',
// // // // // // // // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc'
// // // // // // // // // // // //                   }}>
// // // // // // // // // // // //                     Loading saved products...
// // // // // // // // // // // //                   </div>
// // // // // // // // // // // //                 ) : savedProducts.length > 0 ? (
// // // // // // // // // // // //                   <div style={{
// // // // // // // // // // // //                     flex: 1,
// // // // // // // // // // // //                     overflowY: 'auto',
// // // // // // // // // // // //                     border: `1px solid ${currentTheme.border}`,
// // // // // // // // // // // //                     borderRadius: '6px',
// // // // // // // // // // // //                     padding: '0.5rem',
// // // // // // // // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // // // // // // // // // // //                     maxHeight: '200px'
// // // // // // // // // // // //                   }}>
// // // // // // // // // // // //                     {savedProducts.map((product) => (
// // // // // // // // // // // //                       <div
// // // // // // // // // // // //                         key={product.video_product_id || product.id}
// // // // // // // // // // // //                         style={{
// // // // // // // // // // // //                           display: 'flex',
// // // // // // // // // // // //                           alignItems: 'center',
// // // // // // // // // // // //                           gap: '0.5rem',
// // // // // // // // // // // //                           padding: '0.5rem',
// // // // // // // // // // // //                           marginBottom: '0.25rem',
// // // // // // // // // // // //                           background: isDarkTheme ? '#374151' : '#ffffff',
// // // // // // // // // // // //                           borderRadius: '4px',
// // // // // // // // // // // //                           fontSize: '0.7rem'
// // // // // // // // // // // //                         }}
// // // // // // // // // // // //                       >
// // // // // // // // // // // //                         {product.image_url ? (
// // // // // // // // // // // //                           <img 
// // // // // // // // // // // //                             src={product.image_url} 
// // // // // // // // // // // //                             alt={product.title}
// // // // // // // // // // // //                             style={{
// // // // // // // // // // // //                               width: '20px',
// // // // // // // // // // // //                               height: '20px',
// // // // // // // // // // // //                               borderRadius: '3px',
// // // // // // // // // // // //                               objectFit: 'cover'
// // // // // // // // // // // //                             }}
// // // // // // // // // // // //                           />
// // // // // // // // // // // //                         ) : (
// // // // // // // // // // // //                           <div style={{
// // // // // // // // // // // //                             width: '20px',
// // // // // // // // // // // //                             height: '20px',
// // // // // // // // // // // //                             background: '#3b82f6',
// // // // // // // // // // // //                             borderRadius: '3px',
// // // // // // // // // // // //                             display: 'flex',
// // // // // // // // // // // //                             alignItems: 'center',
// // // // // // // // // // // //                             justifyContent: 'center',
// // // // // // // // // // // //                             color: 'white',
// // // // // // // // // // // //                             fontSize: '0.6rem',
// // // // // // // // // // // //                             fontWeight: 'bold'
// // // // // // // // // // // //                           }}>
// // // // // // // // // // // //                             P
// // // // // // // // // // // //                           </div>
// // // // // // // // // // // //                         )}
// // // // // // // // // // // //                         <div style={{ flex: 1, minWidth: 0 }}>
// // // // // // // // // // // //                           <div style={{
// // // // // // // // // // // //                             color: currentTheme.text,
// // // // // // // // // // // //                             fontWeight: '500',
// // // // // // // // // // // //                             whiteSpace: 'nowrap',
// // // // // // // // // // // //                             overflow: 'hidden',
// // // // // // // // // // // //                             textOverflow: 'ellipsis'
// // // // // // // // // // // //                           }}>
// // // // // // // // // // // //                             {product.title}
// // // // // // // // // // // //                           </div>
// // // // // // // // // // // //                           <div style={{
// // // // // // // // // // // //                             color: '#10b981',
// // // // // // // // // // // //                             fontSize: '0.65rem'
// // // // // // // // // // // //                           }}>
// // // // // // // // // // // //                             ${product.price}
// // // // // // // // // // // //                           </div>
// // // // // // // // // // // //                         </div>
// // // // // // // // // // // //                       </div>
// // // // // // // // // // // //                     ))}
// // // // // // // // // // // //                   </div>
// // // // // // // // // // // //                 ) : (
// // // // // // // // // // // //                   <div style={{
// // // // // // // // // // // //                     textAlign: 'center',
// // // // // // // // // // // //                     padding: '1rem',
// // // // // // // // // // // //                     color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // // // // // // // // // // //                     fontSize: '0.7rem',
// // // // // // // // // // // //                     fontStyle: 'italic',
// // // // // // // // // // // //                     border: `1px dashed ${currentTheme.border}`,
// // // // // // // // // // // //                     borderRadius: '6px',
// // // // // // // // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc'
// // // // // // // // // // // //                   }}>
// // // // // // // // // // // //                     No products saved for this video
// // // // // // // // // // // //                   </div>
// // // // // // // // // // // //                 )}
// // // // // // // // // // // //               </div>

// // // // // // // // // // // //               <label style={{
// // // // // // // // // // // //                 display: 'flex',
// // // // // // // // // // // //                 alignItems: 'center',
// // // // // // // // // // // //                 gap: '0.5rem',
// // // // // // // // // // // //                 cursor: 'pointer',
// // // // // // // // // // // //                 fontSize: '0.75rem',
// // // // // // // // // // // //                 color: currentTheme.text,
// // // // // // // // // // // //                 marginTop: '0.5rem'
// // // // // // // // // // // //               }}>
// // // // // // // // // // // //                 <input 
// // // // // // // // // // // //                   type="checkbox" 
// // // // // // // // // // // //                   style={{
// // // // // // // // // // // //                     cursor: 'pointer'
// // // // // // // // // // // //                   }}
// // // // // // // // // // // //                 />
// // // // // // // // // // // //                 Enable video on product page
// // // // // // // // // // // //               </label>
// // // // // // // // // // // //             </div>
// // // // // // // // // // // //           </div>

// // // // // // // // // // // //           <style jsx>{`
// // // // // // // // // // // //             @keyframes scaleIn {
// // // // // // // // // // // //               from {
// // // // // // // // // // // //                 opacity: 0;
// // // // // // // // // // // //                 transform: scale(0.95) translateY(-10px);
// // // // // // // // // // // //               }
// // // // // // // // // // // //               to {
// // // // // // // // // // // //                 opacity: 1;
// // // // // // // // // // // //                 transform: scale(1) translateY(0);
// // // // // // // // // // // //               }
// // // // // // // // // // // //             }
// // // // // // // // // // // //           `}</style>
// // // // // // // // // // // //         </div>
// // // // // // // // // // // //       </div>

// // // // // // // // // // // //       {/* Products Modal - This will appear on top of VideoOptionsModal */}
// // // // // // // // // // // //       {showProductsModal && (
// // // // // // // // // // // //         <ProductsModal
// // // // // // // // // // // //           showProductsModal={{ show: true, video: showVideoOptions.video }}
// // // // // // // // // // // //           products={products || []}
// // // // // // // // // // // //           selectedProducts={selectedProducts}
// // // // // // // // // // // //           loadingProducts={isLoadingProducts}
// // // // // // // // // // // //           onToggleProduct={onToggleProduct}
// // // // // // // // // // // //           onSaveProducts={handleSaveProducts}
// // // // // // // // // // // //           onHide={handleHideProductsModal}
// // // // // // // // // // // //           isDarkTheme={isDarkTheme}
// // // // // // // // // // // //         />
// // // // // // // // // // // //       )}
// // // // // // // // // // // //     </>
// // // // // // // // // // // //   );
// // // // // // // // // // // // }



// // // // // // // // // // // components/videogallerycomponents/VideoOptionsModal.jsx
// // // // // // // // // // import { useState, useEffect } from "react";
// // // // // // // // // // import ProductsModal from "./ProductsModal";
// // // // // // // // // // import VideoPlayerWithHover from "./VideoPlayerWithHover";

// // // // // // // // // // export default function VideoOptionsModal({
// // // // // // // // // //   showVideoOptions,
// // // // // // // // // //   onHide,
// // // // // // // // // //   onCopyUrl,
// // // // // // // // // //   onDownload,
// // // // // // // // // //   onLoadProducts,
// // // // // // // // // //   onDelete,
// // // // // // // // // //   isDarkTheme,
// // // // // // // // // //   selectedProducts,
// // // // // // // // // //   products,
// // // // // // // // // //   onToggleProduct,
// // // // // // // // // //   onSaveProducts,
// // // // // // // // // //   showVideoPlayerModal // Add this prop to open the large video player
// // // // // // // // // // }) {
// // // // // // // // // //   const [isLoadingProducts, setIsLoadingProducts] = useState(false);
// // // // // // // // // //   const [showProductsModal, setShowProductsModal] = useState(false);
// // // // // // // // // //   const [savedProducts, setSavedProducts] = useState([]);
// // // // // // // // // //   const [isLoadingSavedProducts, setIsLoadingSavedProducts] = useState(false);

// // // // // // // // // //   // Fetch saved products when modal opens or video changes
// // // // // // // // // //   useEffect(() => {
// // // // // // // // // //     if (showVideoOptions.show && showVideoOptions.video?.id) {
// // // // // // // // // //       fetchSavedProducts();
// // // // // // // // // //     }
// // // // // // // // // //   }, [showVideoOptions.show, showVideoOptions.video?.id]);

// // // // // // // // // //   const fetchSavedProducts = async () => {
// // // // // // // // // //     try {
// // // // // // // // // //       setIsLoadingSavedProducts(true);
// // // // // // // // // //       const response = await fetch(`/api/videoproducts?videoId=${showVideoOptions.video.id}`);
// // // // // // // // // //       const result = await response.json();
      
// // // // // // // // // //       if (result.success) {
// // // // // // // // // //         setSavedProducts(result.products);
// // // // // // // // // //       } else {
// // // // // // // // // //         console.error('Failed to fetch saved products:', result.error);
// // // // // // // // // //         setSavedProducts([]);
// // // // // // // // // //       }
// // // // // // // // // //     } catch (error) {
// // // // // // // // // //       console.error('Error fetching saved products:', error);
// // // // // // // // // //       setSavedProducts([]);
// // // // // // // // // //     } finally {
// // // // // // // // // //       setIsLoadingSavedProducts(false);
// // // // // // // // // //     }
// // // // // // // // // //   };

// // // // // // // // // //   const handleBackdropClick = (e) => {
// // // // // // // // // //     if (e.target === e.currentTarget) {
// // // // // // // // // //       onHide();
// // // // // // // // // //     }
// // // // // // // // // //   };

// // // // // // // // // //   const handleOptionClick = (action) => {
// // // // // // // // // //     action();
// // // // // // // // // //     onHide();
// // // // // // // // // //   };

// // // // // // // // // //   // Function to handle video click - open large video player
// // // // // // // // // //   const handleVideoClick = () => {
// // // // // // // // // //     if (showVideoPlayerModal && showVideoOptions.video) {
// // // // // // // // // //       showVideoPlayerModal(showVideoOptions.video);
// // // // // // // // // //     }
// // // // // // // // // //   };

// // // // // // // // // //   // Function to handle Submit Products button click
// // // // // // // // // //   const handleSubmitProducts = async () => {
// // // // // // // // // //     try {
// // // // // // // // // //       setIsLoadingProducts(true);
      
// // // // // // // // // //       // Call the products API
// // // // // // // // // //       const response = await fetch('/api/products');
// // // // // // // // // //       const result = await response.json();
      
// // // // // // // // // //       if (result.success) {
// // // // // // // // // //         setShowProductsModal(true);
// // // // // // // // // //       } else {
// // // // // // // // // //         console.error('Failed to load products:', result.error);
// // // // // // // // // //       }
// // // // // // // // // //     } catch (error) {
// // // // // // // // // //       console.error('Error loading products:', error);
// // // // // // // // // //     } finally {
// // // // // // // // // //       setIsLoadingProducts(false);
// // // // // // // // // //     }
// // // // // // // // // //   };

// // // // // // // // // //   const handleSaveProducts = async () => {
// // // // // // // // // //     if (onSaveProducts) {
// // // // // // // // // //       await onSaveProducts();
// // // // // // // // // //     }
// // // // // // // // // //     setShowProductsModal(false);
// // // // // // // // // //     // Refresh saved products after saving
// // // // // // // // // //     setTimeout(() => {
// // // // // // // // // //       fetchSavedProducts();
// // // // // // // // // //     }, 500);
// // // // // // // // // //   };

// // // // // // // // // //   const handleHideProductsModal = () => {
// // // // // // // // // //     setShowProductsModal(false);
// // // // // // // // // //   };

// // // // // // // // // //   // Get the selected products
// // // // // // // // // //   const displayProducts = selectedProducts || new Set();

// // // // // // // // // //   // Early return should be AFTER all hooks
// // // // // // // // // //   if (!showVideoOptions.show) return null;

// // // // // // // // // //   const themeStyles = {
// // // // // // // // // //     light: {
// // // // // // // // // //       background: '#ffffff',
// // // // // // // // // //       text: '#1f2937',
// // // // // // // // // //       border: '#e5e7eb',
// // // // // // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.15)',
// // // // // // // // // //       hoverBackground: '#f3f4f6',
// // // // // // // // // //       sectionBackground: '#f8fafc'
// // // // // // // // // //     },
// // // // // // // // // //     dark: {
// // // // // // // // // //       background: '#374151',
// // // // // // // // // //       text: '#f9fafb',
// // // // // // // // // //       border: '#4b5563',
// // // // // // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.4)',
// // // // // // // // // //       hoverBackground: '#4b5563',
// // // // // // // // // //       sectionBackground: '#4b5563'
// // // // // // // // // //     }
// // // // // // // // // //   };

// // // // // // // // // //   const currentTheme = isDarkTheme ? themeStyles.dark : themeStyles.light;

// // // // // // // // // //   return (
// // // // // // // // // //     <>
// // // // // // // // // //       <div 
// // // // // // // // // //         style={{
// // // // // // // // // //           position: 'fixed',
// // // // // // // // // //           top: 0,
// // // // // // // // // //           left: 0,
// // // // // // // // // //           right: 0,
// // // // // // // // // //           bottom: 0,
// // // // // // // // // //           zIndex: 10000,
// // // // // // // // // //           background: 'rgba(0, 0, 0, 0.5)',
// // // // // // // // // //           display: 'flex',
// // // // // // // // // //           justifyContent: 'center',
// // // // // // // // // //           alignItems: 'center'
// // // // // // // // // //         }}
// // // // // // // // // //         onClick={handleBackdropClick}
// // // // // // // // // //       >
// // // // // // // // // //         <div 
// // // // // // // // // //           style={{
// // // // // // // // // //             background: currentTheme.background,
// // // // // // // // // //             borderRadius: '12px',
// // // // // // // // // //             border: `1px solid ${currentTheme.border}`,
// // // // // // // // // //             boxShadow: currentTheme.shadow,
// // // // // // // // // //             padding: '1.5rem',
// // // // // // // // // //             maxWidth: '700px',
// // // // // // // // // //             minWidth: '600px',
// // // // // // // // // //             maxHeight: '80vh',
// // // // // // // // // //             zIndex: 10001,
// // // // // // // // // //             animation: 'scaleIn 0.2s ease-out',
// // // // // // // // // //             display: 'flex',
// // // // // // // // // //             flexDirection: 'row',
// // // // // // // // // //             justifyContent: 'space-between',
// // // // // // // // // //             alignItems: 'flex-start',
// // // // // // // // // //             gap: '2rem',
// // // // // // // // // //             overflow: 'hidden'
// // // // // // // // // //           }}
// // // // // // // // // //         >
// // // // // // // // // //           {/* Left Column - Video Player */}
// // // // // // // // // //           <div style={{
// // // // // // // // // //             flex: 1,
// // // // // // // // // //             minWidth: '300px',
// // // // // // // // // //             display: 'flex',
// // // // // // // // // //             flexDirection: 'column',
// // // // // // // // // //             gap: '1.5rem'
// // // // // // // // // //           }}>
// // // // // // // // // //             {/* Video Player Section */}
// // // // // // // // // //             <div>
// // // // // // // // // //               <h3 style={{
// // // // // // // // // //                 fontSize: '0.875rem',
// // // // // // // // // //                 fontWeight: '600',
// // // // // // // // // //                 color: currentTheme.text,
// // // // // // // // // //                 margin: '0 0 1rem 0'
// // // // // // // // // //               }}>
// // // // // // // // // //                 Selected Video
// // // // // // // // // //               </h3>
              
// // // // // // // // // //               {/* Video Player with Hover */}
// // // // // // // // // //               <VideoPlayerWithHover
// // // // // // // // // //                 videoUrl={showVideoOptions.video?.shopify_file_url}
// // // // // // // // // //                 thumbnailUrl={showVideoOptions.video?.thumbnail_url}
// // // // // // // // // //                 title={showVideoOptions.video?.title}
// // // // // // // // // //                 onVideoClick={handleVideoClick}
// // // // // // // // // //                 isDarkTheme={isDarkTheme}
// // // // // // // // // //               />
// // // // // // // // // //             </div>

// // // // // // // // // //             {/* Video Actions Section */}
// // // // // // // // // //             <div style={{
// // // // // // // // // //               display: 'flex',
// // // // // // // // // //               flexDirection: 'column',
// // // // // // // // // //               gap: '0.5rem'
// // // // // // // // // //             }}>
// // // // // // // // // //               <button
// // // // // // // // // //                 onClick={() => handleOptionClick(() => onCopyUrl(showVideoOptions.video.shopify_file_url))}
// // // // // // // // // //                 style={{
// // // // // // // // // //                   width: '100%',
// // // // // // // // // //                   background: 'transparent',
// // // // // // // // // //                   border: `1px solid ${currentTheme.border}`,
// // // // // // // // // //                   color: currentTheme.text,
// // // // // // // // // //                   padding: '0.5rem',
// // // // // // // // // //                   borderRadius: '6px',
// // // // // // // // // //                   fontSize: '0.75rem',
// // // // // // // // // //                   fontWeight: '500',
// // // // // // // // // //                   cursor: 'pointer',
// // // // // // // // // //                   transition: 'all 0.2s',
// // // // // // // // // //                   display: 'flex',
// // // // // // // // // //                   alignItems: 'center',
// // // // // // // // // //                   gap: '0.5rem',
// // // // // // // // // //                   justifyContent: 'center'
// // // // // // // // // //                 }}
// // // // // // // // // //                 onMouseEnter={(e) => {
// // // // // // // // // //                   e.target.style.background = currentTheme.hoverBackground;
// // // // // // // // // //                 }}
// // // // // // // // // //                 onMouseLeave={(e) => {
// // // // // // // // // //                   e.target.style.background = 'transparent';
// // // // // // // // // //                 }}
// // // // // // // // // //               >
// // // // // // // // // //                 üìã Copy Video URL
// // // // // // // // // //               </button>

// // // // // // // // // //               <button
// // // // // // // // // //                 onClick={() => handleOptionClick(() => onDownload(showVideoOptions.video))}
// // // // // // // // // //                 style={{
// // // // // // // // // //                   width: '100%',
// // // // // // // // // //                   background: 'transparent',
// // // // // // // // // //                   border: `1px solid ${currentTheme.border}`,
// // // // // // // // // //                   color: currentTheme.text,
// // // // // // // // // //                   padding: '0.5rem',
// // // // // // // // // //                   borderRadius: '6px',
// // // // // // // // // //                   fontSize: '0.75rem',
// // // // // // // // // //                   fontWeight: '500',
// // // // // // // // // //                   cursor: 'pointer',
// // // // // // // // // //                   transition: 'all 0.2s',
// // // // // // // // // //                   display: 'flex',
// // // // // // // // // //                   alignItems: 'center',
// // // // // // // // // //                   gap: '0.5rem',
// // // // // // // // // //                   justifyContent: 'center'
// // // // // // // // // //                 }}
// // // // // // // // // //                 onMouseEnter={(e) => {
// // // // // // // // // //                   e.target.style.background = currentTheme.hoverBackground;
// // // // // // // // // //                 }}
// // // // // // // // // //                 onMouseLeave={(e) => {
// // // // // // // // // //                   e.target.style.background = 'transparent';
// // // // // // // // // //                 }}
// // // // // // // // // //               >
// // // // // // // // // //                 ‚¨áÔ∏è Download Video
// // // // // // // // // //               </button>

// // // // // // // // // //               <button
// // // // // // // // // //                 onClick={() => handleOptionClick(() => onDelete(showVideoOptions.video.id, showVideoOptions.video.title))}
// // // // // // // // // //                 style={{
// // // // // // // // // //                   width: '100%',
// // // // // // // // // //                   background: 'transparent',
// // // // // // // // // //                   border: `1px solid #ef4444`,
// // // // // // // // // //                   color: '#ef4444',
// // // // // // // // // //                   padding: '0.5rem',
// // // // // // // // // //                   borderRadius: '6px',
// // // // // // // // // //                   fontSize: '0.75rem',
// // // // // // // // // //                   fontWeight: '500',
// // // // // // // // // //                   cursor: 'pointer',
// // // // // // // // // //                   transition: 'all 0.2s',
// // // // // // // // // //                   display: 'flex',
// // // // // // // // // //                   alignItems: 'center',
// // // // // // // // // //                   gap: '0.5rem',
// // // // // // // // // //                   justifyContent: 'center'
// // // // // // // // // //                 }}
// // // // // // // // // //                 onMouseEnter={(e) => {
// // // // // // // // // //                   e.target.style.background = '#ef4444';
// // // // // // // // // //                   e.target.style.color = 'white';
// // // // // // // // // //                 }}
// // // // // // // // // //                 onMouseLeave={(e) => {
// // // // // // // // // //                   e.target.style.background = 'transparent';
// // // // // // // // // //                   e.target.style.color = '#ef4444';
// // // // // // // // // //                 }}
// // // // // // // // // //               >
// // // // // // // // // //                 üóëÔ∏è Delete Video
// // // // // // // // // //               </button>
// // // // // // // // // //             </div>
// // // // // // // // // //           </div>

// // // // // // // // // //           {/* Right Column - Products Section */}
// // // // // // // // // //           <div style={{
// // // // // // // // // //             flex: 1,
// // // // // // // // // //             minWidth: '250px',
// // // // // // // // // //             display: 'flex',
// // // // // // // // // //             flexDirection: 'column',
// // // // // // // // // //             gap: '1.5rem',
// // // // // // // // // //             height: '100%',
// // // // // // // // // //             overflow: 'hidden'
// // // // // // // // // //           }}>
// // // // // // // // // //             {/* Products Section */}
// // // // // // // // // //             <div style={{
// // // // // // // // // //               display: 'flex',
// // // // // // // // // //               flexDirection: 'column',
// // // // // // // // // //               height: '100%',
// // // // // // // // // //               gap: '1rem'
// // // // // // // // // //             }}>
// // // // // // // // // //               <h3 style={{
// // // // // // // // // //                 fontSize: '0.875rem',
// // // // // // // // // //                 fontWeight: '600',
// // // // // // // // // //                 color: currentTheme.text,
// // // // // // // // // //                 margin: 0
// // // // // // // // // //               }}>
// // // // // // // // // //                 Product Management
// // // // // // // // // //               </h3>
              
// // // // // // // // // //               <button
// // // // // // // // // //                 onClick={handleSubmitProducts}
// // // // // // // // // //                 disabled={isLoadingProducts}
// // // // // // // // // //                 style={{
// // // // // // // // // //                   width: '100%',
// // // // // // // // // //                   background: '#10b981',
// // // // // // // // // //                   color: 'white',
// // // // // // // // // //                   border: 'none',
// // // // // // // // // //                   padding: '0.5rem',
// // // // // // // // // //                   borderRadius: '6px',
// // // // // // // // // //                   fontSize: '0.75rem',
// // // // // // // // // //                   fontWeight: '500',
// // // // // // // // // //                   cursor: isLoadingProducts ? 'not-allowed' : 'pointer',
// // // // // // // // // //                   transition: 'background-color 0.2s',
// // // // // // // // // //                   opacity: isLoadingProducts ? 0.6 : 1
// // // // // // // // // //                 }}
// // // // // // // // // //                 onMouseEnter={(e) => {
// // // // // // // // // //                   if (!isLoadingProducts) {
// // // // // // // // // //                     e.target.style.background = '#059669';
// // // // // // // // // //                   }
// // // // // // // // // //                 }}
// // // // // // // // // //                 onMouseLeave={(e) => {
// // // // // // // // // //                   if (!isLoadingProducts) {
// // // // // // // // // //                     e.target.style.background = '#10b981';
// // // // // // // // // //                   }
// // // // // // // // // //                 }}
// // // // // // // // // //               >
// // // // // // // // // //                 {isLoadingProducts ? 'Loading Products...' : 'Submit Products'}
// // // // // // // // // //               </button>

// // // // // // // // // //               {/* Saved Products Section */}
// // // // // // // // // //               <div style={{
// // // // // // // // // //                 flex: 1,
// // // // // // // // // //                 display: 'flex',
// // // // // // // // // //                 flexDirection: 'column',
// // // // // // // // // //                 overflow: 'hidden'
// // // // // // // // // //               }}>
// // // // // // // // // //                 <div style={{
// // // // // // // // // //                   fontSize: '0.75rem',
// // // // // // // // // //                   fontWeight: '600',
// // // // // // // // // //                   color: currentTheme.text,
// // // // // // // // // //                   marginBottom: '0.5rem'
// // // // // // // // // //                 }}>
// // // // // // // // // //                   Saved Products {savedProducts.length > 0 && `(${savedProducts.length})`}
// // // // // // // // // //                 </div>
                
// // // // // // // // // //                 {isLoadingSavedProducts ? (
// // // // // // // // // //                   <div style={{
// // // // // // // // // //                     textAlign: 'center',
// // // // // // // // // //                     padding: '1rem',
// // // // // // // // // //                     color: currentTheme.text,
// // // // // // // // // //                     fontSize: '0.7rem',
// // // // // // // // // //                     border: `1px solid ${currentTheme.border}`,
// // // // // // // // // //                     borderRadius: '6px',
// // // // // // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc'
// // // // // // // // // //                   }}>
// // // // // // // // // //                     Loading saved products...
// // // // // // // // // //                   </div>
// // // // // // // // // //                 ) : savedProducts.length > 0 ? (
// // // // // // // // // //                   <div style={{
// // // // // // // // // //                     flex: 1,
// // // // // // // // // //                     overflowY: 'auto',
// // // // // // // // // //                     border: `1px solid ${currentTheme.border}`,
// // // // // // // // // //                     borderRadius: '6px',
// // // // // // // // // //                     padding: '0.5rem',
// // // // // // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // // // // // // // // //                     maxHeight: '200px'
// // // // // // // // // //                   }}>
// // // // // // // // // //                     {savedProducts.map((product) => (
// // // // // // // // // //                       <div
// // // // // // // // // //                         key={product.video_product_id || product.id}
// // // // // // // // // //                         style={{
// // // // // // // // // //                           display: 'flex',
// // // // // // // // // //                           alignItems: 'center',
// // // // // // // // // //                           gap: '0.5rem',
// // // // // // // // // //                           padding: '0.5rem',
// // // // // // // // // //                           marginBottom: '0.25rem',
// // // // // // // // // //                           background: isDarkTheme ? '#374151' : '#ffffff',
// // // // // // // // // //                           borderRadius: '4px',
// // // // // // // // // //                           fontSize: '0.7rem'
// // // // // // // // // //                         }}
// // // // // // // // // //                       >
// // // // // // // // // //                         {product.image_url ? (
// // // // // // // // // //                           <img 
// // // // // // // // // //                             src={product.image_url} 
// // // // // // // // // //                             alt={product.title}
// // // // // // // // // //                             style={{
// // // // // // // // // //                               width: '20px',
// // // // // // // // // //                               height: '20px',
// // // // // // // // // //                               borderRadius: '3px',
// // // // // // // // // //                               objectFit: 'cover'
// // // // // // // // // //                             }}
// // // // // // // // // //                           />
// // // // // // // // // //                         ) : (
// // // // // // // // // //                           <div style={{
// // // // // // // // // //                             width: '20px',
// // // // // // // // // //                             height: '20px',
// // // // // // // // // //                             background: '#3b82f6',
// // // // // // // // // //                             borderRadius: '3px',
// // // // // // // // // //                             display: 'flex',
// // // // // // // // // //                             alignItems: 'center',
// // // // // // // // // //                             justifyContent: 'center',
// // // // // // // // // //                             color: 'white',
// // // // // // // // // //                             fontSize: '0.6rem',
// // // // // // // // // //                             fontWeight: 'bold'
// // // // // // // // // //                           }}>
// // // // // // // // // //                             P
// // // // // // // // // //                           </div>
// // // // // // // // // //                         )}
// // // // // // // // // //                         <div style={{ flex: 1, minWidth: 0 }}>
// // // // // // // // // //                           <div style={{
// // // // // // // // // //                             color: currentTheme.text,
// // // // // // // // // //                             fontWeight: '500',
// // // // // // // // // //                             whiteSpace: 'nowrap',
// // // // // // // // // //                             overflow: 'hidden',
// // // // // // // // // //                             textOverflow: 'ellipsis'
// // // // // // // // // //                           }}>
// // // // // // // // // //                             {product.title}
// // // // // // // // // //                           </div>
// // // // // // // // // //                           <div style={{
// // // // // // // // // //                             color: '#10b981',
// // // // // // // // // //                             fontSize: '0.65rem'
// // // // // // // // // //                           }}>
// // // // // // // // // //                             ${product.price}
// // // // // // // // // //                           </div>
// // // // // // // // // //                         </div>
// // // // // // // // // //                       </div>
// // // // // // // // // //                     ))}
// // // // // // // // // //                   </div>
// // // // // // // // // //                 ) : (
// // // // // // // // // //                   <div style={{
// // // // // // // // // //                     textAlign: 'center',
// // // // // // // // // //                     padding: '1rem',
// // // // // // // // // //                     color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // // // // // // // // //                     fontSize: '0.7rem',
// // // // // // // // // //                     fontStyle: 'italic',
// // // // // // // // // //                     border: `1px dashed ${currentTheme.border}`,
// // // // // // // // // //                     borderRadius: '6px',
// // // // // // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc'
// // // // // // // // // //                   }}>
// // // // // // // // // //                     No products saved for this video
// // // // // // // // // //                   </div>
// // // // // // // // // //                 )}
// // // // // // // // // //               </div>

// // // // // // // // // //               <label style={{
// // // // // // // // // //                 display: 'flex',
// // // // // // // // // //                 alignItems: 'center',
// // // // // // // // // //                 gap: '0.5rem',
// // // // // // // // // //                 cursor: 'pointer',
// // // // // // // // // //                 fontSize: '0.75rem',
// // // // // // // // // //                 color: currentTheme.text,
// // // // // // // // // //                 marginTop: '0.5rem'
// // // // // // // // // //               }}>
// // // // // // // // // //                 <input 
// // // // // // // // // //                   type="checkbox" 
// // // // // // // // // //                   style={{
// // // // // // // // // //                     cursor: 'pointer'
// // // // // // // // // //                   }}
// // // // // // // // // //                 />
// // // // // // // // // //                 Enable video on product page
// // // // // // // // // //               </label>
// // // // // // // // // //             </div>
// // // // // // // // // //           </div>

// // // // // // // // // //           <style jsx>{`
// // // // // // // // // //             @keyframes scaleIn {
// // // // // // // // // //               from {
// // // // // // // // // //                 opacity: 0;
// // // // // // // // // //                 transform: scale(0.95) translateY(-10px);
// // // // // // // // // //               }
// // // // // // // // // //               to {
// // // // // // // // // //                 opacity: 1;
// // // // // // // // // //                 transform: scale(1) translateY(0);
// // // // // // // // // //               }
// // // // // // // // // //             }
// // // // // // // // // //           `}</style>
// // // // // // // // // //         </div>
// // // // // // // // // //       </div>

// // // // // // // // // //       {/* Products Modal - This will appear on top of VideoOptionsModal */}
// // // // // // // // // //       {showProductsModal && (
// // // // // // // // // //         <ProductsModal
// // // // // // // // // //           showProductsModal={{ show: true, video: showVideoOptions.video }}
// // // // // // // // // //           products={products || []}
// // // // // // // // // //           selectedProducts={selectedProducts}
// // // // // // // // // //           loadingProducts={isLoadingProducts}
// // // // // // // // // //           onToggleProduct={onToggleProduct}
// // // // // // // // // //           onSaveProducts={handleSaveProducts}
// // // // // // // // // //           onHide={handleHideProductsModal}
// // // // // // // // // //           isDarkTheme={isDarkTheme}
// // // // // // // // // //         />
// // // // // // // // // //       )}
// // // // // // // // // //     </>
// // // // // // // // // //   );
// // // // // // // // // // }


// // // // // // // // // // // // components/videogallerycomponents/VideoOptionsModal.jsx
// // // // // // // // // // // import { useState, useEffect } from "react";

// // // // // // // // // // // export default function VideoOptionsModal({
// // // // // // // // // // //   showVideoOptions,
// // // // // // // // // // //   onHide,
// // // // // // // // // // //   onCopyUrl,
// // // // // // // // // // //   onDownload,
// // // // // // // // // // //   onLoadProducts,
// // // // // // // // // // //   onDelete,
// // // // // // // // // // //   isDarkTheme
// // // // // // // // // // // }) {
// // // // // // // // // // //   const [isLoadingProducts, setIsLoadingProducts] = useState(false);
// // // // // // // // // // //   const [showProductsModal, setShowProductsModal] = useState(false);
// // // // // // // // // // //   const [savedProducts, setSavedProducts] = useState([]);

// // // // // // // // // // //   useEffect(() => {
// // // // // // // // // // //     if (showVideoOptions.show && showVideoOptions.video?.id) {
// // // // // // // // // // //       fetchSavedProducts();
// // // // // // // // // // //     }
// // // // // // // // // // //   }, [showVideoOptions.show, showVideoOptions.video?.id]);

// // // // // // // // // // //   const fetchSavedProducts = async () => {
// // // // // // // // // // //     try {
// // // // // // // // // // //       const response = await fetch(`/api/video-products/${showVideoOptions.video.id}`);
// // // // // // // // // // //       const result = await response.json();
      
// // // // // // // // // // //       if (result.success) {
// // // // // // // // // // //         setSavedProducts(result.products || []);
// // // // // // // // // // //       }
// // // // // // // // // // //     } catch (error) {
// // // // // // // // // // //       console.error('Error fetching saved products:', error);
// // // // // // // // // // //       setSavedProducts([]);
// // // // // // // // // // //     }
// // // // // // // // // // //   };

// // // // // // // // // // //   const handleBackdropClick = (e) => {
// // // // // // // // // // //     if (e.target === e.currentTarget) {
// // // // // // // // // // //       onHide();
// // // // // // // // // // //     }
// // // // // // // // // // //   };

// // // // // // // // // // //   const handleLoadProducts = async () => {
// // // // // // // // // // //     setIsLoadingProducts(true);
// // // // // // // // // // //     try {
// // // // // // // // // // //       await onLoadProducts(showVideoOptions.video);
// // // // // // // // // // //       setShowProductsModal(true);
// // // // // // // // // // //     } catch (error) {
// // // // // // // // // // //       console.error('Error loading products:', error);
// // // // // // // // // // //     } finally {
// // // // // // // // // // //       setIsLoadingProducts(false);
// // // // // // // // // // //     }
// // // // // // // // // // //   };

// // // // // // // // // // //   if (!showVideoOptions.show) return null;

// // // // // // // // // // //   const themeStyles = {
// // // // // // // // // // //     light: {
// // // // // // // // // // //       background: '#ffffff',
// // // // // // // // // // //       text: '#1f2937',
// // // // // // // // // // //       border: '#e5e7eb',
// // // // // // // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.15)',
// // // // // // // // // // //       hoverBackground: '#f3f4f6'
// // // // // // // // // // //     },
// // // // // // // // // // //     dark: {
// // // // // // // // // // //       background: '#374151',
// // // // // // // // // // //       text: '#f9fafb',
// // // // // // // // // // //       border: '#4b5563',
// // // // // // // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.4)',
// // // // // // // // // // //       hoverBackground: '#4b5563'
// // // // // // // // // // //     }
// // // // // // // // // // //   };

// // // // // // // // // // //   const currentTheme = isDarkTheme ? themeStyles.dark : themeStyles.light;

// // // // // // // // // // //   return (
// // // // // // // // // // //     <div 
// // // // // // // // // // //       style={{
// // // // // // // // // // //         position: 'fixed',
// // // // // // // // // // //         top: 0,
// // // // // // // // // // //         left: 0,
// // // // // // // // // // //         right: 0,
// // // // // // // // // // //         bottom: 0,
// // // // // // // // // // //         zIndex: 10000,
// // // // // // // // // // //         background: 'rgba(0, 0, 0, 0.5)',
// // // // // // // // // // //         display: 'flex',
// // // // // // // // // // //         justifyContent: 'center',
// // // // // // // // // // //         alignItems: 'center'
// // // // // // // // // // //       }}
// // // // // // // // // // //       onClick={handleBackdropClick}
// // // // // // // // // // //     >
// // // // // // // // // // //       <div 
// // // // // // // // // // //         style={{
// // // // // // // // // // //           background: currentTheme.background,
// // // // // // // // // // //           borderRadius: '12px',
// // // // // // // // // // //           border: `1px solid ${currentTheme.border}`,
// // // // // // // // // // //           boxShadow: currentTheme.shadow,
// // // // // // // // // // //           padding: '1.5rem',
// // // // // // // // // // //           minWidth: '300px',
// // // // // // // // // // //           maxWidth: '400px',
// // // // // // // // // // //           zIndex: 10001,
// // // // // // // // // // //           animation: 'scaleIn 0.2s ease-out'
// // // // // // // // // // //         }}
// // // // // // // // // // //       >
// // // // // // // // // // //         <h3 style={{
// // // // // // // // // // //           fontSize: '1rem',
// // // // // // // // // // //           fontWeight: '600',
// // // // // // // // // // //           color: currentTheme.text,
// // // // // // // // // // //           margin: '0 0 1rem 0'
// // // // // // // // // // //         }}>
// // // // // // // // // // //           Video Options
// // // // // // // // // // //         </h3>
        
// // // // // // // // // // //         <div style={{
// // // // // // // // // // //           display: 'flex',
// // // // // // // // // // //           flexDirection: 'column',
// // // // // // // // // // //           gap: '0.5rem'
// // // // // // // // // // //         }}>
// // // // // // // // // // //           <button
// // // // // // // // // // //             onClick={() => {
// // // // // // // // // // //               onCopyUrl(showVideoOptions.video.shopify_file_url);
// // // // // // // // // // //               onHide();
// // // // // // // // // // //             }}
// // // // // // // // // // //             style={{
// // // // // // // // // // //               width: '100%',
// // // // // // // // // // //               background: 'transparent',
// // // // // // // // // // //               border: `1px solid ${currentTheme.border}`,
// // // // // // // // // // //               color: currentTheme.text,
// // // // // // // // // // //               padding: '0.75rem',
// // // // // // // // // // //               borderRadius: '6px',
// // // // // // // // // // //               fontSize: '0.875rem',
// // // // // // // // // // //               fontWeight: '500',
// // // // // // // // // // //               cursor: 'pointer',
// // // // // // // // // // //               transition: 'all 0.2s',
// // // // // // // // // // //               display: 'flex',
// // // // // // // // // // //               alignItems: 'center',
// // // // // // // // // // //               gap: '0.5rem'
// // // // // // // // // // //             }}
// // // // // // // // // // //           >
// // // // // // // // // // //             üìã Copy Video URL
// // // // // // // // // // //           </button>

// // // // // // // // // // //           <button
// // // // // // // // // // //             onClick={() => {
// // // // // // // // // // //               onDownload(showVideoOptions.video);
// // // // // // // // // // //               onHide();
// // // // // // // // // // //             }}
// // // // // // // // // // //             style={{
// // // // // // // // // // //               width: '100%',
// // // // // // // // // // //               background: 'transparent',
// // // // // // // // // // //               border: `1px solid ${currentTheme.border}`,
// // // // // // // // // // //               color: currentTheme.text,
// // // // // // // // // // //               padding: '0.75rem',
// // // // // // // // // // //               borderRadius: '6px',
// // // // // // // // // // //               fontSize: '0.875rem',
// // // // // // // // // // //               fontWeight: '500',
// // // // // // // // // // //               cursor: 'pointer',
// // // // // // // // // // //               transition: 'all 0.2s',
// // // // // // // // // // //               display: 'flex',
// // // // // // // // // // //               alignItems: 'center',
// // // // // // // // // // //               gap: '0.5rem'
// // // // // // // // // // //             }}
// // // // // // // // // // //           >
// // // // // // // // // // //             ‚¨áÔ∏è Download Video
// // // // // // // // // // //           </button>

// // // // // // // // // // //           <button
// // // // // // // // // // //             onClick={handleLoadProducts}
// // // // // // // // // // //             disabled={isLoadingProducts}
// // // // // // // // // // //             style={{
// // // // // // // // // // //               width: '100%',
// // // // // // // // // // //               background: 'transparent',
// // // // // // // // // // //               border: `1px solid ${currentTheme.border}`,
// // // // // // // // // // //               color: currentTheme.text,
// // // // // // // // // // //               padding: '0.75rem',
// // // // // // // // // // //               borderRadius: '6px',
// // // // // // // // // // //               fontSize: '0.875rem',
// // // // // // // // // // //               fontWeight: '500',
// // // // // // // // // // //               cursor: isLoadingProducts ? 'not-allowed' : 'pointer',
// // // // // // // // // // //               transition: 'all 0.2s',
// // // // // // // // // // //               display: 'flex',
// // // // // // // // // // //               alignItems: 'center',
// // // // // // // // // // //               gap: '0.5rem',
// // // // // // // // // // //               opacity: isLoadingProducts ? 0.6 : 1
// // // // // // // // // // //             }}
// // // // // // // // // // //           >
// // // // // // // // // // //             {isLoadingProducts ? 'Loading...' : 'üè™ Select Products'}
// // // // // // // // // // //           </button>

// // // // // // // // // // //           <button
// // // // // // // // // // //             onClick={() => {
// // // // // // // // // // //               onDelete(showVideoOptions.video.id, showVideoOptions.video.title);
// // // // // // // // // // //               onHide();
// // // // // // // // // // //             }}
// // // // // // // // // // //             style={{
// // // // // // // // // // //               width: '100%',
// // // // // // // // // // //               background: 'transparent',
// // // // // // // // // // //               border: `1px solid #ef4444`,
// // // // // // // // // // //               color: '#ef4444',
// // // // // // // // // // //               padding: '0.75rem',
// // // // // // // // // // //               borderRadius: '6px',
// // // // // // // // // // //               fontSize: '0.875rem',
// // // // // // // // // // //               fontWeight: '500',
// // // // // // // // // // //               cursor: 'pointer',
// // // // // // // // // // //               transition: 'all 0.2s'
// // // // // // // // // // //             }}
// // // // // // // // // // //           >
// // // // // // // // // // //             üóëÔ∏è Delete Video
// // // // // // // // // // //           </button>
// // // // // // // // // // //         </div>

// // // // // // // // // // //         <style jsx>{`
// // // // // // // // // // //           @keyframes scaleIn {
// // // // // // // // // // //             from {
// // // // // // // // // // //               opacity: 0;
// // // // // // // // // // //               transform: scale(0.95) translateY(-10px);
// // // // // // // // // // //             }
// // // // // // // // // // //             to {
// // // // // // // // // // //               opacity: 1;
// // // // // // // // // // //               transform: scale(1) translateY(0);
// // // // // // // // // // //             }
// // // // // // // // // // //           }
// // // // // // // // // // //         `}</style>
// // // // // // // // // // //       </div>
// // // // // // // // // // //     </div>
// // // // // // // // // // //   );
// // // // // // // // // // // }




// // // // // // // // // // components/videogallerycomponents/VideoOptionsModal.jsx
// // // // // // // // // import { useState, useEffect } from "react";
// // // // // // // // // import ProductsModal from "./ProductsModal";
// // // // // // // // // import VideoPlayerWithHover from "./VideoPlayerWithHover";

// // // // // // // // // export default function VideoOptionsModal({
// // // // // // // // //   showVideoOptions,
// // // // // // // // //   onHide,
// // // // // // // // //   onCopyUrl,
// // // // // // // // //   onDownload,
// // // // // // // // //   onLoadProducts,
// // // // // // // // //   onDelete,
// // // // // // // // //   isDarkTheme,
// // // // // // // // //   selectedProducts,
// // // // // // // // //   products,
// // // // // // // // //   onToggleProduct,
// // // // // // // // //   onSaveProducts,
// // // // // // // // //   showVideoPlayerModal
// // // // // // // // // }) {
// // // // // // // // //   const [isLoadingProducts, setIsLoadingProducts] = useState(false);
// // // // // // // // //   const [showProductsModal, setShowProductsModal] = useState({ show: false, video: null }); // FIXED: Changed to object
// // // // // // // // //   const [savedProducts, setSavedProducts] = useState([]);
// // // // // // // // //   const [isLoadingSavedProducts, setIsLoadingSavedProducts] = useState(false);

// // // // // // // // //   // Fetch saved products when modal opens or video changes
// // // // // // // // //   useEffect(() => {
// // // // // // // // //     if (showVideoOptions.show && showVideoOptions.video?.id) {
// // // // // // // // //       fetchSavedProducts();
// // // // // // // // //     }
// // // // // // // // //   }, [showVideoOptions.show, showVideoOptions.video?.id]);

// // // // // // // // //   const fetchSavedProducts = async () => {
// // // // // // // // //     try {
// // // // // // // // //       setIsLoadingSavedProducts(true);
// // // // // // // // //       const response = await fetch(`/api/videoproducts?videoId=${showVideoOptions.video.id}`);
// // // // // // // // //       const result = await response.json();
      
// // // // // // // // //       if (result.success) {
// // // // // // // // //         setSavedProducts(result.products);
// // // // // // // // //       } else {
// // // // // // // // //         console.error('Failed to fetch saved products:', result.error);
// // // // // // // // //         setSavedProducts([]);
// // // // // // // // //       }
// // // // // // // // //     } catch (error) {
// // // // // // // // //       console.error('Error fetching saved products:', error);
// // // // // // // // //       setSavedProducts([]);
// // // // // // // // //     } finally {
// // // // // // // // //       setIsLoadingSavedProducts(false);
// // // // // // // // //     }
// // // // // // // // //   };

// // // // // // // // //   const handleBackdropClick = (e) => {
// // // // // // // // //     if (e.target === e.currentTarget) {
// // // // // // // // //       onHide();
// // // // // // // // //     }
// // // // // // // // //   };

// // // // // // // // //   const handleOptionClick = (action) => {
// // // // // // // // //     action();
// // // // // // // // //     onHide();
// // // // // // // // //   };

// // // // // // // // //   // Function to handle video click - open large video player
// // // // // // // // //   const handleVideoClick = () => {
// // // // // // // // //     if (showVideoPlayerModal && showVideoOptions.video) {
// // // // // // // // //       showVideoPlayerModal(showVideoOptions.video);
// // // // // // // // //     }
// // // // // // // // //   };

// // // // // // // // //   // Function to handle Submit Products button click - FIXED THIS FUNCTION
// // // // // // // // //   const handleSubmitProducts = async () => {
// // // // // // // // //     try {
// // // // // // // // //       setIsLoadingProducts(true);
      
// // // // // // // // //       // Call the products API
// // // // // // // // //       const response = await fetch('/api/products');
// // // // // // // // //       const result = await response.json();
      
// // // // // // // // //       if (result.success) {
// // // // // // // // //         // FIXED: Set showProductsModal as an object with video data
// // // // // // // // //         setShowProductsModal({ 
// // // // // // // // //           show: true, 
// // // // // // // // //           video: showVideoOptions.video 
// // // // // // // // //         });
// // // // // // // // //       } else {
// // // // // // // // //         console.error('Failed to load products:', result.error);
// // // // // // // // //       }
// // // // // // // // //     } catch (error) {
// // // // // // // // //       console.error('Error loading products:', error);
// // // // // // // // //     } finally {
// // // // // // // // //       setIsLoadingProducts(false);
// // // // // // // // //     }
// // // // // // // // //   };

// // // // // // // // //   const handleSaveProducts = async () => {
// // // // // // // // //     if (onSaveProducts) {
// // // // // // // // //       await onSaveProducts();
// // // // // // // // //     }
// // // // // // // // //     // FIXED: Hide products modal properly
// // // // // // // // //     setShowProductsModal({ show: false, video: null });
// // // // // // // // //     // Refresh saved products after saving
// // // // // // // // //     setTimeout(() => {
// // // // // // // // //       fetchSavedProducts();
// // // // // // // // //     }, 500);
// // // // // // // // //   };

// // // // // // // // //   const handleHideProductsModal = () => {
// // // // // // // // //     // FIXED: Hide products modal properly
// // // // // // // // //     setShowProductsModal({ show: false, video: null });
// // // // // // // // //   };

// // // // // // // // //   // Get the selected products
// // // // // // // // //   const displayProducts = selectedProducts || new Set();

// // // // // // // // //   // Early return should be AFTER all hooks
// // // // // // // // //   if (!showVideoOptions.show) return null;

// // // // // // // // //   const themeStyles = {
// // // // // // // // //     light: {
// // // // // // // // //       background: '#ffffff',
// // // // // // // // //       text: '#1f2937',
// // // // // // // // //       border: '#e5e7eb',
// // // // // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.15)',
// // // // // // // // //       hoverBackground: '#f3f4f6',
// // // // // // // // //       sectionBackground: '#f8fafc'
// // // // // // // // //     },
// // // // // // // // //     dark: {
// // // // // // // // //       background: '#374151',
// // // // // // // // //       text: '#f9fafb',
// // // // // // // // //       border: '#4b5563',
// // // // // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.4)',
// // // // // // // // //       hoverBackground: '#4b5563',
// // // // // // // // //       sectionBackground: '#4b5563'
// // // // // // // // //     }
// // // // // // // // //   };

// // // // // // // // //   const currentTheme = isDarkTheme ? themeStyles.dark : themeStyles.light;

// // // // // // // // //   return (
// // // // // // // // //     <>
// // // // // // // // //       <div 
// // // // // // // // //         style={{
// // // // // // // // //           position: 'fixed',
// // // // // // // // //           top: 0,
// // // // // // // // //           left: 0,
// // // // // // // // //           right: 0,
// // // // // // // // //           bottom: 0,
// // // // // // // // //           zIndex: 10000,
// // // // // // // // //           background: 'rgba(0, 0, 0, 0.5)',
// // // // // // // // //           display: 'flex',
// // // // // // // // //           justifyContent: 'center',
// // // // // // // // //           alignItems: 'center'
// // // // // // // // //         }}
// // // // // // // // //         onClick={handleBackdropClick}
// // // // // // // // //       >
// // // // // // // // //         <div 
// // // // // // // // //           style={{
// // // // // // // // //             background: currentTheme.background,
// // // // // // // // //             borderRadius: '12px',
// // // // // // // // //             border: `1px solid ${currentTheme.border}`,
// // // // // // // // //             boxShadow: currentTheme.shadow,
// // // // // // // // //             padding: '1.5rem',
// // // // // // // // //             maxWidth: '700px',
// // // // // // // // //             minWidth: '600px',
// // // // // // // // //             maxHeight: '80vh',
// // // // // // // // //             zIndex: 10001,
// // // // // // // // //             animation: 'scaleIn 0.2s ease-out',
// // // // // // // // //             display: 'flex',
// // // // // // // // //             flexDirection: 'row',
// // // // // // // // //             justifyContent: 'space-between',
// // // // // // // // //             alignItems: 'flex-start',
// // // // // // // // //             gap: '2rem',
// // // // // // // // //             overflow: 'hidden'
// // // // // // // // //           }}
// // // // // // // // //         >
// // // // // // // // //           {/* Left Column - Video Player */}
// // // // // // // // //           <div style={{
// // // // // // // // //             flex: 1,
// // // // // // // // //             minWidth: '300px',
// // // // // // // // //             display: 'flex',
// // // // // // // // //             flexDirection: 'column',
// // // // // // // // //             gap: '1.5rem'
// // // // // // // // //           }}>
// // // // // // // // //             {/* Video Player Section */}
// // // // // // // // //             <div>
// // // // // // // // //               <h3 style={{
// // // // // // // // //                 fontSize: '0.875rem',
// // // // // // // // //                 fontWeight: '600',
// // // // // // // // //                 color: currentTheme.text,
// // // // // // // // //                 margin: '0 0 1rem 0'
// // // // // // // // //               }}>
// // // // // // // // //                 Selected Video
// // // // // // // // //               </h3>
              
// // // // // // // // //               {/* Video Player with Hover */}
// // // // // // // // //               <VideoPlayerWithHover
// // // // // // // // //                 videoUrl={showVideoOptions.video?.shopify_file_url}
// // // // // // // // //                 thumbnailUrl={showVideoOptions.video?.thumbnail_url}
// // // // // // // // //                 title={showVideoOptions.video?.title}
// // // // // // // // //                 onVideoClick={handleVideoClick}
// // // // // // // // //                 isDarkTheme={isDarkTheme}
// // // // // // // // //               />
// // // // // // // // //             </div>

// // // // // // // // //             {/* Video Actions Section */}
// // // // // // // // //             <div style={{
// // // // // // // // //               display: 'flex',
// // // // // // // // //               flexDirection: 'column',
// // // // // // // // //               gap: '0.5rem'
// // // // // // // // //             }}>
// // // // // // // // //               <button
// // // // // // // // //                 onClick={() => handleOptionClick(() => onCopyUrl(showVideoOptions.video.shopify_file_url))}
// // // // // // // // //                 style={{
// // // // // // // // //                   width: '100%',
// // // // // // // // //                   background: 'transparent',
// // // // // // // // //                   border: `1px solid ${currentTheme.border}`,
// // // // // // // // //                   color: currentTheme.text,
// // // // // // // // //                   padding: '0.5rem',
// // // // // // // // //                   borderRadius: '6px',
// // // // // // // // //                   fontSize: '0.75rem',
// // // // // // // // //                   fontWeight: '500',
// // // // // // // // //                   cursor: 'pointer',
// // // // // // // // //                   transition: 'all 0.2s',
// // // // // // // // //                   display: 'flex',
// // // // // // // // //                   alignItems: 'center',
// // // // // // // // //                   gap: '0.5rem',
// // // // // // // // //                   justifyContent: 'center'
// // // // // // // // //                 }}
// // // // // // // // //                 onMouseEnter={(e) => {
// // // // // // // // //                   e.target.style.background = currentTheme.hoverBackground;
// // // // // // // // //                 }}
// // // // // // // // //                 onMouseLeave={(e) => {
// // // // // // // // //                   e.target.style.background = 'transparent';
// // // // // // // // //                 }}
// // // // // // // // //               >
// // // // // // // // //                 üìã Copy Video URL
// // // // // // // // //               </button>

// // // // // // // // //               <button
// // // // // // // // //                 onClick={() => handleOptionClick(() => onDownload(showVideoOptions.video))}
// // // // // // // // //                 style={{
// // // // // // // // //                   width: '100%',
// // // // // // // // //                   background: 'transparent',
// // // // // // // // //                   border: `1px solid ${currentTheme.border}`,
// // // // // // // // //                   color: currentTheme.text,
// // // // // // // // //                   padding: '0.5rem',
// // // // // // // // //                   borderRadius: '6px',
// // // // // // // // //                   fontSize: '0.75rem',
// // // // // // // // //                   fontWeight: '500',
// // // // // // // // //                   cursor: 'pointer',
// // // // // // // // //                   transition: 'all 0.2s',
// // // // // // // // //                   display: 'flex',
// // // // // // // // //                   alignItems: 'center',
// // // // // // // // //                   gap: '0.5rem',
// // // // // // // // //                   justifyContent: 'center'
// // // // // // // // //                 }}
// // // // // // // // //                 onMouseEnter={(e) => {
// // // // // // // // //                   e.target.style.background = currentTheme.hoverBackground;
// // // // // // // // //                 }}
// // // // // // // // //                 onMouseLeave={(e) => {
// // // // // // // // //                   e.target.style.background = 'transparent';
// // // // // // // // //                 }}
// // // // // // // // //               >
// // // // // // // // //                 ‚¨áÔ∏è Download Video
// // // // // // // // //               </button>

// // // // // // // // //               <button
// // // // // // // // //                 onClick={() => handleOptionClick(() => onDelete(showVideoOptions.video.id, showVideoOptions.video.title))}
// // // // // // // // //                 style={{
// // // // // // // // //                   width: '100%',
// // // // // // // // //                   background: 'transparent',
// // // // // // // // //                   border: `1px solid #ef4444`,
// // // // // // // // //                   color: '#ef4444',
// // // // // // // // //                   padding: '0.5rem',
// // // // // // // // //                   borderRadius: '6px',
// // // // // // // // //                   fontSize: '0.75rem',
// // // // // // // // //                   fontWeight: '500',
// // // // // // // // //                   cursor: 'pointer',
// // // // // // // // //                   transition: 'all 0.2s',
// // // // // // // // //                   display: 'flex',
// // // // // // // // //                   alignItems: 'center',
// // // // // // // // //                   gap: '0.5rem',
// // // // // // // // //                   justifyContent: 'center'
// // // // // // // // //                 }}
// // // // // // // // //                 onMouseEnter={(e) => {
// // // // // // // // //                   e.target.style.background = '#ef4444';
// // // // // // // // //                   e.target.style.color = 'white';
// // // // // // // // //                 }}
// // // // // // // // //                 onMouseLeave={(e) => {
// // // // // // // // //                   e.target.style.background = 'transparent';
// // // // // // // // //                   e.target.style.color = '#ef4444';
// // // // // // // // //                 }}
// // // // // // // // //               >
// // // // // // // // //                 üóëÔ∏è Delete Video
// // // // // // // // //               </button>
// // // // // // // // //             </div>
// // // // // // // // //           </div>

// // // // // // // // //           {/* Right Column - Products Section */}
// // // // // // // // //           <div style={{
// // // // // // // // //             flex: 1,
// // // // // // // // //             minWidth: '250px',
// // // // // // // // //             display: 'flex',
// // // // // // // // //             flexDirection: 'column',
// // // // // // // // //             gap: '1.5rem',
// // // // // // // // //             height: '100%',
// // // // // // // // //             overflow: 'hidden'
// // // // // // // // //           }}>
// // // // // // // // //             {/* Products Section */}
// // // // // // // // //             <div style={{
// // // // // // // // //               display: 'flex',
// // // // // // // // //               flexDirection: 'column',
// // // // // // // // //               height: '100%',
// // // // // // // // //               gap: '1rem'
// // // // // // // // //             }}>
// // // // // // // // //               <h3 style={{
// // // // // // // // //                 fontSize: '0.875rem',
// // // // // // // // //                 fontWeight: '600',
// // // // // // // // //                 color: currentTheme.text,
// // // // // // // // //                 margin: 0
// // // // // // // // //               }}>
// // // // // // // // //                 Product Management
// // // // // // // // //               </h3>
              
// // // // // // // // //               <button
// // // // // // // // //                 onClick={handleSubmitProducts}
// // // // // // // // //                 disabled={isLoadingProducts}
// // // // // // // // //                 style={{
// // // // // // // // //                   width: '100%',
// // // // // // // // //                   background: '#10b981',
// // // // // // // // //                   color: 'white',
// // // // // // // // //                   border: 'none',
// // // // // // // // //                   padding: '0.5rem',
// // // // // // // // //                   borderRadius: '6px',
// // // // // // // // //                   fontSize: '0.75rem',
// // // // // // // // //                   fontWeight: '500',
// // // // // // // // //                   cursor: isLoadingProducts ? 'not-allowed' : 'pointer',
// // // // // // // // //                   transition: 'background-color 0.2s',
// // // // // // // // //                   opacity: isLoadingProducts ? 0.6 : 1
// // // // // // // // //                 }}
// // // // // // // // //                 onMouseEnter={(e) => {
// // // // // // // // //                   if (!isLoadingProducts) {
// // // // // // // // //                     e.target.style.background = '#059669';
// // // // // // // // //                   }
// // // // // // // // //                 }}
// // // // // // // // //                 onMouseLeave={(e) => {
// // // // // // // // //                   if (!isLoadingProducts) {
// // // // // // // // //                     e.target.style.background = '#10b981';
// // // // // // // // //                   }
// // // // // // // // //                 }}
// // // // // // // // //               >
// // // // // // // // //                 {isLoadingProducts ? 'Loading Products...' : 'Submit Products'}
// // // // // // // // //               </button>

// // // // // // // // //               {/* Saved Products Section */}
// // // // // // // // //               <div style={{
// // // // // // // // //                 flex: 1,
// // // // // // // // //                 display: 'flex',
// // // // // // // // //                 flexDirection: 'column',
// // // // // // // // //                 overflow: 'hidden'
// // // // // // // // //               }}>
// // // // // // // // //                 <div style={{
// // // // // // // // //                   fontSize: '0.75rem',
// // // // // // // // //                   fontWeight: '600',
// // // // // // // // //                   color: currentTheme.text,
// // // // // // // // //                   marginBottom: '0.5rem'
// // // // // // // // //                 }}>
// // // // // // // // //                   Saved Products {savedProducts.length > 0 && `(${savedProducts.length})`}
// // // // // // // // //                 </div>
                
// // // // // // // // //                 {isLoadingSavedProducts ? (
// // // // // // // // //                   <div style={{
// // // // // // // // //                     textAlign: 'center',
// // // // // // // // //                     padding: '1rem',
// // // // // // // // //                     color: currentTheme.text,
// // // // // // // // //                     fontSize: '0.7rem',
// // // // // // // // //                     border: `1px solid ${currentTheme.border}`,
// // // // // // // // //                     borderRadius: '6px',
// // // // // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc'
// // // // // // // // //                   }}>
// // // // // // // // //                     Loading saved products...
// // // // // // // // //                   </div>
// // // // // // // // //                 ) : savedProducts.length > 0 ? (
// // // // // // // // //                   <div style={{
// // // // // // // // //                     flex: 1,
// // // // // // // // //                     overflowY: 'auto',
// // // // // // // // //                     border: `1px solid ${currentTheme.border}`,
// // // // // // // // //                     borderRadius: '6px',
// // // // // // // // //                     padding: '0.5rem',
// // // // // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // // // // // // // //                     maxHeight: '200px'
// // // // // // // // //                   }}>
// // // // // // // // //                     {savedProducts.map((product) => (
// // // // // // // // //                       <div
// // // // // // // // //                         key={product.video_product_id || product.id}
// // // // // // // // //                         style={{
// // // // // // // // //                           display: 'flex',
// // // // // // // // //                           alignItems: 'center',
// // // // // // // // //                           gap: '0.5rem',
// // // // // // // // //                           padding: '0.5rem',
// // // // // // // // //                           marginBottom: '0.25rem',
// // // // // // // // //                           background: isDarkTheme ? '#374151' : '#ffffff',
// // // // // // // // //                           borderRadius: '4px',
// // // // // // // // //                           fontSize: '0.7rem'
// // // // // // // // //                         }}
// // // // // // // // //                       >
// // // // // // // // //                         {product.image_url ? (
// // // // // // // // //                           <img 
// // // // // // // // //                             src={product.image_url} 
// // // // // // // // //                             alt={product.title}
// // // // // // // // //                             style={{
// // // // // // // // //                               width: '20px',
// // // // // // // // //                               height: '20px',
// // // // // // // // //                               borderRadius: '3px',
// // // // // // // // //                               objectFit: 'cover'
// // // // // // // // //                             }}
// // // // // // // // //                           />
// // // // // // // // //                         ) : (
// // // // // // // // //                           <div style={{
// // // // // // // // //                             width: '20px',
// // // // // // // // //                             height: '20px',
// // // // // // // // //                             background: '#3b82f6',
// // // // // // // // //                             borderRadius: '3px',
// // // // // // // // //                             display: 'flex',
// // // // // // // // //                             alignItems: 'center',
// // // // // // // // //                             justifyContent: 'center',
// // // // // // // // //                             color: 'white',
// // // // // // // // //                             fontSize: '0.6rem',
// // // // // // // // //                             fontWeight: 'bold'
// // // // // // // // //                           }}>
// // // // // // // // //                             P
// // // // // // // // //                           </div>
// // // // // // // // //                         )}
// // // // // // // // //                         <div style={{ flex: 1, minWidth: 0 }}>
// // // // // // // // //                           <div style={{
// // // // // // // // //                             color: currentTheme.text,
// // // // // // // // //                             fontWeight: '500',
// // // // // // // // //                             whiteSpace: 'nowrap',
// // // // // // // // //                             overflow: 'hidden',
// // // // // // // // //                             textOverflow: 'ellipsis'
// // // // // // // // //                           }}>
// // // // // // // // //                             {product.title}
// // // // // // // // //                           </div>
// // // // // // // // //                           <div style={{
// // // // // // // // //                             color: '#10b981',
// // // // // // // // //                             fontSize: '0.65rem'
// // // // // // // // //                           }}>
// // // // // // // // //                             ${product.price}
// // // // // // // // //                           </div>
// // // // // // // // //                         </div>
// // // // // // // // //                       </div>
// // // // // // // // //                     ))}
// // // // // // // // //                   </div>
// // // // // // // // //                 ) : (
// // // // // // // // //                   <div style={{
// // // // // // // // //                     textAlign: 'center',
// // // // // // // // //                     padding: '1rem',
// // // // // // // // //                     color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // // // // // // // //                     fontSize: '0.7rem',
// // // // // // // // //                     fontStyle: 'italic',
// // // // // // // // //                     border: `1px dashed ${currentTheme.border}`,
// // // // // // // // //                     borderRadius: '6px',
// // // // // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc'
// // // // // // // // //                   }}>
// // // // // // // // //                     No products saved for this video
// // // // // // // // //                   </div>
// // // // // // // // //                 )}
// // // // // // // // //               </div>

// // // // // // // // //               <label style={{
// // // // // // // // //                 display: 'flex',
// // // // // // // // //                 alignItems: 'center',
// // // // // // // // //                 gap: '0.5rem',
// // // // // // // // //                 cursor: 'pointer',
// // // // // // // // //                 fontSize: '0.75rem',
// // // // // // // // //                 color: currentTheme.text,
// // // // // // // // //                 marginTop: '0.5rem'
// // // // // // // // //               }}>
// // // // // // // // //                 <input 
// // // // // // // // //                   type="checkbox" 
// // // // // // // // //                   style={{
// // // // // // // // //                     cursor: 'pointer'
// // // // // // // // //                   }}
// // // // // // // // //                 />
// // // // // // // // //                 Enable video on product page
// // // // // // // // //               </label>
// // // // // // // // //             </div>
// // // // // // // // //           </div>

// // // // // // // // //           <style jsx>{`
// // // // // // // // //             @keyframes scaleIn {
// // // // // // // // //               from {
// // // // // // // // //                 opacity: 0;
// // // // // // // // //                 transform: scale(0.95) translateY(-10px);
// // // // // // // // //               }
// // // // // // // // //               to {
// // // // // // // // //                 opacity: 1;
// // // // // // // // //                 transform: scale(1) translateY(0);
// // // // // // // // //               }
// // // // // // // // //             }
// // // // // // // // //           `}</style>
// // // // // // // // //         </div>
// // // // // // // // //       </div>

// // // // // // // // //       {/* Products Modal - This will appear on top of VideoOptionsModal */}
// // // // // // // // //       {/* FIXED: Check showProductsModal.show instead of just showProductsModal */}
// // // // // // // // //       {showProductsModal.show && (
// // // // // // // // //         <ProductsModal
// // // // // // // // //           showProductsModal={showProductsModal}
// // // // // // // // //           products={products || []}
// // // // // // // // //           selectedProducts={selectedProducts}
// // // // // // // // //           loadingProducts={isLoadingProducts}
// // // // // // // // //           onToggleProduct={onToggleProduct}
// // // // // // // // //           onSaveProducts={handleSaveProducts}
// // // // // // // // //           onHide={handleHideProductsModal}
// // // // // // // // //           isDarkTheme={isDarkTheme}
// // // // // // // // //         />
// // // // // // // // //       )}
// // // // // // // // //     </>
// // // // // // // // //   );
// // // // // // // // // }



// // // // // // // // // components/videogallerycomponents/VideoOptionsModal.jsx
// // // // // // // // import { useState, useEffect } from "react";
// // // // // // // // import ProductsModal from "./ProductsModal";
// // // // // // // // import VideoPlayerWithHover from "./VideoPlayerWithHover";

// // // // // // // // export default function VideoOptionsModal({
// // // // // // // //   showVideoOptions,
// // // // // // // //   onHide,
// // // // // // // //   onCopyUrl,
// // // // // // // //   onDownload,
// // // // // // // //   onLoadProducts,
// // // // // // // //   onDelete,
// // // // // // // //   isDarkTheme,
// // // // // // // //   selectedProducts,
// // // // // // // //   products,
// // // // // // // //   onToggleProduct,
// // // // // // // //   onSaveProducts,
// // // // // // // //   showVideoPlayerModal
// // // // // // // // }) {
// // // // // // // //   const [isLoadingProducts, setIsLoadingProducts] = useState(false);
// // // // // // // //   const [showProductsModal, setShowProductsModal] = useState(false);
// // // // // // // //   const [savedProducts, setSavedProducts] = useState([]);
// // // // // // // //   const [isLoadingSavedProducts, setIsLoadingSavedProducts] = useState(false);

// // // // // // // //   // Fetch saved products when modal opens or video changes
// // // // // // // //   useEffect(() => {
// // // // // // // //     if (showVideoOptions.show && showVideoOptions.video?.id) {
// // // // // // // //       fetchSavedProducts();
// // // // // // // //     }
// // // // // // // //   }, [showVideoOptions.show, showVideoOptions.video?.id]);

// // // // // // // //   const fetchSavedProducts = async () => {
// // // // // // // //     try {
// // // // // // // //       setIsLoadingSavedProducts(true);
// // // // // // // //       const response = await fetch(`/api/videoproducts?videoId=${showVideoOptions.video.id}`);
// // // // // // // //       const result = await response.json();
      
// // // // // // // //       if (result.success) {
// // // // // // // //         setSavedProducts(result.products);
// // // // // // // //       } else {
// // // // // // // //         console.error('Failed to fetch saved products:', result.error);
// // // // // // // //         setSavedProducts([]);
// // // // // // // //       }
// // // // // // // //     } catch (error) {
// // // // // // // //       console.error('Error fetching saved products:', error);
// // // // // // // //       setSavedProducts([]);
// // // // // // // //     } finally {
// // // // // // // //       setIsLoadingSavedProducts(false);
// // // // // // // //     }
// // // // // // // //   };

// // // // // // // //   const handleBackdropClick = (e) => {
// // // // // // // //     if (e.target === e.currentTarget) {
// // // // // // // //       onHide();
// // // // // // // //     }
// // // // // // // //   };

// // // // // // // //   const handleOptionClick = (action) => {
// // // // // // // //     action();
// // // // // // // //     onHide();
// // // // // // // //   };

// // // // // // // //   // Function to handle video click - open large video player
// // // // // // // //   const handleVideoClick = () => {
// // // // // // // //     if (showVideoPlayerModal && showVideoOptions.video) {
// // // // // // // //       showVideoPlayerModal(showVideoOptions.video);
// // // // // // // //     }
// // // // // // // //   };

// // // // // // // //   // SIMPLE FIX: Just show the products modal when button is clicked
// // // // // // // //   const handleSubmitProducts = () => {
// // // // // // // //     setShowProductsModal(true);
// // // // // // // //   };

// // // // // // // //   const handleSaveProducts = async () => {
// // // // // // // //     if (onSaveProducts) {
// // // // // // // //       await onSaveProducts();
// // // // // // // //     }
// // // // // // // //     setShowProductsModal(false);
// // // // // // // //     // Refresh saved products after saving
// // // // // // // //     setTimeout(() => {
// // // // // // // //       fetchSavedProducts();
// // // // // // // //     }, 500);
// // // // // // // //   };

// // // // // // // //   const handleHideProductsModal = () => {
// // // // // // // //     setShowProductsModal(false);
// // // // // // // //   };

// // // // // // // //   // Get the selected products
// // // // // // // //   const displayProducts = selectedProducts || new Set();

// // // // // // // //   // Early return should be AFTER all hooks
// // // // // // // //   if (!showVideoOptions.show) return null;

// // // // // // // //   const themeStyles = {
// // // // // // // //     light: {
// // // // // // // //       background: '#ffffff',
// // // // // // // //       text: '#1f2937',
// // // // // // // //       border: '#e5e7eb',
// // // // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.15)',
// // // // // // // //       hoverBackground: '#f3f4f6',
// // // // // // // //       sectionBackground: '#f8fafc'
// // // // // // // //     },
// // // // // // // //     dark: {
// // // // // // // //       background: '#374151',
// // // // // // // //       text: '#f9fafb',
// // // // // // // //       border: '#4b5563',
// // // // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.4)',
// // // // // // // //       hoverBackground: '#4b5563',
// // // // // // // //       sectionBackground: '#4b5563'
// // // // // // // //     }
// // // // // // // //   };

// // // // // // // //   const currentTheme = isDarkTheme ? themeStyles.dark : themeStyles.light;

// // // // // // // //   return (
// // // // // // // //     <>
// // // // // // // //       <div 
// // // // // // // //         style={{
// // // // // // // //           position: 'fixed',
// // // // // // // //           top: 0,
// // // // // // // //           left: 0,
// // // // // // // //           right: 0,
// // // // // // // //           bottom: 0,
// // // // // // // //           zIndex: 10000,
// // // // // // // //           background: 'rgba(0, 0, 0, 0.5)',
// // // // // // // //           display: 'flex',
// // // // // // // //           justifyContent: 'center',
// // // // // // // //           alignItems: 'center'
// // // // // // // //         }}
// // // // // // // //         onClick={handleBackdropClick}
// // // // // // // //       >
// // // // // // // //         <div 
// // // // // // // //           style={{
// // // // // // // //             background: currentTheme.background,
// // // // // // // //             borderRadius: '12px',
// // // // // // // //             border: `1px solid ${currentTheme.border}`,
// // // // // // // //             boxShadow: currentTheme.shadow,
// // // // // // // //             padding: '1.5rem',
// // // // // // // //             maxWidth: '700px',
// // // // // // // //             minWidth: '600px',
// // // // // // // //             maxHeight: '80vh',
// // // // // // // //             zIndex: 10001,
// // // // // // // //             animation: 'scaleIn 0.2s ease-out',
// // // // // // // //             display: 'flex',
// // // // // // // //             flexDirection: 'row',
// // // // // // // //             justifyContent: 'space-between',
// // // // // // // //             alignItems: 'flex-start',
// // // // // // // //             gap: '2rem',
// // // // // // // //             overflow: 'hidden'
// // // // // // // //           }}
// // // // // // // //         >
// // // // // // // //           {/* Left Column - Video Player */}
// // // // // // // //           <div style={{
// // // // // // // //             flex: 1,
// // // // // // // //             minWidth: '300px',
// // // // // // // //             display: 'flex',
// // // // // // // //             flexDirection: 'column',
// // // // // // // //             gap: '1.5rem'
// // // // // // // //           }}>
// // // // // // // //             {/* Video Player Section */}
// // // // // // // //             <div>
// // // // // // // //               <h3 style={{
// // // // // // // //                 fontSize: '0.875rem',
// // // // // // // //                 fontWeight: '600',
// // // // // // // //                 color: currentTheme.text,
// // // // // // // //                 margin: '0 0 1rem 0'
// // // // // // // //               }}>
// // // // // // // //                 Selected Video
// // // // // // // //               </h3>
              
// // // // // // // //               {/* Video Player with Hover */}
// // // // // // // //               <VideoPlayerWithHover
// // // // // // // //                 videoUrl={showVideoOptions.video?.shopify_file_url}
// // // // // // // //                 thumbnailUrl={showVideoOptions.video?.thumbnail_url}
// // // // // // // //                 title={showVideoOptions.video?.title}
// // // // // // // //                 onVideoClick={handleVideoClick}
// // // // // // // //                 isDarkTheme={isDarkTheme}
// // // // // // // //               />
// // // // // // // //             </div>

// // // // // // // //             {/* Video Actions Section */}
// // // // // // // //             <div style={{
// // // // // // // //               display: 'flex',
// // // // // // // //               flexDirection: 'column',
// // // // // // // //               gap: '0.5rem'
// // // // // // // //             }}>
// // // // // // // //               <button
// // // // // // // //                 onClick={() => handleOptionClick(() => onCopyUrl(showVideoOptions.video.shopify_file_url))}
// // // // // // // //                 style={{
// // // // // // // //                   width: '100%',
// // // // // // // //                   background: 'transparent',
// // // // // // // //                   border: `1px solid ${currentTheme.border}`,
// // // // // // // //                   color: currentTheme.text,
// // // // // // // //                   padding: '0.5rem',
// // // // // // // //                   borderRadius: '6px',
// // // // // // // //                   fontSize: '0.75rem',
// // // // // // // //                   fontWeight: '500',
// // // // // // // //                   cursor: 'pointer',
// // // // // // // //                   transition: 'all 0.2s',
// // // // // // // //                   display: 'flex',
// // // // // // // //                   alignItems: 'center',
// // // // // // // //                   gap: '0.5rem',
// // // // // // // //                   justifyContent: 'center'
// // // // // // // //                 }}
// // // // // // // //                 onMouseEnter={(e) => {
// // // // // // // //                   e.target.style.background = currentTheme.hoverBackground;
// // // // // // // //                 }}
// // // // // // // //                 onMouseLeave={(e) => {
// // // // // // // //                   e.target.style.background = 'transparent';
// // // // // // // //                 }}
// // // // // // // //               >
// // // // // // // //                 üìã Copy Video URL
// // // // // // // //               </button>

// // // // // // // //               <button
// // // // // // // //                 onClick={() => handleOptionClick(() => onDownload(showVideoOptions.video))}
// // // // // // // //                 style={{
// // // // // // // //                   width: '100%',
// // // // // // // //                   background: 'transparent',
// // // // // // // //                   border: `1px solid ${currentTheme.border}`,
// // // // // // // //                   color: currentTheme.text,
// // // // // // // //                   padding: '0.5rem',
// // // // // // // //                   borderRadius: '6px',
// // // // // // // //                   fontSize: '0.75rem',
// // // // // // // //                   fontWeight: '500',
// // // // // // // //                   cursor: 'pointer',
// // // // // // // //                   transition: 'all 0.2s',
// // // // // // // //                   display: 'flex',
// // // // // // // //                   alignItems: 'center',
// // // // // // // //                   gap: '0.5rem',
// // // // // // // //                   justifyContent: 'center'
// // // // // // // //                 }}
// // // // // // // //                 onMouseEnter={(e) => {
// // // // // // // //                   e.target.style.background = currentTheme.hoverBackground;
// // // // // // // //                 }}
// // // // // // // //                 onMouseLeave={(e) => {
// // // // // // // //                   e.target.style.background = 'transparent';
// // // // // // // //                 }}
// // // // // // // //               >
// // // // // // // //                 ‚¨áÔ∏è Download Video
// // // // // // // //               </button>

// // // // // // // //               <button
// // // // // // // //                 onClick={() => handleOptionClick(() => onDelete(showVideoOptions.video.id, showVideoOptions.video.title))}
// // // // // // // //                 style={{
// // // // // // // //                   width: '100%',
// // // // // // // //                   background: 'transparent',
// // // // // // // //                   border: `1px solid #ef4444`,
// // // // // // // //                   color: '#ef4444',
// // // // // // // //                   padding: '0.5rem',
// // // // // // // //                   borderRadius: '6px',
// // // // // // // //                   fontSize: '0.75rem',
// // // // // // // //                   fontWeight: '500',
// // // // // // // //                   cursor: 'pointer',
// // // // // // // //                   transition: 'all 0.2s',
// // // // // // // //                   display: 'flex',
// // // // // // // //                   alignItems: 'center',
// // // // // // // //                   gap: '0.5rem',
// // // // // // // //                   justifyContent: 'center'
// // // // // // // //                 }}
// // // // // // // //                 onMouseEnter={(e) => {
// // // // // // // //                   e.target.style.background = '#ef4444';
// // // // // // // //                   e.target.style.color = 'white';
// // // // // // // //                 }}
// // // // // // // //                 onMouseLeave={(e) => {
// // // // // // // //                   e.target.style.background = 'transparent';
// // // // // // // //                   e.target.style.color = '#ef4444';
// // // // // // // //                 }}
// // // // // // // //               >
// // // // // // // //                 üóëÔ∏è Delete Video
// // // // // // // //               </button>
// // // // // // // //             </div>
// // // // // // // //           </div>

// // // // // // // //           {/* Right Column - Products Section */}
// // // // // // // //           <div style={{
// // // // // // // //             flex: 1,
// // // // // // // //             minWidth: '250px',
// // // // // // // //             display: 'flex',
// // // // // // // //             flexDirection: 'column',
// // // // // // // //             gap: '1.5rem',
// // // // // // // //             height: '100%',
// // // // // // // //             overflow: 'hidden'
// // // // // // // //           }}>
// // // // // // // //             {/* Products Section */}
// // // // // // // //             <div style={{
// // // // // // // //               display: 'flex',
// // // // // // // //               flexDirection: 'column',
// // // // // // // //               height: '100%',
// // // // // // // //               gap: '1rem'
// // // // // // // //             }}>
// // // // // // // //               <h3 style={{
// // // // // // // //                 fontSize: '0.875rem',
// // // // // // // //                 fontWeight: '600',
// // // // // // // //                 color: currentTheme.text,
// // // // // // // //                 margin: 0
// // // // // // // //               }}>
// // // // // // // //                 Product Management
// // // // // // // //               </h3>
              
// // // // // // // //               <button
// // // // // // // //                 onClick={handleSubmitProducts} // SIMPLE FIX: Just call the function to show modal
// // // // // // // //                 disabled={isLoadingProducts}
// // // // // // // //                 style={{
// // // // // // // //                   width: '100%',
// // // // // // // //                   background: '#10b981',
// // // // // // // //                   color: 'white',
// // // // // // // //                   border: 'none',
// // // // // // // //                   padding: '0.5rem',
// // // // // // // //                   borderRadius: '6px',
// // // // // // // //                   fontSize: '0.75rem',
// // // // // // // //                   fontWeight: '500',
// // // // // // // //                   cursor: isLoadingProducts ? 'not-allowed' : 'pointer',
// // // // // // // //                   transition: 'background-color 0.2s',
// // // // // // // //                   opacity: isLoadingProducts ? 0.6 : 1
// // // // // // // //                 }}
// // // // // // // //                 onMouseEnter={(e) => {
// // // // // // // //                   if (!isLoadingProducts) {
// // // // // // // //                     e.target.style.background = '#059669';
// // // // // // // //                   }
// // // // // // // //                 }}
// // // // // // // //                 onMouseLeave={(e) => {
// // // // // // // //                   if (!isLoadingProducts) {
// // // // // // // //                     e.target.style.background = '#10b981';
// // // // // // // //                   }
// // // // // // // //                 }}
// // // // // // // //               >
// // // // // // // //                 {isLoadingProducts ? 'Loading Products...' : 'Submit Products'}
// // // // // // // //               </button>

// // // // // // // //               {/* Saved Products Section */}
// // // // // // // //               <div style={{
// // // // // // // //                 flex: 1,
// // // // // // // //                 display: 'flex',
// // // // // // // //                 flexDirection: 'column',
// // // // // // // //                 overflow: 'hidden'
// // // // // // // //               }}>
// // // // // // // //                 <div style={{
// // // // // // // //                   fontSize: '0.75rem',
// // // // // // // //                   fontWeight: '600',
// // // // // // // //                   color: currentTheme.text,
// // // // // // // //                   marginBottom: '0.5rem'
// // // // // // // //                 }}>
// // // // // // // //                   Saved Products {savedProducts.length > 0 && `(${savedProducts.length})`}
// // // // // // // //                 </div>
                
// // // // // // // //                 {isLoadingSavedProducts ? (
// // // // // // // //                   <div style={{
// // // // // // // //                     textAlign: 'center',
// // // // // // // //                     padding: '1rem',
// // // // // // // //                     color: currentTheme.text,
// // // // // // // //                     fontSize: '0.7rem',
// // // // // // // //                     border: `1px solid ${currentTheme.border}`,
// // // // // // // //                     borderRadius: '6px',
// // // // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc'
// // // // // // // //                   }}>
// // // // // // // //                     Loading saved products...
// // // // // // // //                   </div>
// // // // // // // //                 ) : savedProducts.length > 0 ? (
// // // // // // // //                   <div style={{
// // // // // // // //                     flex: 1,
// // // // // // // //                     overflowY: 'auto',
// // // // // // // //                     border: `1px solid ${currentTheme.border}`,
// // // // // // // //                     borderRadius: '6px',
// // // // // // // //                     padding: '0.5rem',
// // // // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // // // // // // //                     maxHeight: '200px'
// // // // // // // //                   }}>
// // // // // // // //                     {savedProducts.map((product) => (
// // // // // // // //                       <div
// // // // // // // //                         key={product.video_product_id || product.id}
// // // // // // // //                         style={{
// // // // // // // //                           display: 'flex',
// // // // // // // //                           alignItems: 'center',
// // // // // // // //                           gap: '0.5rem',
// // // // // // // //                           padding: '0.5rem',
// // // // // // // //                           marginBottom: '0.25rem',
// // // // // // // //                           background: isDarkTheme ? '#374151' : '#ffffff',
// // // // // // // //                           borderRadius: '4px',
// // // // // // // //                           fontSize: '0.7rem'
// // // // // // // //                         }}
// // // // // // // //                       >
// // // // // // // //                         {product.image_url ? (
// // // // // // // //                           <img 
// // // // // // // //                             src={product.image_url} 
// // // // // // // //                             alt={product.title}
// // // // // // // //                             style={{
// // // // // // // //                               width: '20px',
// // // // // // // //                               height: '20px',
// // // // // // // //                               borderRadius: '3px',
// // // // // // // //                               objectFit: 'cover'
// // // // // // // //                             }}
// // // // // // // //                           />
// // // // // // // //                         ) : (
// // // // // // // //                           <div style={{
// // // // // // // //                             width: '20px',
// // // // // // // //                             height: '20px',
// // // // // // // //                             background: '#3b82f6',
// // // // // // // //                             borderRadius: '3px',
// // // // // // // //                             display: 'flex',
// // // // // // // //                             alignItems: 'center',
// // // // // // // //                             justifyContent: 'center',
// // // // // // // //                             color: 'white',
// // // // // // // //                             fontSize: '0.6rem',
// // // // // // // //                             fontWeight: 'bold'
// // // // // // // //                           }}>
// // // // // // // //                             P
// // // // // // // //                           </div>
// // // // // // // //                         )}
// // // // // // // //                         <div style={{ flex: 1, minWidth: 0 }}>
// // // // // // // //                           <div style={{
// // // // // // // //                             color: currentTheme.text,
// // // // // // // //                             fontWeight: '500',
// // // // // // // //                             whiteSpace: 'nowrap',
// // // // // // // //                             overflow: 'hidden',
// // // // // // // //                             textOverflow: 'ellipsis'
// // // // // // // //                           }}>
// // // // // // // //                             {product.title}
// // // // // // // //                           </div>
// // // // // // // //                           <div style={{
// // // // // // // //                             color: '#10b981',
// // // // // // // //                             fontSize: '0.65rem'
// // // // // // // //                           }}>
// // // // // // // //                             ${product.price}
// // // // // // // //                           </div>
// // // // // // // //                         </div>
// // // // // // // //                       </div>
// // // // // // // //                     ))}
// // // // // // // //                   </div>
// // // // // // // //                 ) : (
// // // // // // // //                   <div style={{
// // // // // // // //                     textAlign: 'center',
// // // // // // // //                     padding: '1rem',
// // // // // // // //                     color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // // // // // // //                     fontSize: '0.7rem',
// // // // // // // //                     fontStyle: 'italic',
// // // // // // // //                     border: `1px dashed ${currentTheme.border}`,
// // // // // // // //                     borderRadius: '6px',
// // // // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc'
// // // // // // // //                   }}>
// // // // // // // //                     No products saved for this video
// // // // // // // //                   </div>
// // // // // // // //                 )}
// // // // // // // //               </div>

// // // // // // // //               <label style={{
// // // // // // // //                 display: 'flex',
// // // // // // // //                 alignItems: 'center',
// // // // // // // //                 gap: '0.5rem',
// // // // // // // //                 cursor: 'pointer',
// // // // // // // //                 fontSize: '0.75rem',
// // // // // // // //                 color: currentTheme.text,
// // // // // // // //                 marginTop: '0.5rem'
// // // // // // // //               }}>
// // // // // // // //                 <input 
// // // // // // // //                   type="checkbox" 
// // // // // // // //                   style={{
// // // // // // // //                     cursor: 'pointer'
// // // // // // // //                   }}
// // // // // // // //                 />
// // // // // // // //                 Enable video on product page
// // // // // // // //               </label>
// // // // // // // //             </div>
// // // // // // // //           </div>

// // // // // // // //           <style jsx>{`
// // // // // // // //             @keyframes scaleIn {
// // // // // // // //               from {
// // // // // // // //                 opacity: 0;
// // // // // // // //                 transform: scale(0.95) translateY(-10px);
// // // // // // // //               }
// // // // // // // //               to {
// // // // // // // //                 opacity: 1;
// // // // // // // //                 transform: scale(1) translateY(0);
// // // // // // // //               }
// // // // // // // //             }
// // // // // // // //           `}</style>
// // // // // // // //         </div>
// // // // // // // //       </div>

// // // // // // // //       {/* SIMPLE FIX: Show ProductsModal when showProductsModal is true */}
// // // // // // // //       {showProductsModal && (
// // // // // // // //         <ProductsModal
// // // // // // // //           showProductsModal={{ show: true, video: showVideoOptions.video }}
// // // // // // // //           products={products || []}
// // // // // // // //           selectedProducts={selectedProducts || new Set()}
// // // // // // // //           loadingProducts={isLoadingProducts}
// // // // // // // //           onToggleProduct={onToggleProduct || (() => {})}
// // // // // // // //           onSaveProducts={handleSaveProducts}
// // // // // // // //           onHide={handleHideProductsModal}
// // // // // // // //           isDarkTheme={isDarkTheme}
// // // // // // // //         />
// // // // // // // //       )}
// // // // // // // //     </>
// // // // // // // //   );
// // // // // // // // }



// // // // // // // // components/videogallerycomponents/VideoOptionsModal.jsx
// // // // // // // import { useState, useEffect } from "react";
// // // // // // // import ProductsModal from "./ProductsModal";
// // // // // // // import VideoPlayerWithHover from "./VideoPlayerWithHover";

// // // // // // // export default function VideoOptionsModal({
// // // // // // //   showVideoOptions,
// // // // // // //   onHide,
// // // // // // //   onCopyUrl,
// // // // // // //   onDownload,
// // // // // // //   onLoadProducts,
// // // // // // //   onDelete,
// // // // // // //   isDarkTheme,
// // // // // // //   selectedProducts,
// // // // // // //   products,
// // // // // // //   onToggleProduct,
// // // // // // //   onSaveProducts,
// // // // // // //   showVideoPlayerModal
// // // // // // // }) {
// // // // // // //   const [isLoadingProducts, setIsLoadingProducts] = useState(false);
// // // // // // //   const [showProductsModal, setShowProductsModal] = useState(false);
// // // // // // //   const [savedProducts, setSavedProducts] = useState([]);
// // // // // // //   const [isLoadingSavedProducts, setIsLoadingSavedProducts] = useState(false);

// // // // // // //   // Fetch saved products when modal opens or video changes
// // // // // // //   useEffect(() => {
// // // // // // //     if (showVideoOptions.show && showVideoOptions.video?.id) {
// // // // // // //       fetchSavedProducts();
// // // // // // //     }
// // // // // // //   }, [showVideoOptions.show, showVideoOptions.video?.id]);

// // // // // // //   const fetchSavedProducts = async () => {
// // // // // // //     try {
// // // // // // //       setIsLoadingSavedProducts(true);
// // // // // // //       const response = await fetch(`/api/videoproducts?videoId=${showVideoOptions.video.id}`);
// // // // // // //       const result = await response.json();
      
// // // // // // //       if (result.success) {
// // // // // // //         setSavedProducts(result.products);
// // // // // // //       } else {
// // // // // // //         console.error('Failed to fetch saved products:', result.error);
// // // // // // //         setSavedProducts([]);
// // // // // // //       }
// // // // // // //     } catch (error) {
// // // // // // //       console.error('Error fetching saved products:', error);
// // // // // // //       setSavedProducts([]);
// // // // // // //     } finally {
// // // // // // //       setIsLoadingSavedProducts(false);
// // // // // // //     }
// // // // // // //   };

// // // // // // //   const handleBackdropClick = (e) => {
// // // // // // //     if (e.target === e.currentTarget) {
// // // // // // //       onHide();
// // // // // // //     }
// // // // // // //   };

// // // // // // //   const handleOptionClick = (action) => {
// // // // // // //     action();
// // // // // // //     onHide();
// // // // // // //   };

// // // // // // //   // Function to handle video click - open large video player
// // // // // // //   const handleVideoClick = () => {
// // // // // // //     if (showVideoPlayerModal && showVideoOptions.video) {
// // // // // // //       showVideoPlayerModal(showVideoOptions.video);
// // // // // // //     }
// // // // // // //   };

// // // // // // //   // FIXED: Load products and then show modal
// // // // // // //   const handleSubmitProducts = async () => {
// // // // // // //     try {
// // // // // // //       setIsLoadingProducts(true);
      
// // // // // // //       // Call the products API to load products
// // // // // // //       if (onLoadProducts) {
// // // // // // //         await onLoadProducts(showVideoOptions.video);
// // // // // // //       }
      
// // // // // // //       // Then show the modal
// // // // // // //       setShowProductsModal(true);
// // // // // // //     } catch (error) {
// // // // // // //       console.error('Error loading products:', error);
// // // // // // //     } finally {
// // // // // // //       setIsLoadingProducts(false);
// // // // // // //     }
// // // // // // //   };

// // // // // // //   const handleSaveProducts = async () => {
// // // // // // //     if (onSaveProducts) {
// // // // // // //       await onSaveProducts();
// // // // // // //     }
// // // // // // //     setShowProductsModal(false);
// // // // // // //     // Refresh saved products after saving
// // // // // // //     setTimeout(() => {
// // // // // // //       fetchSavedProducts();
// // // // // // //     }, 500);
// // // // // // //   };

// // // // // // //   const handleHideProductsModal = () => {
// // // // // // //     setShowProductsModal(false);
// // // // // // //   };

// // // // // // //   // Get the selected products
// // // // // // //   const displayProducts = selectedProducts || new Set();

// // // // // // //   // Early return should be AFTER all hooks
// // // // // // //   if (!showVideoOptions.show) return null;

// // // // // // //   const themeStyles = {
// // // // // // //     light: {
// // // // // // //       background: '#ffffff',
// // // // // // //       text: '#1f2937',
// // // // // // //       border: '#e5e7eb',
// // // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.15)',
// // // // // // //       hoverBackground: '#f3f4f6',
// // // // // // //       sectionBackground: '#f8fafc'
// // // // // // //     },
// // // // // // //     dark: {
// // // // // // //       background: '#374151',
// // // // // // //       text: '#f9fafb',
// // // // // // //       border: '#4b5563',
// // // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.4)',
// // // // // // //       hoverBackground: '#4b5563',
// // // // // // //       sectionBackground: '#4b5563'
// // // // // // //     }
// // // // // // //   };

// // // // // // //   const currentTheme = isDarkTheme ? themeStyles.dark : themeStyles.light;

// // // // // // //   return (
// // // // // // //     <>
// // // // // // //       <div 
// // // // // // //         style={{
// // // // // // //           position: 'fixed',
// // // // // // //           top: 0,
// // // // // // //           left: 0,
// // // // // // //           right: 0,
// // // // // // //           bottom: 0,
// // // // // // //           zIndex: 10000,
// // // // // // //           background: 'rgba(0, 0, 0, 0.5)',
// // // // // // //           display: 'flex',
// // // // // // //           justifyContent: 'center',
// // // // // // //           alignItems: 'center'
// // // // // // //         }}
// // // // // // //         onClick={handleBackdropClick}
// // // // // // //       >
// // // // // // //         <div 
// // // // // // //           style={{
// // // // // // //             background: currentTheme.background,
// // // // // // //             borderRadius: '12px',
// // // // // // //             border: `1px solid ${currentTheme.border}`,
// // // // // // //             boxShadow: currentTheme.shadow,
// // // // // // //             padding: '1.5rem',
// // // // // // //             maxWidth: '700px',
// // // // // // //             minWidth: '600px',
// // // // // // //             maxHeight: '80vh',
// // // // // // //             zIndex: 10001,
// // // // // // //             animation: 'scaleIn 0.2s ease-out',
// // // // // // //             display: 'flex',
// // // // // // //             flexDirection: 'row',
// // // // // // //             justifyContent: 'space-between',
// // // // // // //             alignItems: 'flex-start',
// // // // // // //             gap: '2rem',
// // // // // // //             overflow: 'hidden'
// // // // // // //           }}
// // // // // // //         >
// // // // // // //           {/* Left Column - Video Player */}
// // // // // // //           <div style={{
// // // // // // //             flex: 1,
// // // // // // //             minWidth: '300px',
// // // // // // //             display: 'flex',
// // // // // // //             flexDirection: 'column',
// // // // // // //             gap: '1.5rem'
// // // // // // //           }}>
// // // // // // //             {/* Video Player Section */}
// // // // // // //             <div>
// // // // // // //               <h3 style={{
// // // // // // //                 fontSize: '0.875rem',
// // // // // // //                 fontWeight: '600',
// // // // // // //                 color: currentTheme.text,
// // // // // // //                 margin: '0 0 1rem 0'
// // // // // // //               }}>
// // // // // // //                 Selected Video
// // // // // // //               </h3>
              
// // // // // // //               {/* Video Player with Hover */}
// // // // // // //               <VideoPlayerWithHover
// // // // // // //                 videoUrl={showVideoOptions.video?.shopify_file_url}
// // // // // // //                 thumbnailUrl={showVideoOptions.video?.thumbnail_url}
// // // // // // //                 title={showVideoOptions.video?.title}
// // // // // // //                 onVideoClick={handleVideoClick}
// // // // // // //                 isDarkTheme={isDarkTheme}
// // // // // // //               />
// // // // // // //             </div>

// // // // // // //             {/* Video Actions Section */}
// // // // // // //             <div style={{
// // // // // // //               display: 'flex',
// // // // // // //               flexDirection: 'column',
// // // // // // //               gap: '0.5rem'
// // // // // // //             }}>
// // // // // // //               <button
// // // // // // //                 onClick={() => handleOptionClick(() => onCopyUrl(showVideoOptions.video.shopify_file_url))}
// // // // // // //                 style={{
// // // // // // //                   width: '100%',
// // // // // // //                   background: 'transparent',
// // // // // // //                   border: `1px solid ${currentTheme.border}`,
// // // // // // //                   color: currentTheme.text,
// // // // // // //                   padding: '0.5rem',
// // // // // // //                   borderRadius: '6px',
// // // // // // //                   fontSize: '0.75rem',
// // // // // // //                   fontWeight: '500',
// // // // // // //                   cursor: 'pointer',
// // // // // // //                   transition: 'all 0.2s',
// // // // // // //                   display: 'flex',
// // // // // // //                   alignItems: 'center',
// // // // // // //                   gap: '0.5rem',
// // // // // // //                   justifyContent: 'center'
// // // // // // //                 }}
// // // // // // //                 onMouseEnter={(e) => {
// // // // // // //                   e.target.style.background = currentTheme.hoverBackground;
// // // // // // //                 }}
// // // // // // //                 onMouseLeave={(e) => {
// // // // // // //                   e.target.style.background = 'transparent';
// // // // // // //                 }}
// // // // // // //               >
// // // // // // //                 üìã Copy Video URL
// // // // // // //               </button>

// // // // // // //               <button
// // // // // // //                 onClick={() => handleOptionClick(() => onDownload(showVideoOptions.video))}
// // // // // // //                 style={{
// // // // // // //                   width: '100%',
// // // // // // //                   background: 'transparent',
// // // // // // //                   border: `1px solid ${currentTheme.border}`,
// // // // // // //                   color: currentTheme.text,
// // // // // // //                   padding: '0.5rem',
// // // // // // //                   borderRadius: '6px',
// // // // // // //                   fontSize: '0.75rem',
// // // // // // //                   fontWeight: '500',
// // // // // // //                   cursor: 'pointer',
// // // // // // //                   transition: 'all 0.2s',
// // // // // // //                   display: 'flex',
// // // // // // //                   alignItems: 'center',
// // // // // // //                   gap: '0.5rem',
// // // // // // //                   justifyContent: 'center'
// // // // // // //                 }}
// // // // // // //                 onMouseEnter={(e) => {
// // // // // // //                   e.target.style.background = currentTheme.hoverBackground;
// // // // // // //                 }}
// // // // // // //                 onMouseLeave={(e) => {
// // // // // // //                   e.target.style.background = 'transparent';
// // // // // // //                 }}
// // // // // // //               >
// // // // // // //                 ‚¨áÔ∏è Download Video
// // // // // // //               </button>

// // // // // // //               <button
// // // // // // //                 onClick={() => handleOptionClick(() => onDelete(showVideoOptions.video.id, showVideoOptions.video.title))}
// // // // // // //                 style={{
// // // // // // //                   width: '100%',
// // // // // // //                   background: 'transparent',
// // // // // // //                   border: `1px solid #ef4444`,
// // // // // // //                   color: '#ef4444',
// // // // // // //                   padding: '0.5rem',
// // // // // // //                   borderRadius: '6px',
// // // // // // //                   fontSize: '0.75rem',
// // // // // // //                   fontWeight: '500',
// // // // // // //                   cursor: 'pointer',
// // // // // // //                   transition: 'all 0.2s',
// // // // // // //                   display: 'flex',
// // // // // // //                   alignItems: 'center',
// // // // // // //                   gap: '0.5rem',
// // // // // // //                   justifyContent: 'center'
// // // // // // //                 }}
// // // // // // //                 onMouseEnter={(e) => {
// // // // // // //                   e.target.style.background = '#ef4444';
// // // // // // //                   e.target.style.color = 'white';
// // // // // // //                 }}
// // // // // // //                 onMouseLeave={(e) => {
// // // // // // //                   e.target.style.background = 'transparent';
// // // // // // //                   e.target.style.color = '#ef4444';
// // // // // // //                 }}
// // // // // // //               >
// // // // // // //                 üóëÔ∏è Delete Video
// // // // // // //               </button>
// // // // // // //             </div>
// // // // // // //           </div>

// // // // // // //           {/* Right Column - Products Section */}
// // // // // // //           <div style={{
// // // // // // //             flex: 1,
// // // // // // //             minWidth: '250px',
// // // // // // //             display: 'flex',
// // // // // // //             flexDirection: 'column',
// // // // // // //             gap: '1.5rem',
// // // // // // //             height: '100%',
// // // // // // //             overflow: 'hidden'
// // // // // // //           }}>
// // // // // // //             {/* Products Section */}
// // // // // // //             <div style={{
// // // // // // //               display: 'flex',
// // // // // // //               flexDirection: 'column',
// // // // // // //               height: '100%',
// // // // // // //               gap: '1rem'
// // // // // // //             }}>
// // // // // // //               <h3 style={{
// // // // // // //                 fontSize: '0.875rem',
// // // // // // //                 fontWeight: '600',
// // // // // // //                 color: currentTheme.text,
// // // // // // //                 margin: 0
// // // // // // //               }}>
// // // // // // //                 Product Management
// // // // // // //               </h3>
              
// // // // // // //               <button
// // // // // // //                 onClick={handleSubmitProducts} // FIXED: This now loads products first
// // // // // // //                 disabled={isLoadingProducts}
// // // // // // //                 style={{
// // // // // // //                   width: '100%',
// // // // // // //                   background: '#10b981',
// // // // // // //                   color: 'white',
// // // // // // //                   border: 'none',
// // // // // // //                   padding: '0.5rem',
// // // // // // //                   borderRadius: '6px',
// // // // // // //                   fontSize: '0.75rem',
// // // // // // //                   fontWeight: '500',
// // // // // // //                   cursor: isLoadingProducts ? 'not-allowed' : 'pointer',
// // // // // // //                   transition: 'background-color 0.2s',
// // // // // // //                   opacity: isLoadingProducts ? 0.6 : 1
// // // // // // //                 }}
// // // // // // //                 onMouseEnter={(e) => {
// // // // // // //                   if (!isLoadingProducts) {
// // // // // // //                     e.target.style.background = '#059669';
// // // // // // //                   }
// // // // // // //                 }}
// // // // // // //                 onMouseLeave={(e) => {
// // // // // // //                   if (!isLoadingProducts) {
// // // // // // //                     e.target.style.background = '#10b981';
// // // // // // //                   }
// // // // // // //                 }}
// // // // // // //               >
// // // // // // //                 {isLoadingProducts ? 'Loading Products...' : 'Submit Products'}
// // // // // // //               </button>

// // // // // // //               {/* Saved Products Section */}
// // // // // // //               <div style={{
// // // // // // //                 flex: 1,
// // // // // // //                 display: 'flex',
// // // // // // //                 flexDirection: 'column',
// // // // // // //                 overflow: 'hidden'
// // // // // // //               }}>
// // // // // // //                 <div style={{
// // // // // // //                   fontSize: '0.75rem',
// // // // // // //                   fontWeight: '600',
// // // // // // //                   color: currentTheme.text,
// // // // // // //                   marginBottom: '0.5rem'
// // // // // // //                 }}>
// // // // // // //                   Saved Products {savedProducts.length > 0 && `(${savedProducts.length})`}
// // // // // // //                 </div>
                
// // // // // // //                 {isLoadingSavedProducts ? (
// // // // // // //                   <div style={{
// // // // // // //                     textAlign: 'center',
// // // // // // //                     padding: '1rem',
// // // // // // //                     color: currentTheme.text,
// // // // // // //                     fontSize: '0.7rem',
// // // // // // //                     border: `1px solid ${currentTheme.border}`,
// // // // // // //                     borderRadius: '6px',
// // // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc'
// // // // // // //                   }}>
// // // // // // //                     Loading saved products...
// // // // // // //                   </div>
// // // // // // //                 ) : savedProducts.length > 0 ? (
// // // // // // //                   <div style={{
// // // // // // //                     flex: 1,
// // // // // // //                     overflowY: 'auto',
// // // // // // //                     border: `1px solid ${currentTheme.border}`,
// // // // // // //                     borderRadius: '6px',
// // // // // // //                     padding: '0.5rem',
// // // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // // // // // //                     maxHeight: '200px'
// // // // // // //                   }}>
// // // // // // //                     {savedProducts.map((product) => (
// // // // // // //                       <div
// // // // // // //                         key={product.video_product_id || product.id}
// // // // // // //                         style={{
// // // // // // //                           display: 'flex',
// // // // // // //                           alignItems: 'center',
// // // // // // //                           gap: '0.5rem',
// // // // // // //                           padding: '0.5rem',
// // // // // // //                           marginBottom: '0.25rem',
// // // // // // //                           background: isDarkTheme ? '#374151' : '#ffffff',
// // // // // // //                           borderRadius: '4px',
// // // // // // //                           fontSize: '0.7rem'
// // // // // // //                         }}
// // // // // // //                       >
// // // // // // //                         {product.image_url ? (
// // // // // // //                           <img 
// // // // // // //                             src={product.image_url} 
// // // // // // //                             alt={product.title}
// // // // // // //                             style={{
// // // // // // //                               width: '20px',
// // // // // // //                               height: '20px',
// // // // // // //                               borderRadius: '3px',
// // // // // // //                               objectFit: 'cover'
// // // // // // //                             }}
// // // // // // //                           />
// // // // // // //                         ) : (
// // // // // // //                           <div style={{
// // // // // // //                             width: '20px',
// // // // // // //                             height: '20px',
// // // // // // //                             background: '#3b82f6',
// // // // // // //                             borderRadius: '3px',
// // // // // // //                             display: 'flex',
// // // // // // //                             alignItems: 'center',
// // // // // // //                             justifyContent: 'center',
// // // // // // //                             color: 'white',
// // // // // // //                             fontSize: '0.6rem',
// // // // // // //                             fontWeight: 'bold'
// // // // // // //                           }}>
// // // // // // //                             P
// // // // // // //                           </div>
// // // // // // //                         )}
// // // // // // //                         <div style={{ flex: 1, minWidth: 0 }}>
// // // // // // //                           <div style={{
// // // // // // //                             color: currentTheme.text,
// // // // // // //                             fontWeight: '500',
// // // // // // //                             whiteSpace: 'nowrap',
// // // // // // //                             overflow: 'hidden',
// // // // // // //                             textOverflow: 'ellipsis'
// // // // // // //                           }}>
// // // // // // //                             {product.title}
// // // // // // //                           </div>
// // // // // // //                           <div style={{
// // // // // // //                             color: '#10b981',
// // // // // // //                             fontSize: '0.65rem'
// // // // // // //                           }}>
// // // // // // //                             ${product.price}
// // // // // // //                           </div>
// // // // // // //                         </div>
// // // // // // //                       </div>
// // // // // // //                     ))}
// // // // // // //                   </div>
// // // // // // //                 ) : (
// // // // // // //                   <div style={{
// // // // // // //                     textAlign: 'center',
// // // // // // //                     padding: '1rem',
// // // // // // //                     color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // // // // // //                     fontSize: '0.7rem',
// // // // // // //                     fontStyle: 'italic',
// // // // // // //                     border: `1px dashed ${currentTheme.border}`,
// // // // // // //                     borderRadius: '6px',
// // // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc'
// // // // // // //                   }}>
// // // // // // //                     No products saved for this video
// // // // // // //                   </div>
// // // // // // //                 )}
// // // // // // //               </div>

// // // // // // //               <label style={{
// // // // // // //                 display: 'flex',
// // // // // // //                 alignItems: 'center',
// // // // // // //                 gap: '0.5rem',
// // // // // // //                 cursor: 'pointer',
// // // // // // //                 fontSize: '0.75rem',
// // // // // // //                 color: currentTheme.text,
// // // // // // //                 marginTop: '0.5rem'
// // // // // // //               }}>
// // // // // // //                 <input 
// // // // // // //                   type="checkbox" 
// // // // // // //                   style={{
// // // // // // //                     cursor: 'pointer'
// // // // // // //                   }}
// // // // // // //                 />
// // // // // // //                 Enable video on product page
// // // // // // //               </label>
// // // // // // //             </div>
// // // // // // //           </div>

// // // // // // //           <style jsx>{`
// // // // // // //             @keyframes scaleIn {
// // // // // // //               from {
// // // // // // //                 opacity: 0;
// // // // // // //                 transform: scale(0.95) translateY(-10px);
// // // // // // //               }
// // // // // // //               to {
// // // // // // //                 opacity: 1;
// // // // // // //                 transform: scale(1) translateY(0);
// // // // // // //               }
// // // // // // //             }
// // // // // // //           `}</style>
// // // // // // //         </div>
// // // // // // //       </div>

// // // // // // //       {/* FIXED: Pass all the required props to ProductsModal */}
// // // // // // //       {showProductsModal && (
// // // // // // //         <ProductsModal
// // // // // // //           showProductsModal={{ show: true, video: showVideoOptions.video }}
// // // // // // //           products={products || []}
// // // // // // //           selectedProducts={selectedProducts || new Set()}
// // // // // // //           loadingProducts={isLoadingProducts}
// // // // // // //           onToggleProduct={onToggleProduct || (() => {})}
// // // // // // //           onSaveProducts={handleSaveProducts}
// // // // // // //           onHide={handleHideProductsModal}
// // // // // // //           isDarkTheme={isDarkTheme}
// // // // // // //         />
// // // // // // //       )}
// // // // // // //     </>
// // // // // // //   );
// // // // // // // }






// // // // // // // components/videogallerycomponents/VideoOptionsModal.jsx
// // // // // // import { useState, useEffect } from "react";
// // // // // // import ProductsModal from "./ProductsModal";
// // // // // // import VideoPlayerWithHover from "./VideoPlayerWithHover";

// // // // // // export default function VideoOptionsModal({
// // // // // //   showVideoOptions,
// // // // // //   onHide,
// // // // // //   onCopyUrl,
// // // // // //   onDownload,
// // // // // //   onLoadProducts,
// // // // // //   onDelete,
// // // // // //   isDarkTheme,
// // // // // //   selectedProducts,
// // // // // //   products,
// // // // // //   onToggleProduct,
// // // // // //   onSaveProducts,
// // // // // //   showVideoPlayerModal
// // // // // // }) {
// // // // // //   const [isLoadingProducts, setIsLoadingProducts] = useState(false);
// // // // // //   const [showProductsModal, setShowProductsModal] = useState(false);
// // // // // //   const [savedProducts, setSavedProducts] = useState([]);
// // // // // //   const [isLoadingSavedProducts, setIsLoadingSavedProducts] = useState(false);

// // // // // //   // Fetch saved products when modal opens or video changes
// // // // // //   useEffect(() => {
// // // // // //     if (showVideoOptions.show && showVideoOptions.video?.id) {
// // // // // //       fetchSavedProducts();
// // // // // //     }
// // // // // //   }, [showVideoOptions.show, showVideoOptions.video?.id]);

// // // // // //   const fetchSavedProducts = async () => {
// // // // // //     try {
// // // // // //       setIsLoadingSavedProducts(true);
// // // // // //       const response = await fetch(`/api/videoproducts?videoId=${showVideoOptions.video.id}`);
// // // // // //       const result = await response.json();
      
// // // // // //       if (result.success) {
// // // // // //         setSavedProducts(result.products);
// // // // // //       } else {
// // // // // //         console.error('Failed to fetch saved products:', result.error);
// // // // // //         setSavedProducts([]);
// // // // // //       }
// // // // // //     } catch (error) {
// // // // // //       console.error('Error fetching saved products:', error);
// // // // // //       setSavedProducts([]);
// // // // // //     } finally {
// // // // // //       setIsLoadingSavedProducts(false);
// // // // // //     }
// // // // // //   };

// // // // // //   const handleBackdropClick = (e) => {
// // // // // //     if (e.target === e.currentTarget) {
// // // // // //       onHide();
// // // // // //     }
// // // // // //   };

// // // // // //   const handleOptionClick = (action) => {
// // // // // //     action();
// // // // // //     onHide();
// // // // // //   };

// // // // // //   // Function to handle video click - open large video player
// // // // // //   const handleVideoClick = () => {
// // // // // //     if (showVideoPlayerModal && showVideoOptions.video) {
// // // // // //       showVideoPlayerModal(showVideoOptions.video);
// // // // // //       onHide(); // Close the options modal when opening full video
// // // // // //     }
// // // // // //   };

// // // // // //   // FIXED: Load products and then show modal
// // // // // //   const handleSubmitProducts = async () => {
// // // // // //     try {
// // // // // //       setIsLoadingProducts(true);
      
// // // // // //       // Call the products API to load products
// // // // // //       if (onLoadProducts) {
// // // // // //         await onLoadProducts(showVideoOptions.video);
// // // // // //       }
      
// // // // // //       // Then show the modal
// // // // // //       setShowProductsModal(true);
// // // // // //     } catch (error) {
// // // // // //       console.error('Error loading products:', error);
// // // // // //     } finally {
// // // // // //       setIsLoadingProducts(false);
// // // // // //     }
// // // // // //   };

// // // // // //   const handleSaveProducts = async () => {
// // // // // //     if (onSaveProducts) {
// // // // // //       await onSaveProducts();
// // // // // //     }
// // // // // //     setShowProductsModal(false);
// // // // // //     // Refresh saved products after saving
// // // // // //     setTimeout(() => {
// // // // // //       fetchSavedProducts();
// // // // // //     }, 500);
// // // // // //   };

// // // // // //   const handleHideProductsModal = () => {
// // // // // //     setShowProductsModal(false);
// // // // // //   };

// // // // // //   // Get the selected products
// // // // // //   const displayProducts = selectedProducts || new Set();

// // // // // //   // Early return should be AFTER all hooks
// // // // // //   if (!showVideoOptions.show) return null;

// // // // // //   const themeStyles = {
// // // // // //     light: {
// // // // // //       background: '#ffffff',
// // // // // //       text: '#1f2937',
// // // // // //       border: '#e5e7eb',
// // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.15)',
// // // // // //       hoverBackground: '#f3f4f6',
// // // // // //       sectionBackground: '#f8fafc'
// // // // // //     },
// // // // // //     dark: {
// // // // // //       background: '#374151',
// // // // // //       text: '#f9fafb',
// // // // // //       border: '#4b5563',
// // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.4)',
// // // // // //       hoverBackground: '#4b5563',
// // // // // //       sectionBackground: '#4b5563'
// // // // // //     }
// // // // // //   };

// // // // // //   const currentTheme = isDarkTheme ? themeStyles.dark : themeStyles.light;

// // // // // //   return (
// // // // // //     <>
// // // // // //       <div 
// // // // // //         style={{
// // // // // //           position: 'fixed',
// // // // // //           top: 0,
// // // // // //           left: 0,
// // // // // //           right: 0,
// // // // // //           bottom: 0,
// // // // // //           zIndex: 10000,
// // // // // //           background: 'rgba(0, 0, 0, 0.5)',
// // // // // //           display: 'flex',
// // // // // //           justifyContent: 'center',
// // // // // //           alignItems: 'center'
// // // // // //         }}
// // // // // //         onClick={handleBackdropClick}
// // // // // //       >
// // // // // //         <div 
// // // // // //           style={{
// // // // // //             background: currentTheme.background,
// // // // // //             borderRadius: '12px',
// // // // // //             border: `1px solid ${currentTheme.border}`,
// // // // // //             boxShadow: currentTheme.shadow,
// // // // // //             padding: '1.5rem',
// // // // // //             maxWidth: '700px',
// // // // // //             minWidth: '600px',
// // // // // //             maxHeight: '80vh',
// // // // // //             zIndex: 10001,
// // // // // //             animation: 'scaleIn 0.2s ease-out',
// // // // // //             display: 'flex',
// // // // // //             flexDirection: 'row',
// // // // // //             justifyContent: 'space-between',
// // // // // //             alignItems: 'flex-start',
// // // // // //             gap: '2rem',
// // // // // //             overflow: 'hidden',
// // // // // //             position: 'relative' // Added for close button positioning
// // // // // //           }}
// // // // // //         >
// // // // // //           {/* Close Button */}
// // // // // //           <button
// // // // // //             onClick={onHide}
// // // // // //             style={{
// // // // // //               position: 'absolute',
// // // // // //               top: '1rem',
// // // // // //               right: '1rem',
// // // // // //               background: isDarkTheme ? '#374151' : 'white',
// // // // // //               border: `1px solid ${isDarkTheme ? '#4b5563' : '#e5e7eb'}`,
// // // // // //               borderRadius: '50%',
// // // // // //               width: '32px',
// // // // // //               height: '32px',
// // // // // //               display: 'flex',
// // // // // //               alignItems: 'center',
// // // // // //               justifyContent: 'center',
// // // // // //               cursor: 'pointer',
// // // // // //               color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // // // // //               fontSize: '1rem',
// // // // // //               fontWeight: 'bold',
// // // // // //               zIndex: 10002,
// // // // // //               transition: 'all 0.3s ease'
// // // // // //             }}
// // // // // //             onMouseEnter={(e) => {
// // // // // //               e.target.style.background = isDarkTheme ? '#4b5563' : '#f3f4f6';
// // // // // //               e.target.style.color = isDarkTheme ? '#f9fafb' : '#1f2937';
// // // // // //             }}
// // // // // //             onMouseLeave={(e) => {
// // // // // //               e.target.style.background = isDarkTheme ? '#374151' : 'white';
// // // // // //               e.target.style.color = isDarkTheme ? '#9ca3af' : '#6b7280';
// // // // // //             }}
// // // // // //           >
// // // // // //             ‚úï
// // // // // //           </button>

// // // // // //           {/* Left Column - Video Player */}
// // // // // //           <div style={{
// // // // // //             flex: 1,
// // // // // //             minWidth: '300px',
// // // // // //             display: 'flex',
// // // // // //             flexDirection: 'column',
// // // // // //             gap: '1.5rem'
// // // // // //           }}>
// // // // // //             {/* Video Player Section */}
// // // // // //             <div>
// // // // // //               <h3 style={{
// // // // // //                 fontSize: '0.875rem',
// // // // // //                 fontWeight: '600',
// // // // // //                 color: currentTheme.text,
// // // // // //                 margin: '0 0 1rem 0'
// // // // // //               }}>
// // // // // //                 Selected Video
// // // // // //               </h3>
              
// // // // // //               {/* Video Player with Hover - Shows the clicked video */}
// // // // // //               <VideoPlayerWithHover
// // // // // //                 videoUrl={showVideoOptions.video?.shopify_file_url}
// // // // // //                 thumbnailUrl={showVideoOptions.video?.thumbnail_url}
// // // // // //                 title={showVideoOptions.video?.title}
// // // // // //                 onVideoClick={handleVideoClick} // Opens full video player on click
// // // // // //                 isDarkTheme={isDarkTheme}
// // // // // //                 height="250px" // Slightly larger for better preview
// // // // // //               />
              
// // // // // //               {/* Video Info */}
// // // // // //               <div style={{
// // // // // //                 marginTop: '1rem',
// // // // // //                 padding: '0.75rem',
// // // // // //                 background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // // // // //                 borderRadius: '8px',
// // // // // //                 border: `1px solid ${isDarkTheme ? '#374151' : '#e5e7eb'}`
// // // // // //               }}>
// // // // // //                 <h4 style={{
// // // // // //                   fontSize: '0.875rem',
// // // // // //                   fontWeight: '600',
// // // // // //                   color: currentTheme.text,
// // // // // //                   margin: '0 0 0.25rem 0'
// // // // // //                 }}>
// // // // // //                   {showVideoOptions.video?.title || 'Untitled Video'}
// // // // // //                 </h4>
// // // // // //                 <p style={{
// // // // // //                   fontSize: '0.75rem',
// // // // // //                   color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // // // // //                   margin: 0
// // // // // //                 }}>
// // // // // //                   Click the video to open in full screen player
// // // // // //                 </p>
// // // // // //               </div>
// // // // // //             </div>

// // // // // //             {/* Video Actions Section */}
// // // // // //             <div style={{
// // // // // //               display: 'flex',
// // // // // //               flexDirection: 'column',
// // // // // //               gap: '0.5rem'
// // // // // //             }}>
// // // // // //               <button
// // // // // //                 onClick={() => handleOptionClick(() => onCopyUrl(showVideoOptions.video.shopify_file_url))}
// // // // // //                 style={{
// // // // // //                   width: '100%',
// // // // // //                   background: 'transparent',
// // // // // //                   border: `1px solid ${currentTheme.border}`,
// // // // // //                   color: currentTheme.text,
// // // // // //                   padding: '0.5rem',
// // // // // //                   borderRadius: '6px',
// // // // // //                   fontSize: '0.75rem',
// // // // // //                   fontWeight: '500',
// // // // // //                   cursor: 'pointer',
// // // // // //                   transition: 'all 0.2s',
// // // // // //                   display: 'flex',
// // // // // //                   alignItems: 'center',
// // // // // //                   gap: '0.5rem',
// // // // // //                   justifyContent: 'center'
// // // // // //                 }}
// // // // // //                 onMouseEnter={(e) => {
// // // // // //                   e.target.style.background = currentTheme.hoverBackground;
// // // // // //                 }}
// // // // // //                 onMouseLeave={(e) => {
// // // // // //                   e.target.style.background = 'transparent';
// // // // // //                 }}
// // // // // //               >
// // // // // //                 üìã Copy Video URL
// // // // // //               </button>

// // // // // //               <button
// // // // // //                 onClick={() => handleOptionClick(() => onDownload(showVideoOptions.video))}
// // // // // //                 style={{
// // // // // //                   width: '100%',
// // // // // //                   background: 'transparent',
// // // // // //                   border: `1px solid ${currentTheme.border}`,
// // // // // //                   color: currentTheme.text,
// // // // // //                   padding: '0.5rem',
// // // // // //                   borderRadius: '6px',
// // // // // //                   fontSize: '0.75rem',
// // // // // //                   fontWeight: '500',
// // // // // //                   cursor: 'pointer',
// // // // // //                   transition: 'all 0.2s',
// // // // // //                   display: 'flex',
// // // // // //                   alignItems: 'center',
// // // // // //                   gap: '0.5rem',
// // // // // //                   justifyContent: 'center'
// // // // // //                 }}
// // // // // //                 onMouseEnter={(e) => {
// // // // // //                   e.target.style.background = currentTheme.hoverBackground;
// // // // // //                 }}
// // // // // //                 onMouseLeave={(e) => {
// // // // // //                   e.target.style.background = 'transparent';
// // // // // //                 }}
// // // // // //               >
// // // // // //                 ‚¨áÔ∏è Download Video
// // // // // //               </button>

// // // // // //               <button
// // // // // //                 onClick={() => handleOptionClick(() => onDelete(showVideoOptions.video.id, showVideoOptions.video.title))}
// // // // // //                 style={{
// // // // // //                   width: '100%',
// // // // // //                   background: 'transparent',
// // // // // //                   border: `1px solid #ef4444`,
// // // // // //                   color: '#ef4444',
// // // // // //                   padding: '0.5rem',
// // // // // //                   borderRadius: '6px',
// // // // // //                   fontSize: '0.75rem',
// // // // // //                   fontWeight: '500',
// // // // // //                   cursor: 'pointer',
// // // // // //                   transition: 'all 0.2s',
// // // // // //                   display: 'flex',
// // // // // //                   alignItems: 'center',
// // // // // //                   gap: '0.5rem',
// // // // // //                   justifyContent: 'center'
// // // // // //                 }}
// // // // // //                 onMouseEnter={(e) => {
// // // // // //                   e.target.style.background = '#ef4444';
// // // // // //                   e.target.style.color = 'white';
// // // // // //                 }}
// // // // // //                 onMouseLeave={(e) => {
// // // // // //                   e.target.style.background = 'transparent';
// // // // // //                   e.target.style.color = '#ef4444';
// // // // // //                 }}
// // // // // //               >
// // // // // //                 üóëÔ∏è Delete Video
// // // // // //               </button>
// // // // // //             </div>
// // // // // //           </div>

// // // // // //           {/* Right Column - Products Section */}
// // // // // //           <div style={{
// // // // // //             flex: 1,
// // // // // //             minWidth: '250px',
// // // // // //             display: 'flex',
// // // // // //             flexDirection: 'column',
// // // // // //             gap: '1.5rem',
// // // // // //             height: '100%',
// // // // // //             overflow: 'hidden'
// // // // // //           }}>
// // // // // //             {/* Products Section */}
// // // // // //             <div style={{
// // // // // //               display: 'flex',
// // // // // //               flexDirection: 'column',
// // // // // //               height: '100%',
// // // // // //               gap: '1rem'
// // // // // //             }}>
// // // // // //               <h3 style={{
// // // // // //                 fontSize: '0.875rem',
// // // // // //                 fontWeight: '600',
// // // // // //                 color: currentTheme.text,
// // // // // //                 margin: 0
// // // // // //               }}>
// // // // // //                 Product Management
// // // // // //               </h3>
              
// // // // // //               <button
// // // // // //                 onClick={handleSubmitProducts} // FIXED: This now loads products first
// // // // // //                 disabled={isLoadingProducts}
// // // // // //                 style={{
// // // // // //                   width: '100%',
// // // // // //                   background: '#10b981',
// // // // // //                   color: 'white',
// // // // // //                   border: 'none',
// // // // // //                   padding: '0.5rem',
// // // // // //                   borderRadius: '6px',
// // // // // //                   fontSize: '0.75rem',
// // // // // //                   fontWeight: '500',
// // // // // //                   cursor: isLoadingProducts ? 'not-allowed' : 'pointer',
// // // // // //                   transition: 'background-color 0.2s',
// // // // // //                   opacity: isLoadingProducts ? 0.6 : 1
// // // // // //                 }}
// // // // // //                 onMouseEnter={(e) => {
// // // // // //                   if (!isLoadingProducts) {
// // // // // //                     e.target.style.background = '#059669';
// // // // // //                   }
// // // // // //                 }}
// // // // // //                 onMouseLeave={(e) => {
// // // // // //                   if (!isLoadingProducts) {
// // // // // //                     e.target.style.background = '#10b981';
// // // // // //                   }
// // // // // //                 }}
// // // // // //               >
// // // // // //                 {isLoadingProducts ? 'Loading Products...' : 'Submit Products'}
// // // // // //               </button>

// // // // // //               {/* Saved Products Section */}
// // // // // //               <div style={{
// // // // // //                 flex: 1,
// // // // // //                 display: 'flex',
// // // // // //                 flexDirection: 'column',
// // // // // //                 overflow: 'hidden'
// // // // // //               }}>
// // // // // //                 <div style={{
// // // // // //                   fontSize: '0.75rem',
// // // // // //                   fontWeight: '600',
// // // // // //                   color: currentTheme.text,
// // // // // //                   marginBottom: '0.5rem'
// // // // // //                 }}>
// // // // // //                   Saved Products {savedProducts.length > 0 && `(${savedProducts.length})`}
// // // // // //                 </div>
                
// // // // // //                 {isLoadingSavedProducts ? (
// // // // // //                   <div style={{
// // // // // //                     textAlign: 'center',
// // // // // //                     padding: '1rem',
// // // // // //                     color: currentTheme.text,
// // // // // //                     fontSize: '0.7rem',
// // // // // //                     border: `1px solid ${currentTheme.border}`,
// // // // // //                     borderRadius: '6px',
// // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc'
// // // // // //                   }}>
// // // // // //                     Loading saved products...
// // // // // //                   </div>
// // // // // //                 ) : savedProducts.length > 0 ? (
// // // // // //                   <div style={{
// // // // // //                     flex: 1,
// // // // // //                     overflowY: 'auto',
// // // // // //                     border: `1px solid ${currentTheme.border}`,
// // // // // //                     borderRadius: '6px',
// // // // // //                     padding: '0.5rem',
// // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // // // // //                     maxHeight: '200px'
// // // // // //                   }}>
// // // // // //                     {savedProducts.map((product) => (
// // // // // //                       <div
// // // // // //                         key={product.video_product_id || product.id}
// // // // // //                         style={{
// // // // // //                           display: 'flex',
// // // // // //                           alignItems: 'center',
// // // // // //                           gap: '0.5rem',
// // // // // //                           padding: '0.5rem',
// // // // // //                           marginBottom: '0.25rem',
// // // // // //                           background: isDarkTheme ? '#374151' : '#ffffff',
// // // // // //                           borderRadius: '4px',
// // // // // //                           fontSize: '0.7rem'
// // // // // //                         }}
// // // // // //                       >
// // // // // //                         {product.image_url ? (
// // // // // //                           <img 
// // // // // //                             src={product.image_url} 
// // // // // //                             alt={product.title}
// // // // // //                             style={{
// // // // // //                               width: '20px',
// // // // // //                               height: '20px',
// // // // // //                               borderRadius: '3px',
// // // // // //                               objectFit: 'cover'
// // // // // //                             }}
// // // // // //                           />
// // // // // //                         ) : (
// // // // // //                           <div style={{
// // // // // //                             width: '20px',
// // // // // //                             height: '20px',
// // // // // //                             background: '#3b82f6',
// // // // // //                             borderRadius: '3px',
// // // // // //                             display: 'flex',
// // // // // //                             alignItems: 'center',
// // // // // //                             justifyContent: 'center',
// // // // // //                             color: 'white',
// // // // // //                             fontSize: '0.6rem',
// // // // // //                             fontWeight: 'bold'
// // // // // //                           }}>
// // // // // //                             P
// // // // // //                           </div>
// // // // // //                         )}
// // // // // //                         <div style={{ flex: 1, minWidth: 0 }}>
// // // // // //                           <div style={{
// // // // // //                             color: currentTheme.text,
// // // // // //                             fontWeight: '500',
// // // // // //                             whiteSpace: 'nowrap',
// // // // // //                             overflow: 'hidden',
// // // // // //                             textOverflow: 'ellipsis'
// // // // // //                           }}>
// // // // // //                             {product.title}
// // // // // //                           </div>
// // // // // //                           <div style={{
// // // // // //                             color: '#10b981',
// // // // // //                             fontSize: '0.65rem'
// // // // // //                           }}>
// // // // // //                             ${product.price}
// // // // // //                           </div>
// // // // // //                         </div>
// // // // // //                       </div>
// // // // // //                     ))}
// // // // // //                   </div>
// // // // // //                 ) : (
// // // // // //                   <div style={{
// // // // // //                     textAlign: 'center',
// // // // // //                     padding: '1rem',
// // // // // //                     color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // // // // //                     fontSize: '0.7rem',
// // // // // //                     fontStyle: 'italic',
// // // // // //                     border: `1px dashed ${currentTheme.border}`,
// // // // // //                     borderRadius: '6px',
// // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc'
// // // // // //                   }}>
// // // // // //                     No products saved for this video
// // // // // //                   </div>
// // // // // //                 )}
// // // // // //               </div>

// // // // // //               <label style={{
// // // // // //                 display: 'flex',
// // // // // //                 alignItems: 'center',
// // // // // //                 gap: '0.5rem',
// // // // // //                 cursor: 'pointer',
// // // // // //                 fontSize: '0.75rem',
// // // // // //                 color: currentTheme.text,
// // // // // //                 marginTop: '0.5rem'
// // // // // //               }}>
// // // // // //                 <input 
// // // // // //                   type="checkbox" 
// // // // // //                   style={{
// // // // // //                     cursor: 'pointer'
// // // // // //                   }}
// // // // // //                 />
// // // // // //                 Enable video on product page
// // // // // //               </label>
// // // // // //             </div>
// // // // // //           </div>

// // // // // //           <style jsx>{`
// // // // // //             @keyframes scaleIn {
// // // // // //               from {
// // // // // //                 opacity: 0;
// // // // // //                 transform: scale(0.95) translateY(-10px);
// // // // // //               }
// // // // // //               to {
// // // // // //                 opacity: 1;
// // // // // //                 transform: scale(1) translateY(0);
// // // // // //               }
// // // // // //             }
// // // // // //           `}</style>
// // // // // //         </div>
// // // // // //       </div>

// // // // // //       {/* FIXED: Pass all the required props to ProductsModal */}
// // // // // //       {showProductsModal && (
// // // // // //         <ProductsModal
// // // // // //           showProductsModal={{ show: true, video: showVideoOptions.video }}
// // // // // //           products={products || []}
// // // // // //           selectedProducts={selectedProducts || new Set()}
// // // // // //           loadingProducts={isLoadingProducts}
// // // // // //           onToggleProduct={onToggleProduct || (() => {})}
// // // // // //           onSaveProducts={handleSaveProducts}
// // // // // //           onHide={handleHideProductsModal}
// // // // // //           isDarkTheme={isDarkTheme}
// // // // // //         />
// // // // // //       )}
// // // // // //     </>
// // // // // //   );
// // // // // // }







// // // // // // // components/videogallerycomponents/VideoOptionsModal.jsx
// // // // // // import { useState, useEffect } from "react";
// // // // // // import ProductsModal from "./ProductsModal";
// // // // // // import VideoPlayerWithHover from "./VideoPlayerWithHover";

// // // // // // export default function VideoOptionsModal({
// // // // // //   showVideoOptions,
// // // // // //   onHide,
// // // // // //   onCopyUrl,
// // // // // //   onDownload,
// // // // // //   onLoadProducts,
// // // // // //   onDelete,
// // // // // //   isDarkTheme,
// // // // // //   selectedProducts,
// // // // // //   products,
// // // // // //   onToggleProduct,
// // // // // //   onSaveProducts,
// // // // // //   showVideoPlayerModal
// // // // // // }) {
// // // // // //   const [isLoadingProducts, setIsLoadingProducts] = useState(false);
// // // // // //   const [showProductsModal, setShowProductsModal] = useState(false);
// // // // // //   const [savedProducts, setSavedProducts] = useState([]);
// // // // // //   const [isLoadingSavedProducts, setIsLoadingSavedProducts] = useState(false);

// // // // // //   // Fetch saved products when modal opens or video changes
// // // // // //   useEffect(() => {
// // // // // //     if (showVideoOptions.show && showVideoOptions.video?.id) {
// // // // // //       fetchSavedProducts();
// // // // // //     }
// // // // // //   }, [showVideoOptions.show, showVideoOptions.video?.id]);

// // // // // //   const fetchSavedProducts = async () => {
// // // // // //     try {
// // // // // //       setIsLoadingSavedProducts(true);
// // // // // //       const response = await fetch(`/api/videoproducts?videoId=${showVideoOptions.video.id}`);
// // // // // //       const result = await response.json();
      
// // // // // //       if (result.success) {
// // // // // //         setSavedProducts(result.products);
// // // // // //       } else {
// // // // // //         console.error('Failed to fetch saved products:', result.error);
// // // // // //         setSavedProducts([]);
// // // // // //       }
// // // // // //     } catch (error) {
// // // // // //       console.error('Error fetching saved products:', error);
// // // // // //       setSavedProducts([]);
// // // // // //     } finally {
// // // // // //       setIsLoadingSavedProducts(false);
// // // // // //     }
// // // // // //   };

// // // // // //   const handleBackdropClick = (e) => {
// // // // // //     if (e.target === e.currentTarget) {
// // // // // //       onHide();
// // // // // //     }
// // // // // //   };

// // // // // //   const handleOptionClick = (action) => {
// // // // // //     action();
// // // // // //     onHide();
// // // // // //   };

// // // // // //   // Function to handle video click - open large video player
// // // // // //   const handleVideoClick = () => {
// // // // // //     if (showVideoPlayerModal && showVideoOptions.video) {
// // // // // //       showVideoPlayerModal(showVideoOptions.video);
// // // // // //       onHide(); // Close the options modal when opening full video
// // // // // //     }
// // // // // //   };

// // // // // //   // FIXED: Load products and then show modal
// // // // // //   const handleSubmitProducts = async () => {
// // // // // //     try {
// // // // // //       setIsLoadingProducts(true);
      
// // // // // //       // Call the products API to load products
// // // // // //       if (onLoadProducts) {
// // // // // //         await onLoadProducts(showVideoOptions.video);
// // // // // //       }
      
// // // // // //       // Then show the modal
// // // // // //       setShowProductsModal(true);
// // // // // //     } catch (error) {
// // // // // //       console.error('Error loading products:', error);
// // // // // //     } finally {
// // // // // //       setIsLoadingProducts(false);
// // // // // //     }
// // // // // //   };

// // // // // //   const handleSaveProducts = async () => {
// // // // // //     if (onSaveProducts) {
// // // // // //       await onSaveProducts();
// // // // // //     }
// // // // // //     setShowProductsModal(false);
// // // // // //     // Refresh saved products after saving
// // // // // //     setTimeout(() => {
// // // // // //       fetchSavedProducts();
// // // // // //     }, 500);
// // // // // //   };

// // // // // //   const handleHideProductsModal = () => {
// // // // // //     setShowProductsModal(false);
// // // // // //   };

// // // // // //   // Get the selected products
// // // // // //   const displayProducts = selectedProducts || new Set();

// // // // // //   // Early return should be AFTER all hooks
// // // // // //   if (!showVideoOptions.show) return null;

// // // // // //   const themeStyles = {
// // // // // //     light: {
// // // // // //       background: '#ffffff',
// // // // // //       text: '#1f2937',
// // // // // //       border: '#e5e7eb',
// // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.15)',
// // // // // //       hoverBackground: '#f3f4f6',
// // // // // //       sectionBackground: '#f8fafc'
// // // // // //     },
// // // // // //     dark: {
// // // // // //       background: '#374151',
// // // // // //       text: '#f9fafb',
// // // // // //       border: '#4b5563',
// // // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.4)',
// // // // // //       hoverBackground: '#4b5563',
// // // // // //       sectionBackground: '#4b5563'
// // // // // //     }
// // // // // //   };

// // // // // //   const currentTheme = isDarkTheme ? themeStyles.dark : themeStyles.light;

// // // // // //   // Get the correct video URL - use proxy URL if available, otherwise fallback to original
// // // // // //   const videoUrl = showVideoOptions.video?.videoUrl || showVideoOptions.video?.shopify_file_url;

// // // // // //   return (
// // // // // //     <>
// // // // // //       <div 
// // // // // //         style={{
// // // // // //           position: 'fixed',
// // // // // //           top: 0,
// // // // // //           left: 0,
// // // // // //           right: 0,
// // // // // //           bottom: 0,
// // // // // //           zIndex: 10000,
// // // // // //           background: 'rgba(0, 0, 0, 0.5)',
// // // // // //           display: 'flex',
// // // // // //           justifyContent: 'center',
// // // // // //           alignItems: 'center'
// // // // // //         }}
// // // // // //         onClick={handleBackdropClick}
// // // // // //       >
// // // // // //         <div 
// // // // // //           style={{
// // // // // //             background: currentTheme.background,
// // // // // //             borderRadius: '12px',
// // // // // //             border: `1px solid ${currentTheme.border}`,
// // // // // //             boxShadow: currentTheme.shadow,
// // // // // //             padding: '1.5rem',
// // // // // //             maxWidth: '700px',
// // // // // //             minWidth: '600px',
// // // // // //             maxHeight: '80vh',
// // // // // //             zIndex: 10001,
// // // // // //             animation: 'scaleIn 0.2s ease-out',
// // // // // //             display: 'flex',
// // // // // //             flexDirection: 'row',
// // // // // //             justifyContent: 'space-between',
// // // // // //             alignItems: 'flex-start',
// // // // // //             gap: '2rem',
// // // // // //             overflow: 'hidden',
// // // // // //             position: 'relative' // Added for close button positioning
// // // // // //           }}
// // // // // //         >
// // // // // //           {/* Close Button */}
// // // // // //           <button
// // // // // //             onClick={onHide}
// // // // // //             style={{
// // // // // //               position: 'absolute',
// // // // // //               top: '1rem',
// // // // // //               right: '1rem',
// // // // // //               background: isDarkTheme ? '#374151' : 'white',
// // // // // //               border: `1px solid ${isDarkTheme ? '#4b5563' : '#e5e7eb'}`,
// // // // // //               borderRadius: '50%',
// // // // // //               width: '32px',
// // // // // //               height: '32px',
// // // // // //               display: 'flex',
// // // // // //               alignItems: 'center',
// // // // // //               justifyContent: 'center',
// // // // // //               cursor: 'pointer',
// // // // // //               color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // // // // //               fontSize: '1rem',
// // // // // //               fontWeight: 'bold',
// // // // // //               zIndex: 10002,
// // // // // //               transition: 'all 0.3s ease'
// // // // // //             }}
// // // // // //             onMouseEnter={(e) => {
// // // // // //               e.target.style.background = isDarkTheme ? '#4b5563' : '#f3f4f6';
// // // // // //               e.target.style.color = isDarkTheme ? '#f9fafb' : '#1f2937';
// // // // // //             }}
// // // // // //             onMouseLeave={(e) => {
// // // // // //               e.target.style.background = isDarkTheme ? '#374151' : 'white';
// // // // // //               e.target.style.color = isDarkTheme ? '#9ca3af' : '#6b7280';
// // // // // //             }}
// // // // // //           >
// // // // // //             ‚úï
// // // // // //           </button>

// // // // // //           {/* Left Column - Video Player */}
// // // // // //           <div style={{
// // // // // //             flex: 1,
// // // // // //             minWidth: '300px',
// // // // // //             display: 'flex',
// // // // // //             flexDirection: 'column',
// // // // // //             gap: '1.5rem'
// // // // // //           }}>
// // // // // //             {/* Video Player Section */}
// // // // // //             <div>
// // // // // //               <h3 style={{
// // // // // //                 fontSize: '0.875rem',
// // // // // //                 fontWeight: '600',
// // // // // //                 color: currentTheme.text,
// // // // // //                 margin: '0 0 1rem 0'
// // // // // //               }}>
// // // // // //                 Selected Video
// // // // // //               </h3>
              
// // // // // //               {/* Video Player with Hover - Shows the clicked video */}
// // // // // //               {videoUrl ? (
// // // // // //                 <VideoPlayerWithHover
// // // // // //                   videoUrl={videoUrl} // Use the correct video URL
// // // // // //                   thumbnailUrl={showVideoOptions.video?.thumbnail_url}
// // // // // //                   title={showVideoOptions.video?.title}
// // // // // //                   onVideoClick={handleVideoClick} // Opens full video player on click
// // // // // //                   isDarkTheme={isDarkTheme}
// // // // // //                   height="450px" // Slightly larger for better preview
// // // // // //                 />
// // // // // //               ) : (
// // // // // //                 <div style={{
// // // // // //                   height: '250px',
// // // // // //                   background: isDarkTheme ? '#374151' : '#f3f4f6',
// // // // // //                   borderRadius: '8px',
// // // // // //                   display: 'flex',
// // // // // //                   alignItems: 'center',
// // // // // //                   justifyContent: 'center',
// // // // // //                   color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // // // // //                   flexDirection: 'column',
// // // // // //                   gap: '0.5rem'
// // // // // //                 }}>
// // // // // //                   <div style={{ fontSize: '2rem' }}>üé¨</div>
// // // // // //                   <div>Video not available</div>
// // // // // //                 </div>
// // // // // //               )}
              
// // // // // //               {/* Video Info */}
// // // // // //               <div style={{
// // // // // //                 marginTop: '1rem',
// // // // // //                 padding: '0.75rem',
// // // // // //                 background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // // // // //                 borderRadius: '8px',
// // // // // //                 border: `1px solid ${isDarkTheme ? '#374151' : '#e5e7eb'}`
// // // // // //               }}>
// // // // // //                 <h4 style={{
// // // // // //                   fontSize: '0.875rem',
// // // // // //                   fontWeight: '600',
// // // // // //                   color: currentTheme.text,
// // // // // //                   margin: '0 0 0.25rem 0'
// // // // // //                 }}>
// // // // // //                   {showVideoOptions.video?.title || 'Untitled Video'}
// // // // // //                 </h4>
// // // // // //                 <p style={{
// // // // // //                   fontSize: '0.75rem',
// // // // // //                   color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // // // // //                   margin: 0
// // // // // //                 }}>
// // // // // //                   {videoUrl ? 'Hover to preview ‚Ä¢ Click to open full screen' : 'Video URL not available'}
// // // // // //                 </p>
// // // // // //               </div>
// // // // // //             </div>

// // // // // //             {/* Video Actions Section */}
// // // // // //             <div style={{
// // // // // //               display: 'flex',
// // // // // //               flexDirection: 'column',
// // // // // //               gap: '0.5rem'
// // // // // //             }}>
// // // // // //               <button
// // // // // //                 onClick={() => handleOptionClick(() => onCopyUrl(showVideoOptions.video.shopify_file_url))}
// // // // // //                 style={{
// // // // // //                   width: '100%',
// // // // // //                   background: 'transparent',
// // // // // //                   border: `1px solid ${currentTheme.border}`,
// // // // // //                   color: currentTheme.text,
// // // // // //                   padding: '0.5rem',
// // // // // //                   borderRadius: '6px',
// // // // // //                   fontSize: '0.75rem',
// // // // // //                   fontWeight: '500',
// // // // // //                   cursor: 'pointer',
// // // // // //                   transition: 'all 0.2s',
// // // // // //                   display: 'flex',
// // // // // //                   alignItems: 'center',
// // // // // //                   gap: '0.5rem',
// // // // // //                   justifyContent: 'center'
// // // // // //                 }}
// // // // // //                 onMouseEnter={(e) => {
// // // // // //                   e.target.style.background = currentTheme.hoverBackground;
// // // // // //                 }}
// // // // // //                 onMouseLeave={(e) => {
// // // // // //                   e.target.style.background = 'transparent';
// // // // // //                 }}
// // // // // //               >
// // // // // //                 üìã Copy Video URL
// // // // // //               </button>

// // // // // //               <button
// // // // // //                 onClick={() => handleOptionClick(() => onDownload(showVideoOptions.video))}
// // // // // //                 style={{
// // // // // //                   width: '100%',
// // // // // //                   background: 'transparent',
// // // // // //                   border: `1px solid ${currentTheme.border}`,
// // // // // //                   color: currentTheme.text,
// // // // // //                   padding: '0.5rem',
// // // // // //                   borderRadius: '6px',
// // // // // //                   fontSize: '0.75rem',
// // // // // //                   fontWeight: '500',
// // // // // //                   cursor: 'pointer',
// // // // // //                   transition: 'all 0.2s',
// // // // // //                   display: 'flex',
// // // // // //                   alignItems: 'center',
// // // // // //                   gap: '0.5rem',
// // // // // //                   justifyContent: 'center'
// // // // // //                 }}
// // // // // //                 onMouseEnter={(e) => {
// // // // // //                   e.target.style.background = currentTheme.hoverBackground;
// // // // // //                 }}
// // // // // //                 onMouseLeave={(e) => {
// // // // // //                   e.target.style.background = 'transparent';
// // // // // //                 }}
// // // // // //               >
// // // // // //                 ‚¨áÔ∏è Download Video
// // // // // //               </button>

// // // // // //               <button
// // // // // //                 onClick={() => handleOptionClick(() => onDelete(showVideoOptions.video.id, showVideoOptions.video.title))}
// // // // // //                 style={{
// // // // // //                   width: '100%',
// // // // // //                   background: 'transparent',
// // // // // //                   border: `1px solid #ef4444`,
// // // // // //                   color: '#ef4444',
// // // // // //                   padding: '0.5rem',
// // // // // //                   borderRadius: '6px',
// // // // // //                   fontSize: '0.75rem',
// // // // // //                   fontWeight: '500',
// // // // // //                   cursor: 'pointer',
// // // // // //                   transition: 'all 0.2s',
// // // // // //                   display: 'flex',
// // // // // //                   alignItems: 'center',
// // // // // //                   gap: '0.5rem',
// // // // // //                   justifyContent: 'center'
// // // // // //                 }}
// // // // // //                 onMouseEnter={(e) => {
// // // // // //                   e.target.style.background = '#ef4444';
// // // // // //                   e.target.style.color = 'white';
// // // // // //                 }}
// // // // // //                 onMouseLeave={(e) => {
// // // // // //                   e.target.style.background = 'transparent';
// // // // // //                   e.target.style.color = '#ef4444';
// // // // // //                 }}
// // // // // //               >
// // // // // //                 üóëÔ∏è Delete Video
// // // // // //               </button>
// // // // // //             </div>
// // // // // //           </div>

// // // // // //           {/* Right Column - Products Section */}
// // // // // //           <div style={{
// // // // // //             flex: 1,
// // // // // //             minWidth: '250px',
// // // // // //             display: 'flex',
// // // // // //             flexDirection: 'column',
// // // // // //             gap: '1.5rem',
// // // // // //             height: '100%',
// // // // // //             overflow: 'hidden'
// // // // // //           }}>
// // // // // //             {/* Products Section */}
// // // // // //             <div style={{
// // // // // //               display: 'flex',
// // // // // //               flexDirection: 'column',
// // // // // //               height: '100%',
// // // // // //               gap: '1rem'
// // // // // //             }}>
// // // // // //               <h3 style={{
// // // // // //                 fontSize: '0.875rem',
// // // // // //                 fontWeight: '600',
// // // // // //                 color: currentTheme.text,
// // // // // //                 margin: 0
// // // // // //               }}>
// // // // // //                 Product Management
// // // // // //               </h3>
              
// // // // // //               <button
// // // // // //                 onClick={handleSubmitProducts} // FIXED: This now loads products first
// // // // // //                 disabled={isLoadingProducts}
// // // // // //                 style={{
// // // // // //                   width: '100%',
// // // // // //                   background: '#10b981',
// // // // // //                   color: 'white',
// // // // // //                   border: 'none',
// // // // // //                   padding: '0.5rem',
// // // // // //                   borderRadius: '6px',
// // // // // //                   fontSize: '0.75rem',
// // // // // //                   fontWeight: '500',
// // // // // //                   cursor: isLoadingProducts ? 'not-allowed' : 'pointer',
// // // // // //                   transition: 'background-color 0.2s',
// // // // // //                   opacity: isLoadingProducts ? 0.6 : 1
// // // // // //                 }}
// // // // // //                 onMouseEnter={(e) => {
// // // // // //                   if (!isLoadingProducts) {
// // // // // //                     e.target.style.background = '#059669';
// // // // // //                   }
// // // // // //                 }}
// // // // // //                 onMouseLeave={(e) => {
// // // // // //                   if (!isLoadingProducts) {
// // // // // //                     e.target.style.background = '#10b981';
// // // // // //                   }
// // // // // //                 }}
// // // // // //               >
// // // // // //                 {isLoadingProducts ? 'Loading Products...' : 'Submit Products'}
// // // // // //               </button>

// // // // // //               {/* Saved Products Section */}
// // // // // //               <div style={{
// // // // // //                 flex: 1,
// // // // // //                 display: 'flex',
// // // // // //                 flexDirection: 'column',
// // // // // //                 overflow: 'hidden'
// // // // // //               }}>
// // // // // //                 <div style={{
// // // // // //                   fontSize: '0.75rem',
// // // // // //                   fontWeight: '600',
// // // // // //                   color: currentTheme.text,
// // // // // //                   marginBottom: '0.5rem'
// // // // // //                 }}>
// // // // // //                   Saved Products {savedProducts.length > 0 && `(${savedProducts.length})`}
// // // // // //                 </div>
                
// // // // // //                 {isLoadingSavedProducts ? (
// // // // // //                   <div style={{
// // // // // //                     textAlign: 'center',
// // // // // //                     padding: '1rem',
// // // // // //                     color: currentTheme.text,
// // // // // //                     fontSize: '0.7rem',
// // // // // //                     border: `1px solid ${currentTheme.border}`,
// // // // // //                     borderRadius: '6px',
// // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc'
// // // // // //                   }}>
// // // // // //                     Loading saved products...
// // // // // //                   </div>
// // // // // //                 ) : savedProducts.length > 0 ? (
// // // // // //                   <div style={{
// // // // // //                     flex: 1,
// // // // // //                     overflowY: 'auto',
// // // // // //                     border: `1px solid ${currentTheme.border}`,
// // // // // //                     borderRadius: '6px',
// // // // // //                     padding: '0.5rem',
// // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // // // // //                     maxHeight: '200px'
// // // // // //                   }}>
// // // // // //                     {savedProducts.map((product) => (
// // // // // //                       <div
// // // // // //                         key={product.video_product_id || product.id}
// // // // // //                         style={{
// // // // // //                           display: 'flex',
// // // // // //                           alignItems: 'center',
// // // // // //                           gap: '0.5rem',
// // // // // //                           padding: '0.5rem',
// // // // // //                           marginBottom: '0.25rem',
// // // // // //                           background: isDarkTheme ? '#374151' : '#ffffff',
// // // // // //                           borderRadius: '4px',
// // // // // //                           fontSize: '0.7rem'
// // // // // //                         }}
// // // // // //                       >
// // // // // //                         {product.image_url ? (
// // // // // //                           <img 
// // // // // //                             src={product.image_url} 
// // // // // //                             alt={product.title}
// // // // // //                             style={{
// // // // // //                               width: '20px',
// // // // // //                               height: '20px',
// // // // // //                               borderRadius: '3px',
// // // // // //                               objectFit: 'cover'
// // // // // //                             }}
// // // // // //                           />
// // // // // //                         ) : (
// // // // // //                           <div style={{
// // // // // //                             width: '20px',
// // // // // //                             height: '20px',
// // // // // //                             background: '#3b82f6',
// // // // // //                             borderRadius: '3px',
// // // // // //                             display: 'flex',
// // // // // //                             alignItems: 'center',
// // // // // //                             justifyContent: 'center',
// // // // // //                             color: 'white',
// // // // // //                             fontSize: '0.6rem',
// // // // // //                             fontWeight: 'bold'
// // // // // //                           }}>
// // // // // //                             P
// // // // // //                           </div>
// // // // // //                         )}
// // // // // //                         <div style={{ flex: 1, minWidth: 0 }}>
// // // // // //                           <div style={{
// // // // // //                             color: currentTheme.text,
// // // // // //                             fontWeight: '500',
// // // // // //                             whiteSpace: 'nowrap',
// // // // // //                             overflow: 'hidden',
// // // // // //                             textOverflow: 'ellipsis'
// // // // // //                           }}>
// // // // // //                             {product.title}
// // // // // //                           </div>
// // // // // //                           <div style={{
// // // // // //                             color: '#10b981',
// // // // // //                             fontSize: '0.65rem'
// // // // // //                           }}>
// // // // // //                             ${product.price}
// // // // // //                           </div>
// // // // // //                         </div>
// // // // // //                       </div>
// // // // // //                     ))}
// // // // // //                   </div>
// // // // // //                 ) : (
// // // // // //                   <div style={{
// // // // // //                     textAlign: 'center',
// // // // // //                     padding: '1rem',
// // // // // //                     color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // // // // //                     fontSize: '0.7rem',
// // // // // //                     fontStyle: 'italic',
// // // // // //                     border: `1px dashed ${currentTheme.border}`,
// // // // // //                     borderRadius: '6px',
// // // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc'
// // // // // //                   }}>
// // // // // //                     No products saved for this video
// // // // // //                   </div>
// // // // // //                 )}
// // // // // //               </div>

// // // // // //               <label style={{
// // // // // //                 display: 'flex',
// // // // // //                 alignItems: 'center',
// // // // // //                 gap: '0.5rem',
// // // // // //                 cursor: 'pointer',
// // // // // //                 fontSize: '0.75rem',
// // // // // //                 color: currentTheme.text,
// // // // // //                 marginTop: '0.5rem'
// // // // // //               }}>
// // // // // //                 <input 
// // // // // //                   type="checkbox" 
// // // // // //                   style={{
// // // // // //                     cursor: 'pointer'
// // // // // //                   }}
// // // // // //                 />
// // // // // //                 Enable video on product page
// // // // // //               </label>
// // // // // //             </div>
// // // // // //           </div>

// // // // // //           <style jsx>{`
// // // // // //             @keyframes scaleIn {
// // // // // //               from {
// // // // // //                 opacity: 0;
// // // // // //                 transform: scale(0.95) translateY(-10px);
// // // // // //               }
// // // // // //               to {
// // // // // //                 opacity: 1;
// // // // // //                 transform: scale(1) translateY(0);
// // // // // //               }
// // // // // //             }
// // // // // //           `}</style>
// // // // // //         </div>
// // // // // //       </div>

// // // // // //       {/* FIXED: Pass all the required props to ProductsModal */}
// // // // // //       {showProductsModal && (
// // // // // //         <ProductsModal
// // // // // //           showProductsModal={{ show: true, video: showVideoOptions.video }}
// // // // // //           products={products || []}
// // // // // //           selectedProducts={selectedProducts || new Set()}
// // // // // //           loadingProducts={isLoadingProducts}
// // // // // //           onToggleProduct={onToggleProduct || (() => {})}
// // // // // //           onSaveProducts={handleSaveProducts}
// // // // // //           onHide={handleHideProductsModal}
// // // // // //           isDarkTheme={isDarkTheme}
// // // // // //         />
// // // // // //       )}
// // // // // //     </>
// // // // // //   );
// // // // // // }











// // // // // // components/videogallerycomponents/VideoOptionsModal.jsx
// // // // // import { useState, useEffect } from "react";
// // // // // import ProductsModal from "./ProductsModal";
// // // // // import VideoPlayerWithHover from "./VideoPlayerWithHover";

// // // // // export default function VideoOptionsModal({
// // // // //   showVideoOptions,
// // // // //   onHide,
// // // // //   onCopyUrl,
// // // // //   onDownload,
// // // // //   onLoadProducts,
// // // // //   onDelete,
// // // // //   isDarkTheme,
// // // // //   selectedProducts,
// // // // //   products,
// // // // //   onToggleProduct,
// // // // //   onSaveProducts,
// // // // //   showVideoPlayerModal
// // // // // }) {
// // // // //   const [isLoadingProducts, setIsLoadingProducts] = useState(false);
// // // // //   const [showProductsModal, setShowProductsModal] = useState(false);
// // // // //   const [savedProducts, setSavedProducts] = useState([]);
// // // // //   const [isLoadingSavedProducts, setIsLoadingSavedProducts] = useState(false);

// // // // //   // Fetch saved products when modal opens or video changes
// // // // //   useEffect(() => {
// // // // //     if (showVideoOptions.show && showVideoOptions.video?.id) {
// // // // //       fetchSavedProducts();
// // // // //     }
// // // // //   }, [showVideoOptions.show, showVideoOptions.video?.id]);

// // // // //   const fetchSavedProducts = async () => {
// // // // //     try {
// // // // //       setIsLoadingSavedProducts(true);
// // // // //       const response = await fetch(`/api/videoproducts?videoId=${showVideoOptions.video.id}`);
// // // // //       const result = await response.json();
      
// // // // //       if (result.success) {
// // // // //         setSavedProducts(result.products);
// // // // //       } else {
// // // // //         console.error('Failed to fetch saved products:', result.error);
// // // // //         setSavedProducts([]);
// // // // //       }
// // // // //     } catch (error) {
// // // // //       console.error('Error fetching saved products:', error);
// // // // //       setSavedProducts([]);
// // // // //     } finally {
// // // // //       setIsLoadingSavedProducts(false);
// // // // //     }
// // // // //   };

// // // // //   const handleBackdropClick = (e) => {
// // // // //     if (e.target === e.currentTarget) {
// // // // //       onHide();
// // // // //     }
// // // // //   };

// // // // //   const handleOptionClick = (action) => {
// // // // //     action();
// // // // //     onHide();
// // // // //   };

// // // // //   // Function to handle video click - open large video player
// // // // //   const handleVideoClick = () => {
// // // // //     if (showVideoPlayerModal && showVideoOptions.video) {
// // // // //       showVideoPlayerModal(showVideoOptions.video);
// // // // //       onHide(); // Close the options modal when opening full video
// // // // //     }
// // // // //   };

// // // // //   // FIXED: Load products and then show modal
// // // // //   const handleSubmitProducts = async () => {
// // // // //     try {
// // // // //       setIsLoadingProducts(true);
      
// // // // //       // Call the products API to load products
// // // // //       if (onLoadProducts) {
// // // // //         await onLoadProducts(showVideoOptions.video);
// // // // //       }
      
// // // // //       // Then show the modal
// // // // //       setShowProductsModal(true);
// // // // //     } catch (error) {
// // // // //       console.error('Error loading products:', error);
// // // // //     } finally {
// // // // //       setIsLoadingProducts(false);
// // // // //     }
// // // // //   };

// // // // //   const handleSaveProducts = async () => {
// // // // //     if (onSaveProducts) {
// // // // //       await onSaveProducts();
// // // // //     }
// // // // //     setShowProductsModal(false);
// // // // //     // Refresh saved products after saving
// // // // //     setTimeout(() => {
// // // // //       fetchSavedProducts();
// // // // //     }, 500);
// // // // //   };

// // // // //   const handleHideProductsModal = () => {
// // // // //     setShowProductsModal(false);
// // // // //   };

// // // // //   // Get the selected products
// // // // //   const displayProducts = selectedProducts || new Set();

// // // // //   // Early return should be AFTER all hooks
// // // // //   if (!showVideoOptions.show) return null;

// // // // //   const themeStyles = {
// // // // //     light: {
// // // // //       background: '#ffffff',
// // // // //       text: '#1f2937',
// // // // //       border: '#e5e7eb',
// // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.15)',
// // // // //       hoverBackground: '#f3f4f6',
// // // // //       sectionBackground: '#f8fafc'
// // // // //     },
// // // // //     dark: {
// // // // //       background: '#374151',
// // // // //       text: '#f9fafb',
// // // // //       border: '#4b5563',
// // // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.4)',
// // // // //       hoverBackground: '#4b5563',
// // // // //       sectionBackground: '#4b5563'
// // // // //     }
// // // // //   };

// // // // //   const currentTheme = isDarkTheme ? themeStyles.dark : themeStyles.light;

// // // // //   // Get the correct video URL - use proxy URL if available, otherwise fallback to original
// // // // //   const videoUrl = showVideoOptions.video?.videoUrl || showVideoOptions.video?.shopify_file_url;

// // // // //   return (
// // // // //     <>
// // // // //       <div 
// // // // //         style={{
// // // // //           position: 'fixed',
// // // // //           top: 0,
// // // // //           left: 0,
// // // // //           right: 0,
// // // // //           bottom: 0,
// // // // //           zIndex: 10000,
// // // // //           background: 'rgba(0, 0, 0, 0.5)',
// // // // //           display: 'flex',
// // // // //           justifyContent: 'center',
// // // // //           alignItems: 'center'
// // // // //         }}
// // // // //         onClick={handleBackdropClick}
// // // // //       >
// // // // //         <div 
// // // // //           style={{
// // // // //             background: currentTheme.background,
// // // // //             borderRadius: '12px',
// // // // //             border: `1px solid ${currentTheme.border}`,
// // // // //             boxShadow: currentTheme.shadow,
// // // // //             padding: '1.5rem',
// // // // //             maxWidth: '650px', // Reduced max width
// // // // //             minWidth: '550px', // Reduced min width
// // // // //             maxHeight: '100vh',
// // // // //             zIndex: 10001,
// // // // //             animation: 'scaleIn 0.2s ease-out',
// // // // //             display: 'flex',
// // // // //             flexDirection: 'row',
// // // // //             justifyContent: 'space-between',
// // // // //             alignItems: 'flex-start',
// // // // //             gap: '1.5rem', // Reduced gap
// // // // //             overflow: 'hidden',
// // // // //             position: 'relative' // Added for close button positioning
// // // // //           }}
// // // // //         >
// // // // //           {/* Close Button */}
// // // // //           <button
// // // // //             onClick={onHide}
// // // // //             style={{
// // // // //               position: 'absolute',
// // // // //               top: '1rem',
// // // // //               right: '1rem',
// // // // //               background: isDarkTheme ? '#374151' : 'white',
// // // // //               border: `1px solid ${isDarkTheme ? '#4b5563' : '#e5e7eb'}`,
// // // // //               borderRadius: '50%',
// // // // //               width: '32px',
// // // // //               height: '32px',
// // // // //               display: 'flex',
// // // // //               alignItems: 'center',
// // // // //               justifyContent: 'center',
// // // // //               cursor: 'pointer',
// // // // //               color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // // // //               fontSize: '1rem',
// // // // //               fontWeight: 'bold',
// // // // //               zIndex: 10002,
// // // // //               transition: 'all 0.3s ease'
// // // // //             }}
// // // // //             onMouseEnter={(e) => {
// // // // //               e.target.style.background = isDarkTheme ? '#4b5563' : '#f3f4f6';
// // // // //               e.target.style.color = isDarkTheme ? '#f9fafb' : '#1f2937';
// // // // //             }}
// // // // //             onMouseLeave={(e) => {
// // // // //               e.target.style.background = isDarkTheme ? '#374151' : 'white';
// // // // //               e.target.style.color = isDarkTheme ? '#9ca3af' : '#6b7280';
// // // // //             }}
// // // // //           >
// // // // //             ‚úï
// // // // //           </button>

// // // // //           {/* Left Column - Video Player */}
// // // // //           {/* Left Column - Video Player */}
// // // // // <div style={{
// // // // //   flex: 1,
// // // // //   minWidth: '150px', // Reduced min width
// // // // //   display: 'flex',
// // // // //   flexDirection: 'row',
// // // // //   gap: '1rem'
// // // // // }}>
// // // // //   {/* Video Player Section */}
// // // // //   <div>
// // // // //     <h3 style={{
// // // // //       fontSize: '0.875rem',
// // // // //       fontWeight: '600',
// // // // //       color: currentTheme.text,
// // // // //       margin: '0 0 0.75rem 0'
// // // // //     }}>
// // // // //       Selected Video
// // // // //     </h3>
    
// // // // //     {/* Video Player with Hover - Shows the clicked video */}
// // // // //     {videoUrl ? (
// // // // //       <div style={{
// // // // //         width: '100%',
// // // // //         height: '180px', // Much smaller height
// // // // //         display: 'flex',
// // // // //         justifyContent: 'center',
// // // // //         alignItems: 'center',
// // // // //         background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // // // //         borderRadius: '8px',
// // // // //         overflow: 'hidden'
// // // // //       }}>
// // // // //         <VideoPlayerWithHover
// // // // //           videoUrl={videoUrl}
// // // // //           thumbnailUrl={showVideoOptions.video?.thumbnail_url}
// // // // //           title={showVideoOptions.video?.title}
// // // // //           onVideoClick={handleVideoClick}
// // // // //           isDarkTheme={isDarkTheme}
// // // // //           height="180px" // Reduced from 280px to 180px
// // // // //           width="100%"
// // // // //           objectFit="contain" // Change from 'cover' to 'contain' to see entire video
// // // // //         />
// // // // //       </div>
// // // // //     ) : (
// // // // //       <div style={{
// // // // //         height: '150px', // Reduced height
// // // // //         background: isDarkTheme ? '#374151' : '#f3f4f6',
// // // // //         borderRadius: '8px',
// // // // //         display: 'flex',
// // // // //         alignItems: 'center',
// // // // //         justifyContent: 'center',
// // // // //         color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // // // //         flexDirection: 'column',
// // // // //         gap: '0.5rem'
// // // // //       }}>
// // // // //         <div style={{ fontSize: '1.2rem' }}>üé¨</div> {/* Further reduced icon size */}
// // // // //         <div style={{ fontSize: '0.8rem' }}>Video not available</div>
// // // // //       </div>
// // // // //     )}
    
// // // // //     {/* Video Info
// // // // //     <div style={{
// // // // //       marginTop: '0.75rem',
// // // // //       padding: '0.5rem',
// // // // //       background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // // // //       borderRadius: '6px',
// // // // //       border: `1px solid ${isDarkTheme ? '#374151' : '#e5e7eb'}`
// // // // //     }}>
// // // // //       <h4 style={{
// // // // //         fontSize: '0.8rem',
// // // // //         fontWeight: '600',
// // // // //         color: currentTheme.text,
// // // // //         margin: '0 0 0.2rem 0'
// // // // //       }}>
// // // // //         {showVideoOptions.video?.title || 'Untitled Video'}
// // // // //       </h4>
// // // // //       <p style={{
// // // // //         fontSize: '0.7rem',
// // // // //         color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // // // //         margin: 0
// // // // //       }}>
// // // // //         {videoUrl ? 'Hover to preview ‚Ä¢ Click to open full screen' : 'Video URL not available'}
// // // // //       </p>
// // // // //     </div> */}
// // // // //   </div>
// // // // // {/* Video Actions Section */}
// // // // // <div style={{
// // // // //   marginTop: "10px",
// // // // //   marginBottom: "10px",
// // // // //   display: 'flex',
// // // // //   flexDirection: 'column', // Changed to row for horizontal layout
// // // // //   justifyContent: 'center', // Center the buttons
// // // // //   alignItems: 'center',
// // // // //   gap: '8px' // Reduced gap between buttons
// // // // // }}>
// // // // //   <button
// // // // //     onClick={() => handleOptionClick(() => onCopyUrl(showVideoOptions.video.shopify_file_url))}
// // // // //     title="Copy Video URL"
// // // // //     style={{
// // // // //       background: 'transparent',
// // // // //       border: 'none',
// // // // //       color: currentTheme.text,
// // // // //       borderRadius: '6px',
// // // // //       fontSize: '1.2rem',
// // // // //       fontWeight: '500',
// // // // //       cursor: 'pointer',
// // // // //       transition: 'all 0.2s',
// // // // //       display: 'flex',
// // // // //       alignItems: 'center',
// // // // //       justifyContent: 'center',
// // // // //       width: '32px', // Fixed width
// // // // //       height: '32px', // Fixed height
// // // // //       opacity: 0.8
// // // // //     }}
// // // // //     onMouseEnter={(e) => {
// // // // //       e.target.style.transform = 'scale(1.1)';
// // // // //       e.target.style.opacity = '1';
// // // // //     }}
// // // // //     onMouseLeave={(e) => {
// // // // //       e.target.style.transform = 'scale(1)';
// // // // //       e.target.style.opacity = '0.8';
// // // // //     }}
// // // // //   >
// // // // //     üìã
// // // // //   </button>

// // // // //   <button
// // // // //     onClick={() => handleOptionClick(() => onDownload(showVideoOptions.video))}
// // // // //     title="Download Video"
// // // // //     style={{
// // // // //       background: 'transparent',
// // // // //       border: 'none',
// // // // //       color: currentTheme.text,
// // // // //       borderRadius: '6px',
// // // // //       fontSize: '1.2rem',
// // // // //       fontWeight: '500',
// // // // //       cursor: 'pointer',
// // // // //       transition: 'all 0.2s',
// // // // //       display: 'flex',
// // // // //       alignItems: 'center',
// // // // //       justifyContent: 'center',
// // // // //       width: '32px',
// // // // //       height: '32px',
// // // // //       opacity: 0.8
// // // // //     }}
// // // // //     onMouseEnter={(e) => {
// // // // //       e.target.style.transform = 'scale(1.1)';
// // // // //       e.target.style.opacity = '1';
// // // // //     }}
// // // // //     onMouseLeave={(e) => {
// // // // //       e.target.style.transform = 'scale(1)';
// // // // //       e.target.style.opacity = '0.8';
// // // // //     }}
// // // // //   >
// // // // //     ‚¨áÔ∏è
// // // // //   </button>

// // // // //   <button
// // // // //     onClick={() => handleOptionClick(() => onDelete(showVideoOptions.video.id, showVideoOptions.video.title))}
// // // // //     title="Delete Video"
// // // // //     style={{
// // // // //       background: 'transparent',
// // // // //       border: 'none',
// // // // //       color: '#ef4444',
// // // // //       borderRadius: '6px',
// // // // //       fontSize: '1.2rem',
// // // // //       fontWeight: '500',
// // // // //       cursor: 'pointer',
// // // // //       transition: 'all 0.2s',
// // // // //       display: 'flex',
// // // // //       alignItems: 'center',
// // // // //       justifyContent: 'center',
// // // // //       width: '32px',
// // // // //       height: '32px',
// // // // //       opacity: 0.8
// // // // //     }}
// // // // //     onMouseEnter={(e) => {
// // // // //       e.target.style.transform = 'scale(1.1)';
// // // // //       e.target.style.opacity = '1';
// // // // //     }}
// // // // //     onMouseLeave={(e) => {
// // // // //       e.target.style.transform = 'scale(1)';
// // // // //       e.target.style.opacity = '0.8';
// // // // //     }}
// // // // //   >
// // // // //     üóëÔ∏è
// // // // //   </button>
// // // // // </div>
// // // // // </div>

// // // // //           {/* Right Column - Products Section */}
// // // // //           <div style={{
// // // // //             flex: 1,
// // // // //             minWidth: '220px', // Reduced min width
// // // // //             display: 'flex',
// // // // //             flexDirection: 'column',
// // // // //             gap: '1rem', // Reduced gap
// // // // //             height: '100%',
// // // // //             overflow: 'hidden'
// // // // //           }}>
// // // // //             {/* Products Section */}
// // // // //             <div style={{
// // // // //               display: 'flex',
// // // // //               flexDirection: 'column',
// // // // //               height: '100%',
// // // // //               gap: '0.8rem' // Reduced gap
// // // // //             }}>
// // // // //               <h3 style={{
// // // // //                 fontSize: '0.875rem',
// // // // //                 fontWeight: '600',
// // // // //                 color: currentTheme.text,
// // // // //                 margin: 0
// // // // //               }}>
// // // // //                 Product Management
// // // // //               </h3>
              
// // // // //               <button
// // // // //                 onClick={handleSubmitProducts} // FIXED: This now loads products first
// // // // //                 disabled={isLoadingProducts}
// // // // //                 style={{
// // // // //                   width: '100%',
// // // // //                   background: '#10b981',
// // // // //                   color: 'white',
// // // // //                   border: 'none',
// // // // //                   padding: '0.4rem', // Reduced padding
// // // // //                   borderRadius: '6px',
// // // // //                   fontSize: '0.7rem', // Slightly smaller
// // // // //                   fontWeight: '500',
// // // // //                   cursor: isLoadingProducts ? 'not-allowed' : 'pointer',
// // // // //                   transition: 'background-color 0.2s',
// // // // //                   opacity: isLoadingProducts ? 0.6 : 1
// // // // //                 }}
// // // // //                 onMouseEnter={(e) => {
// // // // //                   if (!isLoadingProducts) {
// // // // //                     e.target.style.background = '#059669';
// // // // //                   }
// // // // //                 }}
// // // // //                 onMouseLeave={(e) => {
// // // // //                   if (!isLoadingProducts) {
// // // // //                     e.target.style.background = '#10b981';
// // // // //                   }
// // // // //                 }}
// // // // //               >
// // // // //                 {isLoadingProducts ? 'Loading Products...' : 'Submit Products'}
// // // // //               </button>

// // // // //               {/* Saved Products Section */}
// // // // //               <div style={{
// // // // //                 flex: 1,
// // // // //                 display: 'flex',
// // // // //                 flexDirection: 'column',
// // // // //                 overflow: 'hidden'
// // // // //               }}>
// // // // //                 <div style={{
// // // // //                   fontSize: '0.7rem', // Slightly smaller
// // // // //                   fontWeight: '600',
// // // // //                   color: currentTheme.text,
// // // // //                   marginBottom: '0.4rem' // Reduced margin
// // // // //                 }}>
// // // // //                   Saved Products {savedProducts.length > 0 && `(${savedProducts.length})`}
// // // // //                 </div>
                
// // // // //                 {isLoadingSavedProducts ? (
// // // // //                   <div style={{
// // // // //                     textAlign: 'center',
// // // // //                     padding: '0.8rem', // Reduced padding
// // // // //                     color: currentTheme.text,
// // // // //                     fontSize: '0.65rem', // Slightly smaller
// // // // //                     border: `1px solid ${currentTheme.border}`,
// // // // //                     borderRadius: '6px',
// // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc'
// // // // //                   }}>
// // // // //                     Loading saved products...
// // // // //                   </div>
// // // // //                 ) : savedProducts.length > 0 ? (
// // // // //                   <div style={{
// // // // //                     flex: 1,
// // // // //                     overflowY: 'auto',
// // // // //                     border: `1px solid ${currentTheme.border}`,
// // // // //                     borderRadius: '6px',
// // // // //                     padding: '0.4rem', // Reduced padding
// // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // // // //                     maxHeight: '180px' // Slightly reduced max height
// // // // //                   }}>
// // // // //                     {savedProducts.map((product) => (
// // // // //                       <div
// // // // //                         key={product.video_product_id || product.id}
// // // // //                         style={{
// // // // //                           display: 'flex',
// // // // //                           alignItems: 'center',
// // // // //                           gap: '0.4rem', // Reduced gap
// // // // //                           padding: '0.4rem', // Reduced padding
// // // // //                           marginBottom: '0.2rem', // Reduced margin
// // // // //                           background: isDarkTheme ? '#374151' : '#ffffff',
// // // // //                           borderRadius: '4px',
// // // // //                           fontSize: '0.65rem' // Slightly smaller
// // // // //                         }}
// // // // //                       >
// // // // //                         {product.image_url ? (
// // // // //                           <img 
// // // // //                             src={product.image_url} 
// // // // //                             alt={product.title}
// // // // //                             style={{
// // // // //                               width: '18px', // Slightly smaller
// // // // //                               height: '18px', // Slightly smaller
// // // // //                               borderRadius: '3px',
// // // // //                               objectFit: 'cover'
// // // // //                             }}
// // // // //                           />
// // // // //                         ) : (
// // // // //                           <div style={{
// // // // //                             width: '18px', // Slightly smaller
// // // // //                             height: '18px', // Slightly smaller
// // // // //                             background: '#3b82f6',
// // // // //                             borderRadius: '3px',
// // // // //                             display: 'flex',
// // // // //                             alignItems: 'center',
// // // // //                             justifyContent: 'center',
// // // // //                             color: 'white',
// // // // //                             fontSize: '0.55rem', // Slightly smaller
// // // // //                             fontWeight: 'bold'
// // // // //                           }}>
// // // // //                             P
// // // // //                           </div>
// // // // //                         )}
// // // // //                         <div style={{ flex: 1, minWidth: 0 }}>
// // // // //                           <div style={{
// // // // //                             color: currentTheme.text,
// // // // //                             fontWeight: '500',
// // // // //                             whiteSpace: 'nowrap',
// // // // //                             overflow: 'hidden',
// // // // //                             textOverflow: 'ellipsis'
// // // // //                           }}>
// // // // //                             {product.title}
// // // // //                           </div>
// // // // //                           <div style={{
// // // // //                             color: '#10b981',
// // // // //                             fontSize: '0.6rem' // Slightly smaller
// // // // //                           }}>
// // // // //                             ${product.price}
// // // // //                           </div>
// // // // //                         </div>
// // // // //                       </div>
// // // // //                     ))}
// // // // //                   </div>
// // // // //                 ) : (
// // // // //                   <div style={{
// // // // //                     textAlign: 'center',
// // // // //                     padding: '0.8rem', // Reduced padding
// // // // //                     color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // // // //                     fontSize: '0.65rem', // Slightly smaller
// // // // //                     fontStyle: 'italic',
// // // // //                     border: `1px dashed ${currentTheme.border}`,
// // // // //                     borderRadius: '6px',
// // // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc'
// // // // //                   }}>
// // // // //                     No products saved for this video
// // // // //                   </div>
// // // // //                 )}
// // // // //               </div>

// // // // //               <label style={{
// // // // //                 display: 'flex',
// // // // //                 alignItems: 'center',
// // // // //                 gap: '0.4rem', // Reduced gap
// // // // //                 cursor: 'pointer',
// // // // //                 fontSize: '0.7rem', // Slightly smaller
// // // // //                 color: currentTheme.text,
// // // // //                 marginTop: '0.4rem' // Reduced margin
// // // // //               }}>
// // // // //                 <input 
// // // // //                   type="checkbox" 
// // // // //                   style={{
// // // // //                     cursor: 'pointer'
// // // // //                   }}
// // // // //                 />
// // // // //                 Enable video on product page
// // // // //               </label>
// // // // //             </div>
// // // // //           </div>

// // // // //           <style jsx>{`
// // // // //             @keyframes scaleIn {
// // // // //               from {
// // // // //                 opacity: 0;
// // // // //                 transform: scale(0.95) translateY(-10px);
// // // // //               }
// // // // //               to {
// // // // //                 opacity: 1;
// // // // //                 transform: scale(1) translateY(0);
// // // // //               }
// // // // //             }
// // // // //           `}</style>
// // // // //         </div>
// // // // //       </div>

// // // // //       {/* FIXED: Pass all the required props to ProductsModal */}
// // // // //       {showProductsModal && (
// // // // //         <ProductsModal
// // // // //           showProductsModal={{ show: true, video: showVideoOptions.video }}
// // // // //           products={products || []}
// // // // //           selectedProducts={selectedProducts || new Set()}
// // // // //           loadingProducts={isLoadingProducts}
// // // // //           onToggleProduct={onToggleProduct || (() => {})}
// // // // //           onSaveProducts={handleSaveProducts}
// // // // //           onHide={handleHideProductsModal}
// // // // //           isDarkTheme={isDarkTheme}
// // // // //         />
// // // // //       )}
// // // // //     </>
// // // // //   );
// // // // // }






// // // // // components/videogallerycomponents/VideoOptionsModal.jsx
// // // // import { useState, useEffect } from "react";
// // // // import ProductsModal from "./ProductsModal";
// // // // import VideoPlayerWithHover from "./VideoPlayerWithHover";

// // // // export default function VideoOptionsModal({
// // // //   showVideoOptions,
// // // //   onHide,
// // // //   onCopyUrl,
// // // //   onDownload,
// // // //   onLoadProducts,
// // // //   onDelete,
// // // //   isDarkTheme,
// // // //   selectedProducts,
// // // //   products,
// // // //   onToggleProduct,
// // // //   onSaveProducts,
// // // //   showVideoPlayerModal
// // // // }) {
// // // //   const [isLoadingProducts, setIsLoadingProducts] = useState(false);
// // // //   const [showProductsModal, setShowProductsModal] = useState(false);
// // // //   const [savedProducts, setSavedProducts] = useState([]);
// // // //   const [isLoadingSavedProducts, setIsLoadingSavedProducts] = useState(false);

// // // //   // Fetch saved products when modal opens or video changes
// // // //   useEffect(() => {
// // // //     if (showVideoOptions.show && showVideoOptions.video?.id) {
// // // //       fetchSavedProducts();
// // // //     }
// // // //   }, [showVideoOptions.show, showVideoOptions.video?.id]);

// // // //   const fetchSavedProducts = async () => {
// // // //     try {
// // // //       setIsLoadingSavedProducts(true);
// // // //       const response = await fetch(`/api/videoproducts?videoId=${showVideoOptions.video.id}`);
// // // //       const result = await response.json();
      
// // // //       if (result.success) {
// // // //         setSavedProducts(result.products);
// // // //       } else {
// // // //         console.error('Failed to fetch saved products:', result.error);
// // // //         setSavedProducts([]);
// // // //       }
// // // //     } catch (error) {
// // // //       console.error('Error fetching saved products:', error);
// // // //       setSavedProducts([]);
// // // //     } finally {
// // // //       setIsLoadingSavedProducts(false);
// // // //     }
// // // //   };

// // // //   const handleBackdropClick = (e) => {
// // // //     if (e.target === e.currentTarget) {
// // // //       onHide();
// // // //     }
// // // //   };

// // // //   const handleOptionClick = (action) => {
// // // //     action();
// // // //     onHide();
// // // //   };

// // // //   // Function to handle video click - open large video player
// // // //   const handleVideoClick = () => {
// // // //     if (showVideoPlayerModal && showVideoOptions.video) {
// // // //       showVideoPlayerModal(showVideoOptions.video);
// // // //       onHide(); // Close the options modal when opening full video
// // // //     }
// // // //   };

// // // //   // FIXED: Load products and then show modal
// // // //   const handleSubmitProducts = async () => {
// // // //     try {
// // // //       setIsLoadingProducts(true);
      
// // // //       // Call the products API to load products
// // // //       if (onLoadProducts) {
// // // //         await onLoadProducts(showVideoOptions.video);
// // // //       }
      
// // // //       // Then show the modal
// // // //       setShowProductsModal(true);
// // // //     } catch (error) {
// // // //       console.error('Error loading products:', error);
// // // //     } finally {
// // // //       setIsLoadingProducts(false);
// // // //     }
// // // //   };

// // // //   const handleSaveProducts = async () => {
// // // //     if (onSaveProducts) {
// // // //       await onSaveProducts();
// // // //     }
// // // //     setShowProductsModal(false);
// // // //     // Refresh saved products after saving
// // // //     setTimeout(() => {
// // // //       fetchSavedProducts();
// // // //     }, 500);
// // // //   };

// // // //   const handleHideProductsModal = () => {
// // // //     setShowProductsModal(false);
// // // //   };

// // // //   // Get the selected products
// // // //   const displayProducts = selectedProducts || new Set();

// // // //   // Early return should be AFTER all hooks
// // // //   if (!showVideoOptions.show) return null;

// // // //   const themeStyles = {
// // // //     light: {
// // // //       background: '#ffffff',
// // // //       text: '#1f2937',
// // // //       border: '#e5e7eb',
// // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.15)',
// // // //       hoverBackground: '#f3f4f6',
// // // //       sectionBackground: '#f8fafc'
// // // //     },
// // // //     dark: {
// // // //       background: '#374151',
// // // //       text: '#f9fafb',
// // // //       border: '#4b5563',
// // // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.4)',
// // // //       hoverBackground: '#4b5563',
// // // //       sectionBackground: '#4b5563'
// // // //     }
// // // //   };

// // // //   const currentTheme = isDarkTheme ? themeStyles.dark : themeStyles.light;

// // // //   // Get the correct video URL - use proxy URL if available, otherwise fallback to original
// // // //   const videoUrl = showVideoOptions.video?.videoUrl || showVideoOptions.video?.shopify_file_url;

// // // //   return (
// // // //     <>
// // // //       <div 
// // // //         style={{
// // // //           position: 'fixed',
// // // //           top: 0,
// // // //           left: 0,
// // // //           right: 0,
// // // //           bottom: 0,
// // // //           zIndex: 10000,
// // // //           background: 'rgba(0, 0, 0, 0.5)',
// // // //           display: 'flex',
// // // //           justifyContent: 'center',
// // // //           alignItems: 'center'
// // // //         }}
// // // //         onClick={handleBackdropClick}
// // // //       >
// // // //         <div 
// // // //           style={{
// // // //             background: currentTheme.background,
// // // //             borderRadius: '12px',
// // // //             border: `1px solid ${currentTheme.border}`,
// // // //             boxShadow: currentTheme.shadow,
// // // //             padding: '2rem', // Increased padding
// // // //             maxWidth: '700px', // Increased max width by 5rem
// // // //             minWidth: '600px', // Increased min width by 5rem
// // // //             maxHeight: 'calc(100vh - 4rem)',
// // // //             height: 'auto', // Increased height
// // // //             minHeight: '450px', // Added minimum height
// // // //             zIndex: 10001,
// // // //             animation: 'scaleIn 0.2s ease-out',
// // // //             display: 'flex',
// // // //             flexDirection: 'row',
// // // //             justifyContent: 'space-between',
// // // //             alignItems: 'flex-start',
// // // //             gap: '2rem', // Increased gap
// // // //             overflow: 'hidden',
// // // //             position: 'relative' // Added for close button positioning
// // // //           }}
// // // //         >
// // // //           {/* Close Button */}
// // // //           <button
// // // //             onClick={onHide}
// // // //             style={{
// // // //               position: 'absolute',
// // // //               top: '1.2rem', // Adjusted position
// // // //               right: '1.2rem', // Adjusted position
// // // //               background: isDarkTheme ? '#374151' : 'white',
// // // //               border: `1px solid ${isDarkTheme ? '#4b5563' : '#e5e7eb'}`,
// // // //               borderRadius: '50%',
// // // //               width: '36px', // Increased size
// // // //               height: '36px', // Increased size
// // // //               display: 'flex',
// // // //               alignItems: 'center',
// // // //               justifyContent: 'center',
// // // //               cursor: 'pointer',
// // // //               color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // // //               fontSize: '1.2rem', // Increased font size
// // // //               fontWeight: 'bold',
// // // //               zIndex: 10002,
// // // //               transition: 'all 0.3s ease'
// // // //             }}
// // // //             onMouseEnter={(e) => {
// // // //               e.target.style.background = isDarkTheme ? '#4b5563' : '#f3f4f6';
// // // //               e.target.style.color = isDarkTheme ? '#f9fafb' : '#1f2937';
// // // //             }}
// // // //             onMouseLeave={(e) => {
// // // //               e.target.style.background = isDarkTheme ? '#374151' : 'white';
// // // //               e.target.style.color = isDarkTheme ? '#9ca3af' : '#6b7280';
// // // //             }}
// // // //           >
// // // //             ‚úï
// // // //           </button>

// // // //           {/* Left Column - Video Player */}
// // // //           <div style={{
// // // //             flex: 1,
// // // //             minWidth: '180px', // Increased min width
// // // //             display: 'flex',
// // // //             flexDirection: 'row',
// // // //             gap: '1.5rem' // Increased gap
// // // //           }}>
// // // //             {/* Video Player Section */}
// // // //             <div>
// // // //               <h3 style={{
// // // //                 fontSize: '1rem', // Increased font size
// // // //                 fontWeight: '600',
// // // //                 color: currentTheme.text,
// // // //                 margin: '0 0 1rem 0' // Increased margin
// // // //               }}>
// // // //                 Selected Video
// // // //               </h3>
              
// // // //               {/* Video Player with Hover - Shows the clicked video */}
// // // //               {videoUrl ? (
// // // //                 <div style={{
// // // //                   width: '100%',
// // // //                   height: '220px', // Increased height
// // // //                   display: 'flex',
// // // //                   justifyContent: 'center',
// // // //                   alignItems: 'center',
// // // //                   background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // // //                   borderRadius: '8px',
// // // //                   overflow: 'hidden'
// // // //                 }}>
// // // //                   <VideoPlayerWithHover
// // // //                     videoUrl={videoUrl}
// // // //                     thumbnailUrl={showVideoOptions.video?.thumbnail_url}
// // // //                     title={showVideoOptions.video?.title}
// // // //                     onVideoClick={handleVideoClick}
// // // //                     isDarkTheme={isDarkTheme}
// // // //                     height="220px" // Increased height
// // // //                     width="100%"
// // // //                     objectFit="contain"
// // // //                   />
// // // //                 </div>
// // // //               ) : (
// // // //                 <div style={{
// // // //                   height: '180px', // Increased height
// // // //                   background: isDarkTheme ? '#374151' : '#f3f4f6',
// // // //                   borderRadius: '8px',
// // // //                   display: 'flex',
// // // //                   alignItems: 'center',
// // // //                   justifyContent: 'center',
// // // //                   color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // // //                   flexDirection: 'column',
// // // //                   gap: '0.75rem' // Increased gap
// // // //                 }}>
// // // //                   <div style={{ fontSize: '1.5rem' }}>üé¨</div> {/* Increased icon size */}
// // // //                   <div style={{ fontSize: '0.9rem' }}>Video not available</div> {/* Increased font size */}
// // // //                 </div>
// // // //               )}
// // // //             </div>

// // // //             {/* Video Actions Section */}
// // // //             <div style={{
// // // //               marginTop: "40px", // Increased margin
// // // //               marginBottom: "10px",
// // // //               display: 'flex',
// // // //               flexDirection: 'column',
// // // //               justifyContent: 'center',
// // // //               alignItems: 'center',
// // // //               gap: '12px' // Increased gap between buttons
// // // //             }}>
// // // //               <button
// // // //                 onClick={() => handleOptionClick(() => onCopyUrl(showVideoOptions.video.shopify_file_url))}
// // // //                 title="Copy Video URL"
// // // //                 style={{
// // // //                   background: 'transparent',
// // // //                   border: 'none',
// // // //                   color: currentTheme.text,
// // // //                   borderRadius: '8px', // Increased border radius
// // // //                   fontSize: '1.4rem', // Increased font size
// // // //                   fontWeight: '500',
// // // //                   cursor: 'pointer',
// // // //                   transition: 'all 0.2s',
// // // //                   display: 'flex',
// // // //                   alignItems: 'center',
// // // //                   justifyContent: 'center',
// // // //                   width: '40px', // Increased width
// // // //                   height: '40px', // Increased height
// // // //                   opacity: 0.8
// // // //                 }}
// // // //                 onMouseEnter={(e) => {
// // // //                   e.target.style.transform = 'scale(1.1)';
// // // //                   e.target.style.opacity = '1';
// // // //                 }}
// // // //                 onMouseLeave={(e) => {
// // // //                   e.target.style.transform = 'scale(1)';
// // // //                   e.target.style.opacity = '0.8';
// // // //                 }}
// // // //               >
// // // //                 <img src="https://cdn-icons-png.flaticon.com/512/684/684908.png" alt="Copy Link" style={{ width: '20px', height: '20px', filter: isDarkTheme ? 'invert(1)' : 'none' }} />
// // // //               </button>

// // // //               <button
// // // //                 onClick={() => handleOptionClick(() => onDownload(showVideoOptions.video))}
// // // //                 title="Download Video"
// // // //                 style={{
// // // //                   background: 'transparent',
// // // //                   border: 'none',
// // // //                   color: currentTheme.text,
// // // //                   borderRadius: '8px', // Increased border radius
// // // //                   fontSize: '1.4rem', // Increased font size
// // // //                   fontWeight: '500',
// // // //                   cursor: 'pointer',
// // // //                   transition: 'all 0.2s',
// // // //                   display: 'flex',
// // // //                   alignItems: 'center',
// // // //                   justifyContent: 'center',
// // // //                   width: '40px', // Increased width
// // // //                   height: '40px', // Increased height
// // // //                   opacity: 0.8
// // // //                 }}
// // // //                 onMouseEnter={(e) => {
// // // //                   e.target.style.transform = 'scale(1.1)';
// // // //                   e.target.style.opacity = '1';
// // // //                 }}
// // // //                 onMouseLeave={(e) => {
// // // //                   e.target.style.transform = 'scale(1)';
// // // //                   e.target.style.opacity = '0.8';
// // // //                 }}
// // // //               >
// // // //                 <img src="https://cdn-icons-png.flaticon.com/512/2991/2991937.png" alt="Download" style={{ width: '20px', height: '20px', filter: isDarkTheme ? 'invert(1)' : 'none' }} />
// // // //               </button>

// // // //               <button
// // // //                 onClick={() => handleOptionClick(() => onDelete(showVideoOptions.video.id, showVideoOptions.video.title))}
// // // //                 title="Delete Video"
// // // //                 style={{
// // // //                   background: 'transparent',
// // // //                   border: 'none',
// // // //                   color: '#ef4444',
// // // //                   borderRadius: '8px', // Increased border radius
// // // //                   fontSize: '1.4rem', // Increased font size
// // // //                   fontWeight: '500',
// // // //                   cursor: 'pointer',
// // // //                   transition: 'all 0.2s',
// // // //                   display: 'flex',
// // // //                   alignItems: 'center',
// // // //                   justifyContent: 'center',
// // // //                   width: '40px', // Increased width
// // // //                   height: '40px', // Increased height
// // // //                   opacity: 0.8
// // // //                 }}
// // // //                 onMouseEnter={(e) => {
// // // //                   e.target.style.transform = 'scale(1.1)';
// // // //                   e.target.style.opacity = '1';
// // // //                 }}
// // // //                 onMouseLeave={(e) => {
// // // //                   e.target.style.transform = 'scale(1)';
// // // //                   e.target.style.opacity = '0.8';
// // // //                 }}
// // // //               >
// // // //                 <img src="https://cdn-icons-png.flaticon.com/512/3597/3597075.png" alt="Delete" style={{ width: '20px', height: '20px', filter: 'invert(0.5) sepia(1) saturate(5) hue-rotate(330deg)' }} />
// // // //               </button>
// // // //             </div>
// // // //           </div>

// // // //           {/* Right Column - Products Section */}
// // // //           <div style={{
// // // //             flex: 1,
// // // //             minWidth: '260px', // Increased min width
// // // //             display: 'flex',
// // // //             flexDirection: 'column',
// // // //             gap: '1.5rem', // Increased gap
// // // //             height: '100%',
// // // //             overflow: 'hidden'
// // // //           }}>
// // // //             {/* Products Section */}
// // // //             <div style={{
// // // //               display: 'flex',
// // // //               flexDirection: 'column',
// // // //               height: '100%',
// // // //               gap: '1rem' // Increased gap
// // // //             }}>
// // // //               <h3 style={{
// // // //                 fontSize: '1rem', // Increased font size
// // // //                 fontWeight: '600',
// // // //                 color: currentTheme.text,
// // // //                 margin: 0
// // // //               }}>
// // // //                 Product Management
// // // //               </h3>
              
// // // //               <button
// // // //                 onClick={handleSubmitProducts}
// // // //                 disabled={isLoadingProducts}
// // // //                 style={{
// // // //                   width: '100%',
// // // //                   background: '#10b981',
// // // //                   color: 'white',
// // // //                   border: 'none',
// // // //                   padding: '0.6rem', // Increased padding
// // // //                   borderRadius: '8px', // Increased border radius
// // // //                   fontSize: '0.85rem', // Increased font size
// // // //                   fontWeight: '500',
// // // //                   cursor: isLoadingProducts ? 'not-allowed' : 'pointer',
// // // //                   transition: 'background-color 0.2s',
// // // //                   opacity: isLoadingProducts ? 0.6 : 1,
// // // //                   height: '42px' // Added fixed height
// // // //                 }}
// // // //                 onMouseEnter={(e) => {
// // // //                   if (!isLoadingProducts) {
// // // //                     e.target.style.background = '#059669';
// // // //                   }
// // // //                 }}
// // // //                 onMouseLeave={(e) => {
// // // //                   if (!isLoadingProducts) {
// // // //                     e.target.style.background = '#10b981';
// // // //                   }
// // // //                 }}
// // // //               >
// // // //                 {isLoadingProducts ? 'Loading Products...' : 'Submit Products'}
// // // //               </button>

// // // //               {/* Saved Products Section */}
// // // //               <div style={{
// // // //                 flex: 1,
// // // //                 display: 'flex',
// // // //                 flexDirection: 'column',
// // // //                 overflow: 'hidden'
// // // //               }}>
// // // //                 <div style={{
// // // //                   fontSize: '0.85rem', // Increased font size
// // // //                   fontWeight: '600',
// // // //                   color: currentTheme.text,
// // // //                   marginBottom: '0.6rem' // Increased margin
// // // //                 }}>
// // // //                   Saved Products {savedProducts.length > 0 && `(${savedProducts.length})`}
// // // //                 </div>
                
// // // //                 {isLoadingSavedProducts ? (
// // // //                   <div style={{
// // // //                     textAlign: 'center',
// // // //                     padding: '1rem', // Increased padding
// // // //                     color: currentTheme.text,
// // // //                     fontSize: '0.8rem', // Increased font size
// // // //                     border: `1px solid ${currentTheme.border}`,
// // // //                     borderRadius: '8px', // Increased border radius
// // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // // //                     height: '60px', // Added height
// // // //                     display: 'flex',
// // // //                     alignItems: 'center',
// // // //                     justifyContent: 'center'
// // // //                   }}>
// // // //                     Loading saved products...
// // // //                   </div>
// // // //                 ) : savedProducts.length > 0 ? (
// // // //                   <div style={{
// // // //                     flex: 1,
// // // //                     overflowY: 'auto',
// // // //                     border: `1px solid ${currentTheme.border}`,
// // // //                     borderRadius: '8px', // Increased border radius
// // // //                     padding: '0.6rem', // Increased padding
// // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // // //                     maxHeight: '220px' // Increased max height
// // // //                   }}>
// // // //                     {savedProducts.map((product) => (
// // // //                       <div
// // // //                         key={product.video_product_id || product.id}
// // // //                         style={{
// // // //                           display: 'flex',
// // // //                           alignItems: 'center',
// // // //                           gap: '0.6rem', // Increased gap
// // // //                           padding: '0.6rem', // Increased padding
// // // //                           marginBottom: '0.4rem', // Increased margin
// // // //                           background: isDarkTheme ? '#374151' : '#ffffff',
// // // //                           borderRadius: '6px', // Increased border radius
// // // //                           fontSize: '0.75rem' // Increased font size
// // // //                         }}
// // // //                       >
// // // //                         {product.image_url ? (
// // // //                           <img 
// // // //                             src={product.image_url} 
// // // //                             alt={product.title}
// // // //                             style={{
// // // //                               width: '24px', // Increased size
// // // //                               height: '24px', // Increased size
// // // //                               borderRadius: '4px', // Increased border radius
// // // //                               objectFit: 'cover'
// // // //                             }}
// // // //                           />
// // // //                         ) : (
// // // //                           <div style={{
// // // //                             width: '24px', // Increased size
// // // //                             height: '24px', // Increased size
// // // //                             background: '#3b82f6',
// // // //                             borderRadius: '4px', // Increased border radius
// // // //                             display: 'flex',
// // // //                             alignItems: 'center',
// // // //                             justifyContent: 'center',
// // // //                             color: 'white',
// // // //                             fontSize: '0.7rem', // Increased font size
// // // //                             fontWeight: 'bold'
// // // //                           }}>
// // // //                             P
// // // //                           </div>
// // // //                         )}
// // // //                         <div style={{ flex: 1, minWidth: 0 }}>
// // // //                           <div style={{
// // // //                             color: currentTheme.text,
// // // //                             fontWeight: '500',
// // // //                             whiteSpace: 'nowrap',
// // // //                             overflow: 'hidden',
// // // //                             textOverflow: 'ellipsis'
// // // //                           }}>
// // // //                             {product.title}
// // // //                           </div>
// // // //                           <div style={{
// // // //                             color: '#10b981',
// // // //                             fontSize: '0.7rem' // Increased font size
// // // //                           }}>
// // // //                             ${product.price}
// // // //                           </div>
// // // //                         </div>
// // // //                       </div>
// // // //                     ))}
// // // //                   </div>
// // // //                 ) : (
// // // //                   <div style={{
// // // //                     textAlign: 'center',
// // // //                     padding: '1rem', // Increased padding
// // // //                     color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // // //                     fontSize: '0.8rem', // Increased font size
// // // //                     fontStyle: 'italic',
// // // //                     border: `1px dashed ${currentTheme.border}`,
// // // //                     borderRadius: '8px', // Increased border radius
// // // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // // //                     height: '60px', // Added height
// // // //                     display: 'flex',
// // // //                     alignItems: 'center',
// // // //                     justifyContent: 'center'
// // // //                   }}>
// // // //                     No products saved for this video
// // // //                   </div>
// // // //                 )}
// // // //               </div>

// // // //               <label style={{
// // // //                 display: 'flex',
// // // //                 alignItems: 'center',
// // // //                 gap: '0.6rem', // Increased gap
// // // //                 cursor: 'pointer',
// // // //                 fontSize: '0.85rem', // Increased font size
// // // //                 color: currentTheme.text,
// // // //                 marginTop: '0.6rem' // Increased margin
// // // //               }}>
// // // //                 <input 
// // // //                   type="checkbox" 
// // // //                   style={{
// // // //                     cursor: 'pointer',
// // // //                     width: '16px', // Increased size
// // // //                     height: '16px' // Increased size
// // // //                   }}
// // // //                 />
// // // //                 Enable video on product page
// // // //               </label>
// // // //             </div>
// // // //           </div>

// // // //           <style jsx>{`
// // // //             @keyframes scaleIn {
// // // //               from {
// // // //                 opacity: 0;
// // // //                 transform: scale(0.95) translateY(-10px);
// // // //               }
// // // //               to {
// // // //                 opacity: 1;
// // // //                 transform: scale(1) translateY(0);
// // // //               }
// // // //             }
// // // //           `}</style>
// // // //         </div>
// // // //       </div>

// // // //       {/* FIXED: Pass all the required props to ProductsModal */}
// // // //       {showProductsModal && (
// // // //         <ProductsModal
// // // //           showProductsModal={{ show: true, video: showVideoOptions.video }}
// // // //           products={products || []}
// // // //           selectedProducts={selectedProducts || new Set()}
// // // //           loadingProducts={isLoadingProducts}
// // // //           onToggleProduct={onToggleProduct || (() => {})}
// // // //           onSaveProducts={handleSaveProducts}
// // // //           onHide={handleHideProductsModal}
// // // //           isDarkTheme={isDarkTheme}
// // // //         />
// // // //       )}
// // // //     </>
// // // //   );
// // // // }




// // // // components/videogallerycomponents/VideoOptionsModal.jsx
// // // import { useState, useEffect } from "react";
// // // import ProductsModal from "./ProductsModal";
// // // import VideoPlayerWithHover from "./VideoPlayerWithHover";

// // // export default function VideoOptionsModal({
// // //   showVideoOptions,
// // //   onHide,
// // //   onCopyUrl,
// // //   onDownload,
// // //   onLoadProducts,
// // //   onDelete,
// // //   isDarkTheme,
// // //   selectedProducts,
// // //   products,
// // //   onToggleProduct,
// // //   onSaveProducts,
// // //   showVideoPlayerModal
// // // }) {
// // //   const [isLoadingProducts, setIsLoadingProducts] = useState(false);
// // //   const [showProductsModal, setShowProductsModal] = useState(false);
// // //   const [savedProducts, setSavedProducts] = useState([]);
// // //   const [isLoadingSavedProducts, setIsLoadingSavedProducts] = useState(false);

// // //   // Fetch saved products when modal opens or video changes
// // //   useEffect(() => {
// // //     if (showVideoOptions.show && showVideoOptions.video?.id) {
// // //       fetchSavedProducts();
// // //     }
// // //   }, [showVideoOptions.show, showVideoOptions.video?.id]);

// // //   const fetchSavedProducts = async () => {
// // //     try {
// // //       setIsLoadingSavedProducts(true);
// // //       const response = await fetch(`/api/videoproducts?videoId=${showVideoOptions.video.id}`);
// // //       const result = await response.json();
      
// // //       if (result.success) {
// // //         setSavedProducts(result.products);
// // //       } else {
// // //         console.error('Failed to fetch saved products:', result.error);
// // //         setSavedProducts([]);
// // //       }
// // //     } catch (error) {
// // //       console.error('Error fetching saved products:', error);
// // //       setSavedProducts([]);
// // //     } finally {
// // //       setIsLoadingSavedProducts(false);
// // //     }
// // //   };

// // //   const handleBackdropClick = (e) => {
// // //     if (e.target === e.currentTarget) {
// // //       onHide();
// // //     }
// // //   };

// // //   const handleOptionClick = (action) => {
// // //     action();
// // //     onHide();
// // //   };

// // //   // Function to handle video click - open large video player
// // //   const handleVideoClick = () => {
// // //     if (showVideoPlayerModal && showVideoOptions.video) {
// // //       showVideoPlayerModal(showVideoOptions.video);
// // //       onHide(); // Close the options modal when opening full video
// // //     }
// // //   };

// // //   // FIXED: Load products and then show modal
// // //   const handleSubmitProducts = async () => {
// // //     try {
// // //       setIsLoadingProducts(true);
      
// // //       // Call the products API to load products
// // //       if (onLoadProducts) {
// // //         await onLoadProducts(showVideoOptions.video);
// // //       }
      
// // //       // Then show the modal
// // //       setShowProductsModal(true);
// // //     } catch (error) {
// // //       console.error('Error loading products:', error);
// // //     } finally {
// // //       setIsLoadingProducts(false);
// // //     }
// // //   };

// // //   const handleSaveProducts = async () => {
// // //     if (onSaveProducts) {
// // //       await onSaveProducts();
// // //     }
// // //     setShowProductsModal(false);
// // //     // Refresh saved products after saving - with a slight delay to ensure DB update
// // //     setTimeout(() => {
// // //       fetchSavedProducts();
// // //     }, 500);
// // //   };

// // //   // UPDATED: Handle modal close - refresh products when modal closes regardless of save action
// // //   const handleHideProductsModal = () => {
// // //     setShowProductsModal(false);
// // //     // Refresh saved products when the products modal closes
// // //     // This ensures we show the latest selected products even if user didn't explicitly click "Save"
// // //     setTimeout(() => {
// // //       fetchSavedProducts();
// // //     }, 300);
// // //   };

// // //   // Get the selected products
// // //   const displayProducts = selectedProducts || new Set();

// // //   // Early return should be AFTER all hooks
// // //   if (!showVideoOptions.show) return null;

// // //   const themeStyles = {
// // //     light: {
// // //       background: '#ffffff',
// // //       text: '#1f2937',
// // //       border: '#e5e7eb',
// // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.15)',
// // //       hoverBackground: '#f3f4f6',
// // //       sectionBackground: '#f8fafc'
// // //     },
// // //     dark: {
// // //       background: '#374151',
// // //       text: '#f9fafb',
// // //       border: '#4b5563',
// // //       shadow: '0 10px 25px rgba(0, 0, 0, 0.4)',
// // //       hoverBackground: '#4b5563',
// // //       sectionBackground: '#4b5563'
// // //     }
// // //   };

// // //   const currentTheme = isDarkTheme ? themeStyles.dark : themeStyles.light;

// // //   // Get the correct video URL - use proxy URL if available, otherwise fallback to original
// // //   const videoUrl = showVideoOptions.video?.videoUrl || showVideoOptions.video?.shopify_file_url;

// // //   return (
// // //     <>
// // //       <div 
// // //         style={{
// // //           position: 'fixed',
// // //           top: 0,
// // //           left: 0,
// // //           right: 0,
// // //           bottom: 0,
// // //           zIndex: 10000,
// // //           background: 'rgba(0, 0, 0, 0.5)',
// // //           display: 'flex',
// // //           justifyContent: 'center',
// // //           alignItems: 'center'
// // //         }}
// // //         onClick={handleBackdropClick}
// // //       >
// // //         <div 
// // //           style={{
// // //             background: currentTheme.background,
// // //             borderRadius: '12px',
// // //             border: `1px solid ${currentTheme.border}`,
// // //             boxShadow: currentTheme.shadow,
// // //             padding: '2rem', // Increased padding
// // //             maxWidth: '700px', // Increased max width by 5rem
// // //             minWidth: '600px', // Increased min width by 5rem
// // //             maxHeight: 'calc(100vh - 4rem)',
// // //             height: 'auto', // Increased height
// // //             minHeight: '450px', // Added minimum height
// // //             zIndex: 10001,
// // //             animation: 'scaleIn 0.2s ease-out',
// // //             display: 'flex',
// // //             flexDirection: 'row',
// // //             justifyContent: 'space-between',
// // //             alignItems: 'flex-start',
// // //             gap: '2rem', // Increased gap
// // //             overflow: 'hidden',
// // //             position: 'relative' // Added for close button positioning
// // //           }}
// // //         >
// // //           {/* Close Button */}
// // //           <button
// // //             onClick={onHide}
// // //             style={{
// // //               position: 'absolute',
// // //               top: '1.2rem', // Adjusted position
// // //               right: '1.2rem', // Adjusted position
// // //               background: isDarkTheme ? '#374151' : 'white',
// // //               border: `1px solid ${isDarkTheme ? '#4b5563' : '#e5e7eb'}`,
// // //               borderRadius: '50%',
// // //               width: '36px', // Increased size
// // //               height: '36px', // Increased size
// // //               display: 'flex',
// // //               alignItems: 'center',
// // //               justifyContent: 'center',
// // //               cursor: 'pointer',
// // //               color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // //               fontSize: '1.2rem', // Increased font size
// // //               fontWeight: 'bold',
// // //               zIndex: 10002,
// // //               transition: 'all 0.3s ease'
// // //             }}
// // //             onMouseEnter={(e) => {
// // //               e.target.style.background = isDarkTheme ? '#4b5563' : '#f3f4f6';
// // //               e.target.style.color = isDarkTheme ? '#f9fafb' : '#1f2937';
// // //             }}
// // //             onMouseLeave={(e) => {
// // //               e.target.style.background = isDarkTheme ? '#374151' : 'white';
// // //               e.target.style.color = isDarkTheme ? '#9ca3af' : '#6b7280';
// // //             }}
// // //           >
// // //             ‚úï
// // //           </button>

// // //           {/* Left Column - Video Player */}
// // //           <div style={{
// // //             flex: 1,
// // //             minWidth: '180px', // Increased min width
// // //             display: 'flex',
// // //             flexDirection: 'row',
// // //             gap: '1.5rem' // Increased gap
// // //           }}>
// // //             {/* Video Player Section */}
// // //             <div>
// // //               <h3 style={{
// // //                 fontSize: '1rem', // Increased font size
// // //                 fontWeight: '600',
// // //                 color: currentTheme.text,
// // //                 margin: '0 0 1rem 0' // Increased margin
// // //               }}>
// // //                 Selected Video
// // //               </h3>
              
// // //               {/* Video Player with Hover - Shows the clicked video */}
// // //               {videoUrl ? (
// // //                 <div style={{
// // //                   width: '100%',
// // //                   height: '220px', // Increased height
// // //                   display: 'flex',
// // //                   justifyContent: 'center',
// // //                   alignItems: 'center',
// // //                   background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // //                   borderRadius: '8px',
// // //                   overflow: 'hidden'
// // //                 }}>
// // //                   <VideoPlayerWithHover
// // //                     videoUrl={videoUrl}
// // //                     thumbnailUrl={showVideoOptions.video?.thumbnail_url}
// // //                     title={showVideoOptions.video?.title}
// // //                     onVideoClick={handleVideoClick}
// // //                     isDarkTheme={isDarkTheme}
// // //                     height="220px" // Increased height
// // //                     width="100%"
// // //                     objectFit="contain"
// // //                   />
// // //                 </div>
// // //               ) : (
// // //                 <div style={{
// // //                   height: '180px', // Increased height
// // //                   background: isDarkTheme ? '#374151' : '#f3f4f6',
// // //                   borderRadius: '8px',
// // //                   display: 'flex',
// // //                   alignItems: 'center',
// // //                   justifyContent: 'center',
// // //                   color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // //                   flexDirection: 'column',
// // //                   gap: '0.75rem' // Increased gap
// // //                 }}>
// // //                   <div style={{ fontSize: '1.5rem' }}>üé¨</div> {/* Increased icon size */}
// // //                   <div style={{ fontSize: '0.9rem' }}>Video not available</div> {/* Increased font size */}
// // //                 </div>
// // //               )}
// // //             </div>

// // //             {/* Video Actions Section */}
// // //             <div style={{
// // //               marginTop: "40px", // Increased margin
// // //               marginBottom: "10px",
// // //               display: 'flex',
// // //               flexDirection: 'column',
// // //               justifyContent: 'center',
// // //               alignItems: 'center',
// // //               gap: '12px' // Increased gap between buttons
// // //             }}>
// // //               <button
// // //                 onClick={() => handleOptionClick(() => onCopyUrl(showVideoOptions.video.shopify_file_url))}
// // //                 title="Copy Video URL"
// // //                 style={{
// // //                   background: 'transparent',
// // //                   border: 'none',
// // //                   color: currentTheme.text,
// // //                   borderRadius: '8px', // Increased border radius
// // //                   fontSize: '1.4rem', // Increased font size
// // //                   fontWeight: '500',
// // //                   cursor: 'pointer',
// // //                   transition: 'all 0.2s',
// // //                   display: 'flex',
// // //                   alignItems: 'center',
// // //                   justifyContent: 'center',
// // //                   width: '40px', // Increased width
// // //                   height: '40px', // Increased height
// // //                   opacity: 0.8
// // //                 }}
// // //                 onMouseEnter={(e) => {
// // //                   e.target.style.transform = 'scale(1.1)';
// // //                   e.target.style.opacity = '1';
// // //                 }}
// // //                 onMouseLeave={(e) => {
// // //                   e.target.style.transform = 'scale(1)';
// // //                   e.target.style.opacity = '0.8';
// // //                 }}
// // //               >
// // //                 <img src="https://cdn-icons-png.flaticon.com/512/684/684908.png" alt="Copy Link" style={{ width: '20px', height: '20px', filter: isDarkTheme ? 'invert(1)' : 'none' }} />
// // //               </button>

// // //               <button
// // //                 onClick={() => handleOptionClick(() => onDownload(showVideoOptions.video))}
// // //                 title="Download Video"
// // //                 style={{
// // //                   background: 'transparent',
// // //                   border: 'none',
// // //                   color: currentTheme.text,
// // //                   borderRadius: '8px', // Increased border radius
// // //                   fontSize: '1.4rem', // Increased font size
// // //                   fontWeight: '500',
// // //                   cursor: 'pointer',
// // //                   transition: 'all 0.2s',
// // //                   display: 'flex',
// // //                   alignItems: 'center',
// // //                   justifyContent: 'center',
// // //                   width: '40px', // Increased width
// // //                   height: '40px', // Increased height
// // //                   opacity: 0.8
// // //                 }}
// // //                 onMouseEnter={(e) => {
// // //                   e.target.style.transform = 'scale(1.1)';
// // //                   e.target.style.opacity = '1';
// // //                 }}
// // //                 onMouseLeave={(e) => {
// // //                   e.target.style.transform = 'scale(1)';
// // //                   e.target.style.opacity = '0.8';
// // //                 }}
// // //               >
// // //                 <img src="https://cdn-icons-png.flaticon.com/512/2991/2991937.png" alt="Download" style={{ width: '20px', height: '20px', filter: isDarkTheme ? 'invert(1)' : 'none' }} />
// // //               </button>

// // //               <button
// // //                 onClick={() => handleOptionClick(() => onDelete(showVideoOptions.video.id, showVideoOptions.video.title))}
// // //                 title="Delete Video"
// // //                 style={{
// // //                   background: 'transparent',
// // //                   border: 'none',
// // //                   color: '#ef4444',
// // //                   borderRadius: '8px', // Increased border radius
// // //                   fontSize: '1.4rem', // Increased font size
// // //                   fontWeight: '500',
// // //                   cursor: 'pointer',
// // //                   transition: 'all 0.2s',
// // //                   display: 'flex',
// // //                   alignItems: 'center',
// // //                   justifyContent: 'center',
// // //                   width: '40px', // Increased width
// // //                   height: '40px', // Increased height
// // //                   opacity: 0.8
// // //                 }}
// // //                 onMouseEnter={(e) => {
// // //                   e.target.style.transform = 'scale(1.1)';
// // //                   e.target.style.opacity = '1';
// // //                 }}
// // //                 onMouseLeave={(e) => {
// // //                   e.target.style.transform = 'scale(1)';
// // //                   e.target.style.opacity = '0.8';
// // //                 }}
// // //               >
// // //                 <img src="https://cdn-icons-png.flaticon.com/512/3597/3597075.png" alt="Delete" style={{ width: '20px', height: '20px', filter: 'invert(0.5) sepia(1) saturate(5) hue-rotate(330deg)' }} />
// // //               </button>
// // //             </div>
// // //           </div>

// // //           {/* Right Column - Products Section */}
// // //           <div style={{
// // //             flex: 1,
// // //             minWidth: '260px', // Increased min width
// // //             display: 'flex',
// // //             flexDirection: 'column',
// // //             gap: '1.5rem', // Increased gap
// // //             height: '100%',
// // //             overflow: 'hidden'
// // //           }}>
// // //             {/* Products Section */}
// // //             <div style={{
// // //               display: 'flex',
// // //               flexDirection: 'column',
// // //               height: '100%',
// // //               gap: '1rem' // Increased gap
// // //             }}>
// // //               <h3 style={{
// // //                 fontSize: '1rem', // Increased font size
// // //                 fontWeight: '600',
// // //                 color: currentTheme.text,
// // //                 margin: 0
// // //               }}>
// // //                 Product Management
// // //               </h3>
              
// // //               <button
// // //                 onClick={handleSubmitProducts}
// // //                 disabled={isLoadingProducts}
// // //                 style={{
// // //                   width: '100%',
// // //                   background: '#10b981',
// // //                   color: 'white',
// // //                   border: 'none',
// // //                   padding: '0.6rem', // Increased padding
// // //                   borderRadius: '8px', // Increased border radius
// // //                   fontSize: '0.85rem', // Increased font size
// // //                   fontWeight: '500',
// // //                   cursor: isLoadingProducts ? 'not-allowed' : 'pointer',
// // //                   transition: 'background-color 0.2s',
// // //                   opacity: isLoadingProducts ? 0.6 : 1,
// // //                   height: '42px' // Added fixed height
// // //                 }}
// // //                 onMouseEnter={(e) => {
// // //                   if (!isLoadingProducts) {
// // //                     e.target.style.background = '#059669';
// // //                   }
// // //                 }}
// // //                 onMouseLeave={(e) => {
// // //                   if (!isLoadingProducts) {
// // //                     e.target.style.background = '#10b981';
// // //                   }
// // //                 }}
// // //               >
// // //                 {isLoadingProducts ? 'Loading Products...' : 'Submit Products'}
// // //               </button>

// // //               {/* Saved Products Section */}
// // //               <div style={{
// // //                 flex: 1,
// // //                 display: 'flex',
// // //                 flexDirection: 'column',
// // //                 overflow: 'hidden'
// // //               }}>
// // //                 <div style={{
// // //                   fontSize: '0.85rem', // Increased font size
// // //                   fontWeight: '600',
// // //                   color: currentTheme.text,
// // //                   marginBottom: '0.6rem' // Increased margin
// // //                 }}>
// // //                   Saved Products {savedProducts.length > 0 && `(${savedProducts.length})`}
// // //                 </div>
                
// // //                 {isLoadingSavedProducts ? (
// // //                   <div style={{
// // //                     textAlign: 'center',
// // //                     padding: '1rem', // Increased padding
// // //                     color: currentTheme.text,
// // //                     fontSize: '0.8rem', // Increased font size
// // //                     border: `1px solid ${currentTheme.border}`,
// // //                     borderRadius: '8px', // Increased border radius
// // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // //                     height: '60px', // Added height
// // //                     display: 'flex',
// // //                     alignItems: 'center',
// // //                     justifyContent: 'center'
// // //                   }}>
// // //                     Loading saved products...
// // //                   </div>
// // //                 ) : savedProducts.length > 0 ? (
// // //                   <div style={{
// // //                     flex: 1,
// // //                     overflowY: 'auto',
// // //                     border: `1px solid ${currentTheme.border}`,
// // //                     borderRadius: '8px', // Increased border radius
// // //                     padding: '0.6rem', // Increased padding
// // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // //                     maxHeight: '220px' // Increased max height
// // //                   }}>
// // //                     {savedProducts.map((product) => (
// // //                       <div
// // //                         key={product.video_product_id || product.id}
// // //                         style={{
// // //                           display: 'flex',
// // //                           alignItems: 'center',
// // //                           gap: '0.6rem', // Increased gap
// // //                           padding: '0.6rem', // Increased padding
// // //                           marginBottom: '0.4rem', // Increased margin
// // //                           background: isDarkTheme ? '#374151' : '#ffffff',
// // //                           borderRadius: '6px', // Increased border radius
// // //                           fontSize: '0.75rem' // Increased font size
// // //                         }}
// // //                       >
// // //                         {product.image_url ? (
// // //                           <img 
// // //                             src={product.image_url} 
// // //                             alt={product.title}
// // //                             style={{
// // //                               width: '24px', // Increased size
// // //                               height: '24px', // Increased size
// // //                               borderRadius: '4px', // Increased border radius
// // //                               objectFit: 'cover'
// // //                             }}
// // //                           />
// // //                         ) : (
// // //                           <div style={{
// // //                             width: '24px', // Increased size
// // //                             height: '24px', // Increased size
// // //                             background: '#3b82f6',
// // //                             borderRadius: '4px', // Increased border radius
// // //                             display: 'flex',
// // //                             alignItems: 'center',
// // //                             justifyContent: 'center',
// // //                             color: 'white',
// // //                             fontSize: '0.7rem', // Increased font size
// // //                             fontWeight: 'bold'
// // //                           }}>
// // //                             P
// // //                           </div>
// // //                         )}
// // //                         <div style={{ flex: 1, minWidth: 0 }}>
// // //                           <div style={{
// // //                             color: currentTheme.text,
// // //                             fontWeight: '500',
// // //                             whiteSpace: 'nowrap',
// // //                             overflow: 'hidden',
// // //                             textOverflow: 'ellipsis'
// // //                           }}>
// // //                             {product.title}
// // //                           </div>
// // //                           <div style={{
// // //                             color: '#10b981',
// // //                             fontSize: '0.7rem' // Increased font size
// // //                           }}>
// // //                             ${product.price}
// // //                           </div>
// // //                         </div>
// // //                       </div>
// // //                     ))}
// // //                   </div>
// // //                 ) : (
// // //                   <div style={{
// // //                     textAlign: 'center',
// // //                     padding: '1rem', // Increased padding
// // //                     color: isDarkTheme ? '#9ca3af' : '#6b7280',
// // //                     fontSize: '0.8rem', // Increased font size
// // //                     fontStyle: 'italic',
// // //                     border: `1px dashed ${currentTheme.border}`,
// // //                     borderRadius: '8px', // Increased border radius
// // //                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
// // //                     height: '60px', // Added height
// // //                     display: 'flex',
// // //                     alignItems: 'center',
// // //                     justifyContent: 'center'
// // //                   }}>
// // //                     No products saved for this video
// // //                   </div>
// // //                 )}
// // //               </div>

// // //               <label style={{
// // //                 display: 'flex',
// // //                 alignItems: 'center',
// // //                 gap: '0.6rem', // Increased gap
// // //                 cursor: 'pointer',
// // //                 fontSize: '0.85rem', // Increased font size
// // //                 color: currentTheme.text,
// // //                 marginTop: '0.6rem' // Increased margin
// // //               }}>
// // //                 <input 
// // //                   type="checkbox" 
// // //                   style={{
// // //                     cursor: 'pointer',
// // //                     width: '16px', // Increased size
// // //                     height: '16px' // Increased size
// // //                   }}
// // //                 />
// // //                 Enable video on product page
// // //               </label>
// // //             </div>
// // //           </div>

// // //           <style jsx>{`
// // //             @keyframes scaleIn {
// // //               from {
// // //                 opacity: 0;
// // //                 transform: scale(0.95) translateY(-10px);
// // //               }
// // //               to {
// // //                 opacity: 1;
// // //                 transform: scale(1) translateY(0);
// // //               }
// // //             }
// // //           `}</style>
// // //         </div>
// // //       </div>

// // //       {/* FIXED: Pass all the required props to ProductsModal */}
// // //       {showProductsModal && (
// // //         <ProductsModal
// // //           showProductsModal={{ show: true, video: showVideoOptions.video }}
// // //           products={products || []}
// // //           selectedProducts={selectedProducts || new Set()}
// // //           loadingProducts={isLoadingProducts}
// // //           onToggleProduct={onToggleProduct || (() => {})}
// // //           onSaveProducts={handleSaveProducts}
// // //           onHide={handleHideProductsModal} // UPDATED: Now this will refresh products when modal closes
// // //           isDarkTheme={isDarkTheme}
// // //         />
// // //       )}
// // //     </>
// // //   );
// // // }



// // // components/videogallerycomponents/VideoOptionsModal.jsx
// // import { useState, useEffect } from "react";
// // import ProductsModal from "./ProductsModal";
// // import VideoPlayerWithHover from "./VideoPlayerWithHover";

// // export default function VideoOptionsModal({
// //   showVideoOptions,
// //   onHide,
// //   onCopyUrl,
// //   onDownload,
// //   onLoadProducts,
// //   onDelete,
// //   isDarkTheme,
// //   selectedProducts,
// //   products,
// //   onToggleProduct,
// //   onSaveProducts,
// //   showVideoPlayerModal
// // }) {
// //   const [isLoadingProducts, setIsLoadingProducts] = useState(false);
// //   const [showProductsModal, setShowProductsModal] = useState(false);
// //   const [savedProducts, setSavedProducts] = useState([]);
// //   const [isLoadingSavedProducts, setIsLoadingSavedProducts] = useState(false);
// //   const [productsModalTriggered, setProductsModalTriggered] = useState(false);

// //   // Fetch saved products when modal opens or video changes
// //   useEffect(() => {
// //     if (showVideoOptions.show && showVideoOptions.video?.id) {
// //       fetchSavedProducts();
// //       setProductsModalTriggered(false); // Reset when modal opens
// //     }
// //   }, [showVideoOptions.show, showVideoOptions.video?.id]);

// //   const fetchSavedProducts = async () => {
// //     try {
// //       setIsLoadingSavedProducts(true);
// //       const response = await fetch(`/api/videoproducts?videoId=${showVideoOptions.video.id}`);
// //       const result = await response.json();
      
// //       if (result.success) {
// //         setSavedProducts(result.products);
// //       } else {
// //         console.error('Failed to fetch saved products:', result.error);
// //         setSavedProducts([]);
// //       }
// //     } catch (error) {
// //       console.error('Error fetching saved products:', error);
// //       setSavedProducts([]);
// //     } finally {
// //       setIsLoadingSavedProducts(false);
// //     }
// //   };

// //   const handleBackdropClick = (e) => {
// //     if (e.target === e.currentTarget) {
// //       onHide();
// //     }
// //   };

// //   const handleOptionClick = (action) => {
// //     action();
// //     onHide();
// //   };

// //   // Function to handle video click - open large video player
// //   const handleVideoClick = () => {
// //     if (showVideoPlayerModal && showVideoOptions.video) {
// //       showVideoPlayerModal(showVideoOptions.video);
// //       onHide(); // Close the options modal when opening full video
// //     }
// //   };

// //   // FIXED: Load products and then show modal - prevent double opening
// //   const handleAddProducts = async () => {
// //     if (productsModalTriggered) return; // Prevent multiple clicks
    
// //     try {
// //       setIsLoadingProducts(true);
// //       setProductsModalTriggered(true);
      
// //       // Call the products API to load products
// //       if (onLoadProducts) {
// //         await onLoadProducts(showVideoOptions.video);
// //       }
      
// //       // Then show the modal
// //       setShowProductsModal(true);
// //     } catch (error) {
// //       console.error('Error loading products:', error);
// //       setProductsModalTriggered(false); // Reset on error
// //     } finally {
// //       setIsLoadingProducts(false);
// //     }
// //   };

// //   const handleSaveProducts = async () => {
// //     if (onSaveProducts) {
// //       await onSaveProducts();
// //     }
// //     setShowProductsModal(false);
// //     setProductsModalTriggered(false); // Reset after save
// //     // Refresh saved products after saving - with a slight delay to ensure DB update
// //     setTimeout(() => {
// //       fetchSavedProducts();
// //     }, 500);
// //   };

// //   // UPDATED: Handle modal close - refresh products when modal closes regardless of save action
// //   const handleHideProductsModal = () => {
// //     setShowProductsModal(false);
// //     setProductsModalTriggered(false); // Reset when modal closes
// //     // Refresh saved products when the products modal closes
// //     // This ensures we show the latest selected products even if user didn't explicitly click "Save"
// //     setTimeout(() => {
// //       fetchSavedProducts();
// //     }, 300);
// //   };

// //   // Get the selected products
// //   const displayProducts = selectedProducts || new Set();

// //   // Early return should be AFTER all hooks
// //   if (!showVideoOptions.show) return null;

// //   const themeStyles = {
// //     light: {
// //       background: '#ffffff',
// //       text: '#1f2937',
// //       border: '#e5e7eb',
// //       shadow: '0 10px 25px rgba(0, 0, 0, 0.15)',
// //       hoverBackground: '#f3f4f6',
// //       sectionBackground: '#f8fafc'
// //     },
// //     dark: {
// //       background: '#374151',
// //       text: '#f9fafb',
// //       border: '#4b5563',
// //       shadow: '0 10px 25px rgba(0, 0, 0, 0.4)',
// //       hoverBackground: '#4b5563',
// //       sectionBackground: '#4b5563'
// //     }
// //   };

// //   const currentTheme = isDarkTheme ? themeStyles.dark : themeStyles.light;

// //   // Get the correct video URL - use proxy URL if available, otherwise fallback to original
// //   const videoUrl = showVideoOptions.video?.videoUrl || showVideoOptions.video?.shopify_file_url;

// //   return (
// //     <>
// //       <div 
// //         style={{
// //           position: 'fixed',
// //           top: 0,
// //           left: 0,
// //           right: 0,
// //           bottom: 0,
// //           zIndex: 10000,
// //           background: 'rgba(0, 0, 0, 0.5)',
// //           display: 'flex',
// //           justifyContent: 'center',
// //           alignItems: 'center'
// //         }}
// //         onClick={handleBackdropClick}
// //       >
// //         <div 
// //           style={{
// //             background: currentTheme.background,
// //             borderRadius: '12px',
// //             border: `1px solid ${currentTheme.border}`,
// //             boxShadow: currentTheme.shadow,
// //             padding: '2.5rem', // Increased padding
// //             maxWidth: '750px', // Increased max width by 5rem (from 700px to 750px)
// //             minWidth: '650px', // Increased min width by 5rem (from 600px to 650px)
// //             maxHeight: 'calc(100vh - 4rem)',
// //             height: 'auto',
// //             minHeight: '500px', // Increased minimum height
// //             zIndex: 10001,
// //             animation: 'scaleIn 0.2s ease-out',
// //             display: 'flex',
// //             flexDirection: 'row',
// //             justifyContent: 'space-between',
// //             alignItems: 'flex-start',
// //             gap: '2.5rem', // Increased gap
// //             overflow: 'hidden',
// //             position: 'relative'
// //           }}
// //         >
// //           {/* Close Button */}
// //           <button
// //             onClick={onHide}
// //             style={{
// //               position: 'absolute',
// //               top: '1.5rem', // Adjusted position
// //               right: '1.5rem', // Adjusted position
// //               background: isDarkTheme ? '#374151' : 'white',
// //               border: `1px solid ${isDarkTheme ? '#4b5563' : '#e5e7eb'}`,
// //               borderRadius: '50%',
// //               width: '40px', // Increased size
// //               height: '40px', // Increased size
// //               display: 'flex',
// //               alignItems: 'center',
// //               justifyContent: 'center',
// //               cursor: 'pointer',
// //               color: isDarkTheme ? '#9ca3af' : '#6b7280',
// //               fontSize: '1.3rem', // Increased font size
// //               fontWeight: 'bold',
// //               zIndex: 10002,
// //               transition: 'all 0.3s ease'
// //             }}
// //             onMouseEnter={(e) => {
// //               e.target.style.background = isDarkTheme ? '#4b5563' : '#f3f4f6';
// //               e.target.style.color = isDarkTheme ? '#f9fafb' : '#1f2937';
// //             }}
// //             onMouseLeave={(e) => {
// //               e.target.style.background = isDarkTheme ? '#374151' : 'white';
// //               e.target.style.color = isDarkTheme ? '#9ca3af' : '#6b7280';
// //             }}
// //           >
// //             ‚úï
// //           </button>

// //           {/* Left Column - Video Player */}
// //           <div style={{
// //             flex: 1,
// //             minWidth: '200px', // Increased min width
// //             display: 'flex',
// //             flexDirection: 'row',
// //             gap: '2rem', // Increased gap
// //             position: 'relative'
// //           }}>
// //             {/* Vertical Line Separator */}
// //             <div 
// //               style={{
// //                 position: 'absolute',
// //                 right: '-1.25rem', // Position to the right of left column
// //                 top: '0',
// //                 bottom: '0',
// //                 width: '1px',
// //                 background: isDarkTheme ? '#4b5563' : '#e5e7eb',
// //                 zIndex: 1
// //               }}
// //             />

// //             {/* Video Player Section */}
// //             <div style={{ flex: 1 }}>
// //               <h3 style={{
// //                 fontSize: '1.1rem', // Increased font size
// //                 fontWeight: '600',
// //                 color: currentTheme.text,
// //                 margin: '0 0 1.2rem 0' // Increased margin
// //               }}>
// //                 Selected Video
// //               </h3>
              
// //               {/* Video Player with Hover - Shows the clicked video */}
// //               {videoUrl ? (
// //                 <div style={{
// //                   width: '100%',
// //                   height: '250px', // Increased height
// //                   display: 'flex',
// //                   justifyContent: 'center',
// //                   alignItems: 'center',
// //                   background: isDarkTheme ? '#1f2937' : '#f8fafc',
// //                   borderRadius: '10px', // Increased border radius
// //                   overflow: 'hidden'
// //                 }}>
// //                   <VideoPlayerWithHover
// //                     videoUrl={videoUrl}
// //                     thumbnailUrl={showVideoOptions.video?.thumbnail_url}
// //                     title={showVideoOptions.video?.title}
// //                     onVideoClick={handleVideoClick}
// //                     isDarkTheme={isDarkTheme}
// //                     height="250px" // Increased height
// //                     width="100%"
// //                     objectFit="contain"
// //                   />
// //                 </div>
// //               ) : (
// //                 <div style={{
// //                   height: '200px', // Increased height
// //                   background: isDarkTheme ? '#374151' : '#f3f4f6',
// //                   borderRadius: '10px', // Increased border radius
// //                   display: 'flex',
// //                   alignItems: 'center',
// //                   justifyContent: 'center',
// //                   color: isDarkTheme ? '#9ca3af' : '#6b7280',
// //                   flexDirection: 'column',
// //                   gap: '0.8rem' // Increased gap
// //                 }}>
// //                   <div style={{ fontSize: '1.8rem' }}>üé¨</div> {/* Increased icon size */}
// //                   <div style={{ fontSize: '1rem' }}>Video not available</div> {/* Increased font size */}
// //                 </div>
// //               )}
// //             </div>

// //             {/* Video Actions Section */}
// //             <div style={{
// //               marginTop: "50px", // Increased margin
// //               display: 'flex',
// //               flexDirection: 'column',
// //               justifyContent: 'center',
// //               alignItems: 'center',
// //               gap: '15px' // Increased gap between buttons
// //             }}>
// //               <button
// //                 onClick={() => handleOptionClick(() => onCopyUrl(showVideoOptions.video.shopify_file_url))}
// //                 title="Copy Video URL"
// //                 style={{
// //                   background: 'transparent',
// //                   border: 'none',
// //                   color: currentTheme.text,
// //                   borderRadius: '10px', // Increased border radius
// //                   fontSize: '1.5rem', // Increased font size
// //                   fontWeight: '500',
// //                   cursor: 'pointer',
// //                   transition: 'all 0.2s',
// //                   display: 'flex',
// //                   alignItems: 'center',
// //                   justifyContent: 'center',
// //                   width: '45px', // Increased width
// //                   height: '45px', // Increased height
// //                   opacity: 0.8
// //                 }}
// //                 onMouseEnter={(e) => {
// //                   e.target.style.transform = 'scale(1.1)';
// //                   e.target.style.opacity = '1';
// //                 }}
// //                 onMouseLeave={(e) => {
// //                   e.target.style.transform = 'scale(1)';
// //                   e.target.style.opacity = '0.8';
// //                 }}
// //               >
// //                 <img src="https://cdn-icons-png.flaticon.com/512/684/684908.png" alt="Copy Link" style={{ width: '22px', height: '22px', filter: isDarkTheme ? 'invert(1)' : 'none' }} />
// //               </button>

// //               <button
// //                 onClick={() => handleOptionClick(() => onDownload(showVideoOptions.video))}
// //                 title="Download Video"
// //                 style={{
// //                   background: 'transparent',
// //                   border: 'none',
// //                   color: currentTheme.text,
// //                   borderRadius: '10px', // Increased border radius
// //                   fontSize: '1.5rem', // Increased font size
// //                   fontWeight: '500',
// //                   cursor: 'pointer',
// //                   transition: 'all 0.2s',
// //                   display: 'flex',
// //                   alignItems: 'center',
// //                   justifyContent: 'center',
// //                   width: '45px', // Increased width
// //                   height: '45px', // Increased height
// //                   opacity: 0.8
// //                 }}
// //                 onMouseEnter={(e) => {
// //                   e.target.style.transform = 'scale(1.1)';
// //                   e.target.style.opacity = '1';
// //                 }}
// //                 onMouseLeave={(e) => {
// //                   e.target.style.transform = 'scale(1)';
// //                   e.target.style.opacity = '0.8';
// //                 }}
// //               >
// //                 <img src="https://cdn-icons-png.flaticon.com/512/2991/2991937.png" alt="Download" style={{ width: '22px', height: '22px', filter: isDarkTheme ? 'invert(1)' : 'none' }} />
// //               </button>

// //               <button
// //                 onClick={() => handleOptionClick(() => onDelete(showVideoOptions.video.id, showVideoOptions.video.title))}
// //                 title="Delete Video"
// //                 style={{
// //                   background: 'transparent',
// //                   border: 'none',
// //                   color: '#ef4444',
// //                   borderRadius: '10px', // Increased border radius
// //                   fontSize: '1.5rem', // Increased font size
// //                   fontWeight: '500',
// //                   cursor: 'pointer',
// //                   transition: 'all 0.2s',
// //                   display: 'flex',
// //                   alignItems: 'center',
// //                   justifyContent: 'center',
// //                   width: '45px', // Increased width
// //                   height: '45px', // Increased height
// //                   opacity: 0.8
// //                 }}
// //                 onMouseEnter={(e) => {
// //                   e.target.style.transform = 'scale(1.1)';
// //                   e.target.style.opacity = '1';
// //                 }}
// //                 onMouseLeave={(e) => {
// //                   e.target.style.transform = 'scale(1)';
// //                   e.target.style.opacity = '0.8';
// //                 }}
// //               >
// //                 <img src="https://cdn-icons-png.flaticon.com/512/3597/3597075.png" alt="Delete" style={{ width: '22px', height: '22px', filter: 'invert(0.5) sepia(1) saturate(5) hue-rotate(330deg)' }} />
// //               </button>
// //             </div>
// //           </div>

// //           {/* Right Column - Products Section */}
// //           <div style={{
// //             flex: 1,
// //             minWidth: '280px', // Increased min width
// //             display: 'flex',
// //             flexDirection: 'column',
// //             gap: '1.8rem', // Increased gap
// //             height: '100%',
// //             overflow: 'hidden'
// //           }}>
// //             {/* Products Section */}
// //             <div style={{
// //               display: 'flex',
// //               flexDirection: 'column',
// //               height: '100%',
// //               gap: '1.2rem' // Increased gap
// //             }}>
// //               <h3 style={{
// //                 fontSize: '1.1rem', // Increased font size
// //                 fontWeight: '600',
// //                 color: currentTheme.text,
// //                 margin: 0
// //               }}>
// //                 Product Management
// //               </h3>
              
// //               <button
// //                 onClick={handleAddProducts}
// //                 disabled={isLoadingProducts || productsModalTriggered}
// //                 style={{
// //                   width: '100%',
// //                   background: '#10b981',
// //                   color: 'white',
// //                   border: 'none',
// //                   padding: '0.8rem', // Increased padding
// //                   borderRadius: '10px', // Increased border radius
// //                   fontSize: '0.9rem', // Increased font size
// //                   fontWeight: '500',
// //                   cursor: (isLoadingProducts || productsModalTriggered) ? 'not-allowed' : 'pointer',
// //                   transition: 'background-color 0.2s',
// //                   opacity: (isLoadingProducts || productsModalTriggered) ? 0.6 : 1,
// //                   height: '48px' // Increased fixed height
// //                 }}
// //                 onMouseEnter={(e) => {
// //                   if (!isLoadingProducts && !productsModalTriggered) {
// //                     e.target.style.background = '#059669';
// //                   }
// //                 }}
// //                 onMouseLeave={(e) => {
// //                   if (!isLoadingProducts && !productsModalTriggered) {
// //                     e.target.style.background = '#10b981';
// //                   }
// //                 }}
// //               >
// //                 {isLoadingProducts ? 'Loading Products...' : productsModalTriggered ? 'Opening...' : 'Add Products'}
// //               </button>

// //               {/* Saved Products Section */}
// //               <div style={{
// //                 flex: 1,
// //                 display: 'flex',
// //                 flexDirection: 'column',
// //                 overflow: 'hidden'
// //               }}>
// //                 <div style={{
// //                   fontSize: '0.9rem', // Increased font size
// //                   fontWeight: '600',
// //                   color: currentTheme.text,
// //                   marginBottom: '0.8rem' // Increased margin
// //                 }}>
// //                   Saved Products {savedProducts.length > 0 && `(${savedProducts.length})`}
// //                 </div>
                
// //                 {isLoadingSavedProducts ? (
// //                   <div style={{
// //                     textAlign: 'center',
// //                     padding: '1.2rem', // Increased padding
// //                     color: currentTheme.text,
// //                     fontSize: '0.85rem', // Increased font size
// //                     border: `1px solid ${currentTheme.border}`,
// //                     borderRadius: '10px', // Increased border radius
// //                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
// //                     height: '70px', // Increased height
// //                     display: 'flex',
// //                     alignItems: 'center',
// //                     justifyContent: 'center'
// //                   }}>
// //                     Loading saved products...
// //                   </div>
// //                 ) : savedProducts.length > 0 ? (
// //                   <div style={{
// //                     flex: 1,
// //                     overflowY: 'auto',
// //                     border: `1px solid ${currentTheme.border}`,
// //                     borderRadius: '10px', // Increased border radius
// //                     padding: '0.8rem', // Increased padding
// //                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
// //                     maxHeight: '250px' // Increased max height
// //                   }}>
// //                     {savedProducts.map((product) => (
// //                       <div
// //                         key={product.video_product_id || product.id}
// //                         style={{
// //                           display: 'flex',
// //                           alignItems: 'center',
// //                           gap: '0.8rem', // Increased gap
// //                           padding: '0.8rem', // Increased padding
// //                           marginBottom: '0.5rem', // Increased margin
// //                           background: isDarkTheme ? '#374151' : '#ffffff',
// //                           borderRadius: '8px', // Increased border radius
// //                           fontSize: '0.8rem' // Increased font size
// //                         }}
// //                       >
// //                         {product.image_url ? (
// //                           <img 
// //                             src={product.image_url} 
// //                             alt={product.title}
// //                             style={{
// //                               width: '28px', // Increased size
// //                               height: '28px', // Increased size
// //                               borderRadius: '6px', // Increased border radius
// //                               objectFit: 'cover'
// //                             }}
// //                           />
// //                         ) : (
// //                           <div style={{
// //                             width: '28px', // Increased size
// //                             height: '28px', // Increased size
// //                             background: '#3b82f6',
// //                             borderRadius: '6px', // Increased border radius
// //                             display: 'flex',
// //                             alignItems: 'center',
// //                             justifyContent: 'center',
// //                             color: 'white',
// //                             fontSize: '0.75rem', // Increased font size
// //                             fontWeight: 'bold'
// //                           }}>
// //                             P
// //                           </div>
// //                         )}
// //                         <div style={{ flex: 1, minWidth: 0 }}>
// //                           <div style={{
// //                             color: currentTheme.text,
// //                             fontWeight: '500',
// //                             whiteSpace: 'nowrap',
// //                             overflow: 'hidden',
// //                             textOverflow: 'ellipsis'
// //                           }}>
// //                             {product.title}
// //                           </div>
// //                           <div style={{
// //                             color: '#10b981',
// //                             fontSize: '0.75rem' // Increased font size
// //                           }}>
// //                             ${product.price}
// //                           </div>
// //                         </div>
// //                       </div>
// //                     ))}
// //                   </div>
// //                 ) : (
// //                   <div style={{
// //                     textAlign: 'center',
// //                     padding: '1.2rem', // Increased padding
// //                     color: isDarkTheme ? '#9ca3af' : '#6b7280',
// //                     fontSize: '0.85rem', // Increased font size
// //                     fontStyle: 'italic',
// //                     border: `1px dashed ${currentTheme.border}`,
// //                     borderRadius: '10px', // Increased border radius
// //                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
// //                     height: '70px', // Increased height
// //                     display: 'flex',
// //                     alignItems: 'center',
// //                     justifyContent: 'center'
// //                   }}>
// //                     No products saved for this video
// //                   </div>
// //                 )}
// //               </div>

// //               <label style={{
// //                 display: 'flex',
// //                 alignItems: 'center',
// //                 gap: '0.8rem', // Increased gap
// //                 cursor: 'pointer',
// //                 fontSize: '0.9rem', // Increased font size
// //                 color: currentTheme.text,
// //                 marginTop: '0.8rem' // Increased margin
// //               }}>
// //                 <input 
// //                   type="checkbox" 
// //                   style={{
// //                     cursor: 'pointer',
// //                     width: '18px', // Increased size
// //                     height: '18px' // Increased size
// //                   }}
// //                 />
// //                 Enable video on product page
// //               </label>
// //             </div>
// //           </div>

// //           <style jsx>{`
// //             @keyframes scaleIn {
// //               from {
// //                 opacity: 0;
// //                 transform: scale(0.95) translateY(-10px);
// //               }
// //               to {
// //                 opacity: 1;
// //                 transform: scale(1) translateY(0);
// //               }
// //             }
// //           `}</style>
// //         </div>
// //       </div>

// //       {/* FIXED: ProductsModal now opens only once */}
// //       {showProductsModal && (
// //         <ProductsModal
// //           showProductsModal={{ show: true, video: showVideoOptions.video }}
// //           products={products || []}
// //           selectedProducts={selectedProducts || new Set()}
// //           loadingProducts={isLoadingProducts}
// //           onToggleProduct={onToggleProduct || (() => {})}
// //           onSaveProducts={handleSaveProducts}
// //           onHide={handleHideProductsModal}
// //           isDarkTheme={isDarkTheme}
// //         />
// //       )}
// //     </>
// //   );
// // }




// // components/videogallerycomponents/VideoOptionsModal.jsx
// import { useState, useEffect, useRef } from "react";
// import ProductsModal from "./ProductsModal";
// import VideoPlayerWithHover from "./VideoPlayerWithHover";

// export default function VideoOptionsModal({
//   showVideoOptions,
//   onHide,
//   onCopyUrl,
//   onDownload,
//   onLoadProducts,
//   onDelete,
//   isDarkTheme,
//   selectedProducts,
//   products,
//   onToggleProduct,
//   onSaveProducts,
//   showVideoPlayerModal
// }) {
//   const [isLoadingProducts, setIsLoadingProducts] = useState(false);
//   const [showProductsModal, setShowProductsModal] = useState(false);
//   const [savedProducts, setSavedProducts] = useState([]);
//   const [isLoadingSavedProducts, setIsLoadingSavedProducts] = useState(false);
//   const productsModalOpenedRef = useRef(false); // Use ref to track modal state

//   // Fetch saved products when modal opens or video changes
//   useEffect(() => {
//     if (showVideoOptions.show && showVideoOptions.video?.id) {
//       fetchSavedProducts();
//       productsModalOpenedRef.current = false; // Reset when modal opens
//     }
//   }, [showVideoOptions.show, showVideoOptions.video?.id]);

//   const fetchSavedProducts = async () => {
//     try {
//       setIsLoadingSavedProducts(true);
//       const response = await fetch(`/api/videoproducts?videoId=${showVideoOptions.video.id}`);
//       const result = await response.json();
      
//       if (result.success) {
//         setSavedProducts(result.products);
//       } else {
//         console.error('Failed to fetch saved products:', result.error);
//         setSavedProducts([]);
//       }
//     } catch (error) {
//       console.error('Error fetching saved products:', error);
//       setSavedProducts([]);
//     } finally {
//       setIsLoadingSavedProducts(false);
//     }
//   };

//   const handleBackdropClick = (e) => {
//     if (e.target === e.currentTarget) {
//       onHide();
//     }
//   };

//   const handleOptionClick = (action) => {
//     action();
//     onHide();
//   };

//   // Function to handle video click - open large video player
//   const handleVideoClick = () => {
//     if (showVideoPlayerModal && showVideoOptions.video) {
//       showVideoPlayerModal(showVideoOptions.video);
//       onHide(); // Close the options modal when opening full video
//     }
//   };

//   // FIXED: Load products and then show modal - prevent double opening
//   const handleAddProducts = async () => {
//     if (productsModalOpenedRef.current) return; // Prevent multiple clicks
    
//     try {
//       setIsLoadingProducts(true);
//       productsModalOpenedRef.current = true; // Mark as opened
      
//       // Call the products API to load products
//       if (onLoadProducts) {
//         await onLoadProducts(showVideoOptions.video);
//       }
      
//       // Then show the modal
//       setShowProductsModal(true);
//     } catch (error) {
//       console.error('Error loading products:', error);
//       productsModalOpenedRef.current = false; // Reset on error
//     } finally {
//       setIsLoadingProducts(false);
//     }
//   };

//   const handleSaveProducts = async () => {
//     if (onSaveProducts) {
//       await onSaveProducts();
//     }
//     setShowProductsModal(false);
//     productsModalOpenedRef.current = false; // Reset after save
//     // Refresh saved products after saving - with a slight delay to ensure DB update
//     setTimeout(() => {
//       fetchSavedProducts();
//     }, 500);
//   };

//   // UPDATED: Handle modal close - refresh products when modal closes regardless of save action
//   const handleHideProductsModal = () => {
//     setShowProductsModal(false);
//     productsModalOpenedRef.current = false; // Reset when modal closes
//     // Refresh saved products when the products modal closes
//     // This ensures we show the latest selected products even if user didn't explicitly click "Save"
//     setTimeout(() => {
//       fetchSavedProducts();
//     }, 300);
//   };

//   // Get the selected products
//   const displayProducts = selectedProducts || new Set();

//   // Early return should be AFTER all hooks
//   if (!showVideoOptions.show) return null;

//   const themeStyles = {
//     light: {
//       background: '#ffffff',
//       text: '#1f2937',
//       border: '#e5e7eb',
//       shadow: '0 10px 25px rgba(0, 0, 0, 0.15)',
//       hoverBackground: '#f3f4f6',
//       sectionBackground: '#f8fafc'
//     },
//     dark: {
//       background: '#374151',
//       text: '#f9fafb',
//       border: '#4b5563',
//       shadow: '0 10px 25px rgba(0, 0, 0, 0.4)',
//       hoverBackground: '#4b5563',
//       sectionBackground: '#4b5563'
//     }
//   };

//   const currentTheme = isDarkTheme ? themeStyles.dark : themeStyles.light;

//   // Get the correct video URL - use proxy URL if available, otherwise fallback to original
//   const videoUrl = showVideoOptions.video?.videoUrl || showVideoOptions.video?.shopify_file_url;

//   return (
//     <>
//       <div 
//         style={{
//           position: 'fixed',
//           top: 0,
//           left: 0,
//           right: 0,
//           bottom: 0,
//           zIndex: 10000,
//           background: 'rgba(0, 0, 0, 0.5)',
//           display: 'flex',
//           justifyContent: 'center',
//           alignItems: 'center'
//         }}
//         onClick={handleBackdropClick}
//       >
//         <div 
//           style={{
//             background: currentTheme.background,
//             borderRadius: '12px',
//             border: `1px solid ${currentTheme.border}`,
//             boxShadow: currentTheme.shadow,
//             padding: '2.5rem',
//             maxWidth: '800px', // Increased max width by 5 more rem (from 750px to 800px)
//             minWidth: '700px', // Increased min width by 5 more rem (from 650px to 700px)
//             maxHeight: 'calc(100vh - 4rem)',
//             height: 'auto',
//             minHeight: '500px',
//             zIndex: 10001,
//             animation: 'scaleIn 0.2s ease-out',
//             display: 'flex',
//             flexDirection: 'row',
//             justifyContent: 'space-between',
//             alignItems: 'flex-start',
//             gap: '2.5rem',
//             overflow: 'hidden',
//             position: 'relative'
//           }}
//         >
//           {/* Close Button */}
//           <button
//             onClick={onHide}
//             style={{
//               position: 'absolute',
//               top: '1.5rem',
//               right: '1.5rem',
//               background: isDarkTheme ? '#374151' : 'white',
//               border: `1px solid ${isDarkTheme ? '#4b5563' : '#e5e7eb'}`,
//               borderRadius: '50%',
//               width: '40px',
//               height: '40px',
//               display: 'flex',
//               alignItems: 'center',
//               justifyContent: 'center',
//               cursor: 'pointer',
//               color: isDarkTheme ? '#9ca3af' : '#6b7280',
//               fontSize: '1.3rem',
//               fontWeight: 'bold',
//               zIndex: 10002,
//               transition: 'all 0.3s ease'
//             }}
//             onMouseEnter={(e) => {
//               e.target.style.background = isDarkTheme ? '#4b5563' : '#f3f4f6';
//               e.target.style.color = isDarkTheme ? '#f9fafb' : '#1f2937';
//             }}
//             onMouseLeave={(e) => {
//               e.target.style.background = isDarkTheme ? '#374151' : 'white';
//               e.target.style.color = isDarkTheme ? '#9ca3af' : '#6b7280';
//             }}
//           >
//             ‚úï
//           </button>

//           {/* Left Column - Video Player */}
//           <div style={{
//             flex: 1,
//             minWidth: '220px', // Increased min width
//             display: 'flex',
//             flexDirection: 'row',
//             gap: '2rem',
//             position: 'relative'
//           }}>
//             {/* Vertical Line Separator */}
//             <div 
//               style={{
//                 position: 'absolute',
//                 right: '-1.25rem',
//                 top: '0',
//                 bottom: '0',
//                 width: '1px',
//                 background: isDarkTheme ? '#4b5563' : '#e5e7eb',
//                 zIndex: 1
//               }}
//             />

//             {/* Video Player Section */}
//             <div style={{ flex: 1 }}>
//               <h3 style={{
//                 fontSize: '1.1rem',
//                 fontWeight: '600',
//                 color: currentTheme.text,
//                 margin: '0 0 1.2rem 0'
//               }}>
//                 Selected Video
//               </h3>
              
//               {/* Video Player with Hover - Shows the clicked video */}
//               {videoUrl ? (
//                 <div style={{
//                   width: '100%',
//                   height: '250px',
//                   display: 'flex',
//                   justifyContent: 'center',
//                   alignItems: 'center',
//                   background: isDarkTheme ? '#1f2937' : '#f8fafc',
//                   borderRadius: '10px',
//                   overflow: 'hidden'
//                 }}>
//                   <VideoPlayerWithHover
//                     videoUrl={videoUrl}
//                     thumbnailUrl={showVideoOptions.video?.thumbnail_url}
//                     title={showVideoOptions.video?.title}
//                     onVideoClick={handleVideoClick}
//                     isDarkTheme={isDarkTheme}
//                     height="250px"
//                     width="100%"
//                     objectFit="contain"
//                   />
//                 </div>
//               ) : (
//                 <div style={{
//                   height: '200px',
//                   background: isDarkTheme ? '#374151' : '#f3f4f6',
//                   borderRadius: '10px',
//                   display: 'flex',
//                   alignItems: 'center',
//                   justifyContent: 'center',
//                   color: isDarkTheme ? '#9ca3af' : '#6b7280',
//                   flexDirection: 'column',
//                   gap: '0.8rem'
//                 }}>
//                   <div style={{ fontSize: '1.8rem' }}>üé¨</div>
//                   <div style={{ fontSize: '1rem' }}>Video not available</div>
//                 </div>
//               )}
//             </div>

//             {/* Video Actions Section */}
//             <div style={{
//               marginTop: "50px",
//               display: 'flex',
//               flexDirection: 'column',
//               justifyContent: 'center',
//               alignItems: 'center',
//               gap: '15px'
//             }}>
//               <button
//                 onClick={() => handleOptionClick(() => onCopyUrl(showVideoOptions.video.shopify_file_url))}
//                 title="Copy Video URL"
//                 style={{
//                   background: 'transparent',
//                   border: 'none',
//                   color: currentTheme.text,
//                   borderRadius: '10px',
//                   fontSize: '1.5rem',
//                   fontWeight: '500',
//                   cursor: 'pointer',
//                   transition: 'all 0.2s',
//                   display: 'flex',
//                   alignItems: 'center',
//                   justifyContent: 'center',
//                   width: '45px',
//                   height: '45px',
//                   opacity: 0.8
//                 }}
//                 onMouseEnter={(e) => {
//                   e.target.style.transform = 'scale(1.1)';
//                   e.target.style.opacity = '1';
//                 }}
//                 onMouseLeave={(e) => {
//                   e.target.style.transform = 'scale(1)';
//                   e.target.style.opacity = '0.8';
//                 }}
//               >
//                 <img src="https://cdn-icons-png.flaticon.com/512/684/684908.png" alt="Copy Link" style={{ width: '22px', height: '22px', filter: isDarkTheme ? 'invert(1)' : 'none' }} />
//               </button>

//               <button
//                 onClick={() => handleOptionClick(() => onDownload(showVideoOptions.video))}
//                 title="Download Video"
//                 style={{
//                   background: 'transparent',
//                   border: 'none',
//                   color: currentTheme.text,
//                   borderRadius: '10px',
//                   fontSize: '1.5rem',
//                   fontWeight: '500',
//                   cursor: 'pointer',
//                   transition: 'all 0.2s',
//                   display: 'flex',
//                   alignItems: 'center',
//                   justifyContent: 'center',
//                   width: '45px',
//                   height: '45px',
//                   opacity: 0.8
//                 }}
//                 onMouseEnter={(e) => {
//                   e.target.style.transform = 'scale(1.1)';
//                   e.target.style.opacity = '1';
//                 }}
//                 onMouseLeave={(e) => {
//                   e.target.style.transform = 'scale(1)';
//                   e.target.style.opacity = '0.8';
//                 }}
//               >
//                 <img src="https://cdn-icons-png.flaticon.com/512/2991/2991937.png" alt="Download" style={{ width: '22px', height: '22px', filter: isDarkTheme ? 'invert(1)' : 'none' }} />
//               </button>

//               <button
//                 onClick={() => handleOptionClick(() => onDelete(showVideoOptions.video.id, showVideoOptions.video.title))}
//                 title="Delete Video"
//                 style={{
//                   background: 'transparent',
//                   border: 'none',
//                   color: '#ef4444',
//                   borderRadius: '10px',
//                   fontSize: '1.5rem',
//                   fontWeight: '500',
//                   cursor: 'pointer',
//                   transition: 'all 0.2s',
//                   display: 'flex',
//                   alignItems: 'center',
//                   justifyContent: 'center',
//                   width: '45px',
//                   height: '45px',
//                   opacity: 0.8
//                 }}
//                 onMouseEnter={(e) => {
//                   e.target.style.transform = 'scale(1.1)';
//                   e.target.style.opacity = '1';
//                 }}
//                 onMouseLeave={(e) => {
//                   e.target.style.transform = 'scale(1)';
//                   e.target.style.opacity = '0.8';
//                 }}
//               >
//                 <img src="https://cdn-icons-png.flaticon.com/512/3597/3597075.png" alt="Delete" style={{ width: '22px', height: '22px', filter: 'invert(0.5) sepia(1) saturate(5) hue-rotate(330deg)' }} />
//               </button>
//             </div>
//           </div>

//           {/* Right Column - Products Section */}
//           <div style={{
//             flex: 1,
//             minWidth: '300px', // Increased min width
//             display: 'flex',
//             flexDirection: 'column',
//             gap: '1.8rem',
//             height: '100%',
//             overflow: 'hidden'
//           }}>
//             {/* Products Section */}
//             <div style={{
//               display: 'flex',
//               flexDirection: 'column',
//               height: '100%',
//               gap: '1.2rem'
//             }}>
//               <h3 style={{
//                 fontSize: '1.1rem',
//                 fontWeight: '600',
//                 color: currentTheme.text,
//                 margin: 0
//               }}>
//                 Product Management
//               </h3>
              
//               <button
//                 onClick={handleAddProducts}
//                 disabled={isLoadingProducts || productsModalOpenedRef.current}
//                 style={{
//                   width: '100%',
//                   background: '#10b981',
//                   color: 'white',
//                   border: 'none',
//                   padding: '0.8rem',
//                   borderRadius: '10px',
//                   fontSize: '0.9rem',
//                   fontWeight: '500',
//                   cursor: (isLoadingProducts || productsModalOpenedRef.current) ? 'not-allowed' : 'pointer',
//                   transition: 'background-color 0.2s',
//                   opacity: (isLoadingProducts || productsModalOpenedRef.current) ? 0.6 : 1,
//                   height: '48px'
//                 }}
//                 onMouseEnter={(e) => {
//                   if (!isLoadingProducts && !productsModalOpenedRef.current) {
//                     e.target.style.background = '#059669';
//                   }
//                 }}
//                 onMouseLeave={(e) => {
//                   if (!isLoadingProducts && !productsModalOpenedRef.current) {
//                     e.target.style.background = '#10b981';
//                   }
//                 }}
//               >
//                 {isLoadingProducts ? 'Loading Products...' : productsModalOpenedRef.current ? 'Opening...' : 'Add Products'}
//               </button>

//               {/* Saved Products Section */}
//               <div style={{
//                 flex: 1,
//                 display: 'flex',
//                 flexDirection: 'column',
//                 overflow: 'hidden'
//               }}>
//                 <div style={{
//                   fontSize: '0.9rem',
//                   fontWeight: '600',
//                   color: currentTheme.text,
//                   marginBottom: '0.8rem'
//                 }}>
//                   Saved Products {savedProducts.length > 0 && `(${savedProducts.length})`}
//                 </div>
                
//                 {isLoadingSavedProducts ? (
//                   <div style={{
//                     textAlign: 'center',
//                     padding: '1.2rem',
//                     color: currentTheme.text,
//                     fontSize: '0.85rem',
//                     border: `1px solid ${currentTheme.border}`,
//                     borderRadius: '10px',
//                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
//                     height: '70px',
//                     display: 'flex',
//                     alignItems: 'center',
//                     justifyContent: 'center'
//                   }}>
//                     Loading saved products...
//                   </div>
//                 ) : savedProducts.length > 0 ? (
//                   <div style={{
//                     flex: 1,
//                     overflowY: 'auto',
//                     border: `1px solid ${currentTheme.border}`,
//                     borderRadius: '10px',
//                     padding: '0.8rem',
//                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
//                     maxHeight: '250px'
//                   }}>
//                     {savedProducts.map((product) => (
//                       <div
//                         key={product.video_product_id || product.id}
//                         style={{
//                           display: 'flex',
//                           alignItems: 'center',
//                           gap: '0.8rem',
//                           padding: '0.8rem',
//                           marginBottom: '0.5rem',
//                           background: isDarkTheme ? '#374151' : '#ffffff',
//                           borderRadius: '8px',
//                           fontSize: '0.8rem'
//                         }}
//                       >
//                         {product.image_url ? (
//                           <img 
//                             src={product.image_url} 
//                             alt={product.title}
//                             style={{
//                               width: '28px',
//                               height: '28px',
//                               borderRadius: '6px',
//                               objectFit: 'cover'
//                             }}
//                           />
//                         ) : (
//                           <div style={{
//                             width: '28px',
//                             height: '28px',
//                             background: '#3b82f6',
//                             borderRadius: '6px',
//                             display: 'flex',
//                             alignItems: 'center',
//                             justifyContent: 'center',
//                             color: 'white',
//                             fontSize: '0.75rem',
//                             fontWeight: 'bold'
//                           }}>
//                             P
//                           </div>
//                         )}
//                         <div style={{ flex: 1, minWidth: 0 }}>
//                           <div style={{
//                             color: currentTheme.text,
//                             fontWeight: '500',
//                             whiteSpace: 'nowrap',
//                             overflow: 'hidden',
//                             textOverflow: 'ellipsis'
//                           }}>
//                             {product.title}
//                           </div>
//                           <div style={{
//                             color: '#10b981',
//                             fontSize: '0.75rem'
//                           }}>
//                             ${product.price}
//                           </div>
//                         </div>
//                       </div>
//                     ))}
//                   </div>
//                 ) : (
//                   <div style={{
//                     textAlign: 'center',
//                     padding: '1.2rem',
//                     color: isDarkTheme ? '#9ca3af' : '#6b7280',
//                     fontSize: '0.85rem',
//                     fontStyle: 'italic',
//                     border: `1px dashed ${currentTheme.border}`,
//                     borderRadius: '10px',
//                     background: isDarkTheme ? '#1f2937' : '#f8fafc',
//                     height: '70px',
//                     display: 'flex',
//                     alignItems: 'center',
//                     justifyContent: 'center'
//                   }}>
//                     No products saved for this video
//                   </div>
//                 )}
//               </div>

//               <label style={{
//                 display: 'flex',
//                 alignItems: 'center',
//                 gap: '0.8rem',
//                 cursor: 'pointer',
//                 fontSize: '0.9rem',
//                 color: currentTheme.text,
//                 marginTop: '0.8rem'
//               }}>
//                 <input 
//                   type="checkbox" 
//                   style={{
//                     cursor: 'pointer',
//                     width: '18px',
//                     height: '18px'
//                   }}
//                 />
//                 Enable video on product page
//               </label>
//             </div>
//           </div>

//           <style jsx>{`
//             @keyframes scaleIn {
//               from {
//                 opacity: 0;
//                 transform: scale(0.95) translateY(-10px);
//               }
//               to {
//                 opacity: 1;
//                 transform: scale(1) translateY(0);
//               }
//             }
//           `}</style>
//         </div>
//       </div>

//       {/* FIXED: ProductsModal now opens only once using ref for reliable state tracking */}
//       {showProductsModal && (
//         <ProductsModal
//           showProductsModal={{ show: true, video: showVideoOptions.video }}
//           products={products || []}
//           selectedProducts={selectedProducts || new Set()}
//           loadingProducts={isLoadingProducts}
//           onToggleProduct={onToggleProduct || (() => {})}
//           onSaveProducts={handleSaveProducts}
//           onHide={handleHideProductsModal}
//           isDarkTheme={isDarkTheme}
//         />
//       )}
//     </>
//   );
// }















// components/videogallerycomponents/VideoOptionsModal.jsx
import { useState, useEffect, useRef } from "react";
import ProductsModal from "./ProductsModal";
import VideoPlayerWithHover from "./VideoPlayerWithHover";

export default function VideoOptionsModal({
  showVideoOptions,
  onHide,
  onCopyUrl,
  onDownload,
  onLoadProducts,
  onDelete,
  isDarkTheme,
  selectedProducts,
  products,
  onToggleProduct,
  onSaveProducts,
  showVideoPlayerModal
}) {
  const [isLoadingProducts, setIsLoadingProducts] = useState(false);
  const [showProductsModal, setShowProductsModal] = useState(false);
  const [savedProducts, setSavedProducts] = useState([]);
  const [isLoadingSavedProducts, setIsLoadingSavedProducts] = useState(false);
  const productsModalOpenedRef = useRef(false);

  // Fetch saved products when modal opens or video changes
  useEffect(() => {
    if (showVideoOptions.show && showVideoOptions.video?.id) {
      fetchSavedProducts();
      productsModalOpenedRef.current = false;
    }
  }, [showVideoOptions.show, showVideoOptions.video?.id]);

  const fetchSavedProducts = async () => {
    try {
      setIsLoadingSavedProducts(true);
      const response = await fetch(`/api/videoproducts?videoId=${showVideoOptions.video.id}`);
      const result = await response.json();
      
      if (result.success) {
        setSavedProducts(result.products);
      } else {
        console.error('Failed to fetch saved products:', result.error);
        setSavedProducts([]);
      }
    } catch (error) {
      console.error('Error fetching saved products:', error);
      setSavedProducts([]);
    } finally {
      setIsLoadingSavedProducts(false);
    }
  };

  const handleBackdropClick = (e) => {
    if (e.target === e.currentTarget) {
      onHide();
    }
  };

  const handleOptionClick = (action) => {
    action();
    onHide();
  };

  const handleVideoClick = () => {
    if (showVideoPlayerModal && showVideoOptions.video) {
      showVideoPlayerModal(showVideoOptions.video);
      onHide();
    }
  };

  // FIXED: Simplified the handleAddProducts function to prevent double opening
  const handleAddProducts = async () => {
    if (productsModalOpenedRef.current || isLoadingProducts) return;
    
    productsModalOpenedRef.current = true;
    setIsLoadingProducts(true);

    try {
      // Call the products API to load products
      if (onLoadProducts) {
        await onLoadProducts(showVideoOptions.video);
      }
      
      // Set the state to show products modal
      setShowProductsModal(true);
    } catch (error) {
      console.error('Error loading products:', error);
      productsModalOpenedRef.current = false;
    } finally {
      setIsLoadingProducts(false);
    }
  };

  const handleSaveProducts = async () => {
    if (onSaveProducts) {
      await onSaveProducts();
    }
    setShowProductsModal(false);
    productsModalOpenedRef.current = false;
    // Refresh saved products after saving
    setTimeout(() => {
      fetchSavedProducts();
    }, 500);
  };

  // FIXED: Handle modal close properly
  const handleHideProductsModal = () => {
    setShowProductsModal(false);
    productsModalOpenedRef.current = false;
    // Refresh saved products when the products modal closes
    setTimeout(() => {
      fetchSavedProducts();
    }, 300);
  };

  // Get the selected products
  const displayProducts = selectedProducts || new Set();

  // Early return should be AFTER all hooks
  if (!showVideoOptions.show) return null;

  const themeStyles = {
    light: {
      background: '#ffffff',
      text: '#1f2937',
      border: '#e5e7eb',
      shadow: '0 10px 25px rgba(0, 0, 0, 0.15)',
      hoverBackground: '#f3f4f6',
      sectionBackground: '#f8fafc'
    },
    dark: {
      background: '#374151',
      text: '#f9fafb',
      border: '#4b5563',
      shadow: '0 10px 25px rgba(0, 0, 0, 0.4)',
      hoverBackground: '#4b5563',
      sectionBackground: '#4b5563'
    }
  };

  const currentTheme = isDarkTheme ? themeStyles.dark : themeStyles.light;

  // Get the correct video URL
  const videoUrl = showVideoOptions.video?.videoUrl || showVideoOptions.video?.shopify_file_url;

  return (
    <>
      <div 
        style={{
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          zIndex: 10000,
          background: 'rgba(0, 0, 0, 0.5)',
          display: 'flex',
          justifyContent: 'center',
          alignItems: 'center'
        }}
        onClick={handleBackdropClick}
      >
        <div 
          style={{
            background: currentTheme.background,
            borderRadius: '12px',
            border: `1px solid ${currentTheme.border}`,
            boxShadow: currentTheme.shadow,
            padding: '2.5rem',
            maxWidth: '800px',
            minWidth: '700px',
            maxHeight: 'calc(100vh - 4rem)',
            height: 'auto',
            minHeight: '500px',
            zIndex: 10001,
            animation: 'scaleIn 0.2s ease-out',
            display: 'flex',
            flexDirection: 'row',
            justifyContent: 'space-between',
            alignItems: 'flex-start',
            gap: '2.5rem',
            overflow: 'hidden',
            position: 'relative'
          }}
        >
          {/* Close Button */}
          <button
            onClick={onHide}
            style={{
              position: 'absolute',
              top: '1.5rem',
              right: '1.5rem',
              background: isDarkTheme ? '#374151' : 'white',
              border: `1px solid ${isDarkTheme ? '#4b5563' : '#e5e7eb'}`,
              borderRadius: '50%',
              width: '40px',
              height: '40px',
              display: 'flex',
              alignItems: 'center',
              justifyContent: 'center',
              cursor: 'pointer',
              color: isDarkTheme ? '#9ca3af' : '#6b7280',
              fontSize: '1.3rem',
              fontWeight: 'bold',
              zIndex: 10002,
              transition: 'all 0.3s ease'
            }}
            onMouseEnter={(e) => {
              e.target.style.background = isDarkTheme ? '#4b5563' : '#f3f4f6';
              e.target.style.color = isDarkTheme ? '#f9fafb' : '#1f2937';
            }}
            onMouseLeave={(e) => {
              e.target.style.background = isDarkTheme ? '#374151' : 'white';
              e.target.style.color = isDarkTheme ? '#9ca3af' : '#6b7280';
            }}
          >
            ‚úï
          </button>

          {/* Left Column - Video Player */}
          <div style={{
            flex: 1,
            minWidth: '220px',
            display: 'flex',
            flexDirection: 'row',
            gap: '2rem',
            position: 'relative'
          }}>
            {/* Vertical Line Separator */}
            <div 
              style={{
                position: 'absolute',
                right: '-1.25rem',
                top: '0',
                bottom: '0',
                width: '1px',
                background: isDarkTheme ? '#4b5563' : '#e5e7eb',
                zIndex: 1
              }}
            />

            {/* Video Player Section */}
            <div style={{ flex: 1 }}>
              <h3 style={{
                fontSize: '1.1rem',
                fontWeight: '600',
                color: currentTheme.text,
                margin: '0 0 1.2rem 0'
              }}>
                Selected Video
              </h3>
              
              {/* Video Player with Hover - Shows the clicked video */}
              {videoUrl ? (
                <div style={{
                  width: '100%',
                  height: '250px',
                  display: 'flex',
                  justifyContent: 'center',
                  alignItems: 'center',
                  background: isDarkTheme ? '#1f2937' : '#f8fafc',
                  borderRadius: '10px',
                  overflow: 'hidden'
                }}>
                  <VideoPlayerWithHover
                    videoUrl={videoUrl}
                    thumbnailUrl={showVideoOptions.video?.thumbnail_url}
                    title={showVideoOptions.video?.title}
                    onVideoClick={handleVideoClick}
                    isDarkTheme={isDarkTheme}
                    height="250px"
                    width="100%"
                    objectFit="contain"
                  />
                </div>
              ) : (
                <div style={{
                  height: '200px',
                  background: isDarkTheme ? '#374151' : '#f3f4f6',
                  borderRadius: '10px',
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  color: isDarkTheme ? '#9ca3af' : '#6b7280',
                  flexDirection: 'column',
                  gap: '0.8rem'
                }}>
                  <div style={{ fontSize: '1.8rem' }}>üé¨</div>
                  <div style={{ fontSize: '1rem' }}>Video not available</div>
                </div>
              )}
            </div>

            {/* Video Actions Section */}
            <div style={{
              marginTop: "50px",
              display: 'flex',
              flexDirection: 'column',
              justifyContent: 'center',
              alignItems: 'center',
              gap: '15px'
            }}>
              <button
                onClick={() => handleOptionClick(() => onCopyUrl(showVideoOptions.video.shopify_file_url))}
                title="Copy Video URL"
                style={{
                  background: 'transparent',
                  border: 'none',
                  color: currentTheme.text,
                  borderRadius: '10px',
                  fontSize: '1.5rem',
                  fontWeight: '500',
                  cursor: 'pointer',
                  transition: 'all 0.2s',
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  width: '45px',
                  height: '45px',
                  opacity: 0.8
                }}
                onMouseEnter={(e) => {
                  e.target.style.transform = 'scale(1.1)';
                  e.target.style.opacity = '1';
                }}
                onMouseLeave={(e) => {
                  e.target.style.transform = 'scale(1)';
                  e.target.style.opacity = '0.8';
                }}
              >
                <img src="https://cdn-icons-png.flaticon.com/512/684/684908.png" alt="Copy Link" style={{ width: '22px', height: '22px', filter: isDarkTheme ? 'invert(1)' : 'none' }} />
              </button>

              <button
                onClick={() => handleOptionClick(() => onDownload(showVideoOptions.video))}
                title="Download Video"
                style={{
                  background: 'transparent',
                  border: 'none',
                  color: currentTheme.text,
                  borderRadius: '10px',
                  fontSize: '1.5rem',
                  fontWeight: '500',
                  cursor: 'pointer',
                  transition: 'all 0.2s',
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  width: '45px',
                  height: '45px',
                  opacity: 0.8
                }}
                onMouseEnter={(e) => {
                  e.target.style.transform = 'scale(1.1)';
                  e.target.style.opacity = '1';
                }}
                onMouseLeave={(e) => {
                  e.target.style.transform = 'scale(1)';
                  e.target.style.opacity = '0.8';
                }}
              >
                <img src="https://cdn-icons-png.flaticon.com/512/2991/2991937.png" alt="Download" style={{ width: '22px', height: '22px', filter: isDarkTheme ? 'invert(1)' : 'none' }} />
              </button>

              <button
                onClick={() => handleOptionClick(() => onDelete(showVideoOptions.video.id, showVideoOptions.video.title))}
                title="Delete Video"
                style={{
                  background: 'transparent',
                  border: 'none',
                  color: '#ef4444',
                  borderRadius: '10px',
                  fontSize: '1.5rem',
                  fontWeight: '500',
                  cursor: 'pointer',
                  transition: 'all 0.2s',
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  width: '45px',
                  height: '45px',
                  opacity: 0.8
                }}
                onMouseEnter={(e) => {
                  e.target.style.transform = 'scale(1.1)';
                  e.target.style.opacity = '1';
                }}
                onMouseLeave={(e) => {
                  e.target.style.transform = 'scale(1)';
                  e.target.style.opacity = '0.8';
                }}
              >
                <img src="https://cdn-icons-png.flaticon.com/512/3597/3597075.png" alt="Delete" style={{ width: '22px', height: '22px', filter: 'invert(0.5) sepia(1) saturate(5) hue-rotate(330deg)' }} />
              </button>
            </div>
          </div>

          {/* Right Column - Products Section */}
          <div style={{
            flex: 1,
            minWidth: '300px',
            display: 'flex',
            flexDirection: 'column',
            gap: '1.8rem',
            height: '100%',
            overflow: 'hidden'
          }}>
            {/* Products Section */}
            <div style={{
              display: 'flex',
              flexDirection: 'column',
              height: '100%',
              gap: '1.2rem'
            }}>
              <h3 style={{
                fontSize: '1.1rem',
                fontWeight: '600',
                color: currentTheme.text,
                margin: 0
              }}>
                Product Management
              </h3>
              
              <button
                onClick={handleAddProducts}
                disabled={isLoadingProducts || productsModalOpenedRef.current}
                style={{
                  width: '100%',
                  background: '#10b981',
                  color: 'white',
                  border: 'none',
                  padding: '0.8rem',
                  borderRadius: '10px',
                  fontSize: '0.9rem',
                  fontWeight: '500',
                  cursor: (isLoadingProducts || productsModalOpenedRef.current) ? 'not-allowed' : 'pointer',
                  transition: 'background-color 0.2s',
                  opacity: (isLoadingProducts || productsModalOpenedRef.current) ? 0.6 : 1,
                  height: '48px'
                }}
                onMouseEnter={(e) => {
                  if (!isLoadingProducts && !productsModalOpenedRef.current) {
                    e.target.style.background = '#059669';
                  }
                }}
                onMouseLeave={(e) => {
                  if (!isLoadingProducts && !productsModalOpenedRef.current) {
                    e.target.style.background = '#10b981';
                  }
                }}
              >
                {isLoadingProducts ? 'Loading Products...' : productsModalOpenedRef.current ? 'Opening...' : 'Add Products'}
              </button>

              {/* Saved Products Section */}
              <div style={{
                flex: 1,
                display: 'flex',
                flexDirection: 'column',
                overflow: 'hidden'
              }}>
                <div style={{
                  fontSize: '0.9rem',
                  fontWeight: '600',
                  color: currentTheme.text,
                  marginBottom: '0.8rem'
                }}>
                  Saved Products {savedProducts.length > 0 && `(${savedProducts.length})`}
                </div>
                
                {isLoadingSavedProducts ? (
                  <div style={{
                    textAlign: 'center',
                    padding: '1.2rem',
                    color: currentTheme.text,
                    fontSize: '0.85rem',
                    border: `1px solid ${currentTheme.border}`,
                    borderRadius: '10px',
                    background: isDarkTheme ? '#1f2937' : '#f8fafc',
                    height: '70px',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center'
                  }}>
                    Loading saved products...
                  </div>
                ) : savedProducts.length > 0 ? (
                  <div style={{
                    flex: 1,
                    overflowY: 'auto',
                    border: `1px solid ${currentTheme.border}`,
                    borderRadius: '10px',
                    padding: '0.8rem',
                    background: isDarkTheme ? '#1f2937' : '#f8fafc',
                    maxHeight: '250px'
                  }}>
                    {savedProducts.map((product) => (
                      <div
                        key={product.video_product_id || product.id}
                        style={{
                          display: 'flex',
                          alignItems: 'center',
                          gap: '0.8rem',
                          padding: '0.8rem',
                          marginBottom: '0.5rem',
                          background: isDarkTheme ? '#374151' : '#ffffff',
                          borderRadius: '8px',
                          fontSize: '0.8rem'
                        }}
                      >
                        {product.image_url ? (
                          <img 
                            src={product.image_url} 
                            alt={product.title}
                            style={{
                              width: '28px',
                              height: '28px',
                              borderRadius: '6px',
                              objectFit: 'cover'
                            }}
                          />
                        ) : (
                          <div style={{
                            width: '28px',
                            height: '28px',
                            background: '#3b82f6',
                            borderRadius: '6px',
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center',
                            color: 'white',
                            fontSize: '0.75rem',
                            fontWeight: 'bold'
                          }}>
                            P
                          </div>
                        )}
                        <div style={{ flex: 1, minWidth: 0 }}>
                          <div style={{
                            color: currentTheme.text,
                            fontWeight: '500',
                            whiteSpace: 'nowrap',
                            overflow: 'hidden',
                            textOverflow: 'ellipsis'
                          }}>
                            {product.title}
                          </div>
                          <div style={{
                            color: '#10b981',
                            fontSize: '0.75rem'
                          }}>
                            ${product.price}
                          </div>
                        </div>
                      </div>
                    ))}
                  </div>
                ) : (
                  <div style={{
                    textAlign: 'center',
                    padding: '1.2rem',
                    color: isDarkTheme ? '#9ca3af' : '#6b7280',
                    fontSize: '0.85rem',
                    fontStyle: 'italic',
                    border: `1px dashed ${currentTheme.border}`,
                    borderRadius: '10px',
                    background: isDarkTheme ? '#1f2937' : '#f8fafc',
                    height: '70px',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center'
                  }}>
                    No products saved for this video
                  </div>
                )}
              </div>

              <label style={{
                display: 'flex',
                alignItems: 'center',
                gap: '0.8rem',
                cursor: 'pointer',
                fontSize: '0.9rem',
                color: currentTheme.text,
                marginTop: '0.8rem'
              }}>
                <input 
                  type="checkbox" 
                  style={{
                    cursor: 'pointer',
                    width: '18px',
                    height: '18px'
                  }}
                />
                Enable video on product page
              </label>
            </div>
          </div>

          <style jsx>{`
            @keyframes scaleIn {
              from {
                opacity: 0;
                transform: scale(0.95) translateY(-10px);
              }
              to {
                opacity: 1;
                transform: scale(1) translateY(0);
              }
            }
          `}</style>
        </div>
      </div>

      {/* FIXED: ProductsModal now uses a simple boolean state without complex conditions */}
      {showProductsModal && (
        <ProductsModal
          showProductsModal={{ show: true, video: showVideoOptions.video }}
          products={products || []}
          selectedProducts={selectedProducts || new Set()}
          loadingProducts={isLoadingProducts}
          onToggleProduct={onToggleProduct || (() => {})}
          onSaveProducts={handleSaveProducts}
          onHide={handleHideProductsModal}
        />
      )}
    </>
  );
}